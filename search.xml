<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Javaè®¾è®¡æ¨¡å¼]]></title>
    <url>%2F2021%2F01%2F05%2Fdesign-pattern%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿°ï¼š æœ¬è´¨ï¼šé¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™çš„å®é™…è¿ç”¨ï¼Œæ˜¯å¯¹ç±»çš„å°è£…ã€ç»§æ‰¿å’Œå¤šæ€æ€§ä»¥åŠç±»çš„å…³è”å…³ç³»å’Œç»„åˆå…³ç³»çš„å……åˆ†ç†è§£ã€‚ åˆ†ç±»: 1. åˆ›å»ºå‹æ¨¡å¼ï¼šå…±5ç§ï¼Œç”¨äºæè¿°â€œæ€æ ·åˆ›å»ºå¯¹è±¡â€ï¼Œä¸»è¦ç‰¹ç‚¹æ˜¯â€œå°†å¯¹è±¡çš„åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»â€(è§£è€¦)ã€‚ 2. ç»“æ„å‹æ¨¡å¼ï¼šå…±7ç§ï¼Œç”¨äºæè¿°å¦‚ä½•å°†ç±»æˆ–å¯¹è±¡æŒ‰æŸç§å¸ƒå±€ç»„æˆæ›´å¤§çš„ç»“æ„ã€‚ 3. è¡Œä¸ºå‹æ¨¡å¼ï¼šå…±11ç§ï¼Œç”¨äºæè¿°ç±»æˆ–å¯¹è±¡ä¹‹é—´æ€æ ·ç›¸äº’åä½œå…±åŒå®Œæˆå•ä¸ªå¯¹è±¡æ— æ³•å•ç‹¬å®Œæˆçš„ä»»åŠ¡ï¼Œä»¥åŠæ€æ ·åˆ†é…èŒè´£ã€‚ ä¸€ã€6å¤§è®¾è®¡åŸåˆ™1. å•ä¸€èŒè´£åŸåˆ™ (SRP)è‹±æ–‡ï¼šSingle Responsibility Principle å®šä¹‰ï¼šæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªåŸå› å¼•èµ·ç±»çš„å˜æ›´ ä¼˜ç‚¹ï¼š â€‹ 1.ç±»çš„å¤æ‚æ€§é™ä½ â€‹ 2.å¯è¯»æ€§æé«˜ â€‹ 3.å¯ç»´æŠ¤æ€§æé«˜ â€‹ 4.å˜æ›´å¼•èµ·çš„é£é™©é™ä½ éš¾ç‚¹ï¼šèŒè´£ç•Œé™çš„åˆ’åˆ† é€‚ç”¨èŒƒå›´ï¼šæ¥å£(ä¸€å®š)ã€ç±»(å°½é‡)ã€æ–¹æ³•(å°½å¯èƒ½) 2. é‡Œå¼æ›¿æ¢åŸåˆ™ (LSP)è‹±æ–‡ï¼šLiskov Substitution Principle å®šä¹‰ï¼š â€‹ å®šä¹‰1ï¼šå¦‚æœå¯¹æ¯ä¸€ä¸ªç±»å‹ä¸ºSçš„å¯¹è±¡o1,éƒ½æœ‰ç±»å‹ä¸ºTçš„å¯¹è±¡o2ï¼Œä½¿å¾—ä»¥Tå®šä¹‰çš„æ‰€æœ‰ç¨‹åºPåœ¨æ‰€æœ‰çš„å¯¹è±¡o1éƒ½ä»£æ¢æˆo2æ—¶,ç¨‹åºPçš„è¡Œä¸ºæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç±»å‹Sæ˜¯ç±»å‹Tçš„å­ç±»å‹ã€‚ â€‹ å®šä¹‰2ï¼šæ‰€æœ‰å¼•ç”¨åŸºç±»çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡ã€‚ â€‹ é€šä¿—è§£é‡Šï¼šçˆ¶ç±»å‡ºç°çš„åœ°æ–¹,å­ç±»èƒ½å®Œç¾æ›¿æ¢çˆ¶ç±»,ä¸”ä¸ä¼šäº§ç”Ÿä»»ä½•é”™è¯¯å’Œå¼‚å¸¸;åä¹‹,å­ç±»å‡ºç°çš„åœ°æ–¹,çˆ¶ç±»æœªå¿…èƒ½é€‚åº”ã€‚ å®šä¹‰æ‹†è§£ï¼š â€‹ 4å±‚å«ä¹‰ï¼š â€‹ 1.å­ç±»å¿…é¡»å®Œå…¨å®ç°çˆ¶ç±»çš„æ–¹æ³• â€‹ 2.å­ç±»å¯ä»¥æœ‰è‡ªå·±çš„ä¸ªæ€§ â€‹ 3.[å¥‘çº¦è®¾è®¡]è¦†ç›–æˆ–å®ç°çˆ¶ç±»çš„æ–¹æ³•æ—¶è¾“å…¥å‚æ•°ï¼Œè¦ä¹ˆä¸€æ ·ï¼ˆè¦†å†™ï¼‰ï¼Œè¦ä¹ˆå¯ä»¥è¢«æ”¾å¤§ï¼ˆé‡è½½ï¼‰ â€‹ 4.è¦†å†™æˆ–å®ç°çˆ¶ç±»çš„æ–¹æ³•æ—¶è¾“å‡ºç»“æœï¼ˆè¿”å›ç±»å‹ï¼‰å¯ä»¥è¢«ç¼©å° ä¼˜ç‚¹ï¼šå¢å¼ºç¨‹åºçš„å¥å£®æ€§ åº”ç”¨ï¼šç‰ˆæœ¬å‡çº§(å¾…å®è·µ) æœ€ä½³å®è·µï¼šåœ¨é¡¹ç›®ä¸­,é‡‡ç”¨LSPæ—¶ï¼Œå°½é‡é¿å…å­ç±»çš„â€œä¸ªæ€§â€ï¼Œä¸€æ—¦å­ç±»æœ‰â€œä¸ªæ€§â€ï¼Œè¿™ä¸ªå­ç±»å’Œçˆ¶ç±»ä¹‹é—´çš„å…³ç³»å°±å¾ˆéš¾è°ƒå’Œäº†ï¼ŒæŠŠå­ç±»å½“åšçˆ¶ç±»ä½¿ç”¨ï¼Œå­ç±»çš„â€œä¸ªæ€§â€è¢«æŠ¹æ€â€“å§”å±ˆäº†ç‚¹ï¼›æŠŠå­ç±»å•ç‹¬ä½œä¸ºä¸€ä¸ªä¸šåŠ¡æ¥ä½¿ç”¨ï¼Œåˆ™ä¼šè®©ä»£ç é—´çš„è€¦åˆå…³ç³»å˜çš„æ‰‘æœ”è¿·ç¦»â€“ç¼ºä¹æ›¿æ¢çš„æ ‡å‡†ã€‚ 3. ä¾èµ–å¯¼è‡´åŸåˆ™ (DIP)è‹±æ–‡ï¼šDependence Inversion Principle å®šä¹‰ï¼šHigh level modules should not depend upon low level modules. Both should depend upon abstractions. Abstractions should not depend upon details. Details should depend upon abstractions. å®šä¹‰æ‹†è§£ï¼š â€‹ 1.é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ â€‹ 2.æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ ä¼˜ç‚¹ï¼šå‡å°‘ç±»é—´çš„è€¦åˆæ€§ï¼Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œé™ä½å¹¶è¡Œå¼€å‘å¼•èµ·çš„é£é™©ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ ä¾èµ–ä¸‰ç§å†™æ³•ï¼š â€‹ 1.æ„é€ å‡½æ•°ä¼ é€’ä¾èµ–å¯¹è±¡ â€‹ 2.Setteræ–¹æ³•ä¼ é€’ä¾èµ–å¯¹è±¡ â€‹ 3.æ¥å£å£°æ˜ä¾èµ–å¯¹è±¡ æœ¬è´¨ï¼š â€‹ éµå¾ªè§„åˆ™ï¼š â€‹ 1.åŸºæœ¬è¦æ±‚ï¼šé€šè¿‡æŠ½è±¡(æ¥å£æˆ–æŠ½è±¡ç±»),ä½¿å„ç±»æˆ–æ¨¡å—çš„å®ç°å½¼æ­¤ç‹¬ç«‹,ä¸ç›¸ç›¸äº’å½±å“,å®ç°æ¨¡å—é—´çš„æ¾è€¦åˆã€‚ â€‹ 2.å˜é‡çš„è¡¨é¢ç±»å‹å°½é‡æ˜¯æ¥å£æˆ–è€…æ˜¯æŠ½è±¡ç±»ï¼šä¸€ä¸ªå˜é‡å¯ä»¥æœ‰ä¸¤ç§ç±»å‹ï¼šè¡¨é¢ç±»å‹å’Œå®é™…ç±»å‹ï¼Œè¡¨é¢ç±»å‹æ˜¯åœ¨å®šä¹‰çš„æ—¶å€™èµ‹äºˆçš„ç±»å‹ï¼Œå®é™…ç±»å‹æ˜¯å¯¹è±¡çš„ç±»å‹ã€‚ â€‹ 3.ä»»ä½•ç±»éƒ½ä¸åº”è¯¥ä»å…·ä½“ç±»æ´¾ç”Ÿ â€‹ 4.å°½é‡ä¸è¦è¦†å†™åŸºç±»çš„æ–¹æ³• â€‹ 5.ç»“åˆé‡Œæ°æ›¿æ¢åŸåˆ™ä½¿ç”¨ â€‹ æ ¸å¿ƒï¼šâ€œé¢å‘æ¥å£ç¼–ç¨‹â€ 4. æ¥å£éš”ç¦»åŸåˆ™ (ISP)è‹±æ–‡: Interface Segregation Principle å®šä¹‰ï¼š â€‹ å®šä¹‰1ï¼šå®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ â€‹ å®šä¹‰2ï¼šç±»é—´çš„ä¾èµ–å…³ç³»åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Š â€‹ é€šä¿—è§£é‡Šï¼šå»ºç«‹å•ä¸€æ¥å£ï¼Œä¸è¦è‡ƒè‚¿è‚¥å¤§çš„æ¥å£ã€‚æ¥å£å°½é‡ç»†åŒ–ï¼Œæ¥å£ä¸­çš„æ–¹æ³•å°½é‡å°‘ã€‚ åŒºåˆ†ï¼šå•ä¸€èŒè´£åŸåˆ™(SRP) å’Œ æ¥å£éš”ç¦»åŸåˆ™(ISP)çš„åŒºåˆ«ï¼ŒSRPå¼ºè°ƒå•ä¸€èŒè´£ï¼Œè¦æ±‚ç±»å’ŒèŒè´£å•ä¸€ï¼Œæ³¨é‡èŒè´£ï¼Œè¿™æ˜¯é€»è¾‘ä¸šåŠ¡ä¸Šåˆ’åˆ†ï¼Œè€ŒISPè¦æ±‚æ¥å£çš„æ–¹æ³•å°½é‡å°‘ã€‚ è§„èŒƒæ‹†è§£ï¼š â€‹ 1.æ¥å£å°½é‡å°ï¼šâ€œå°â€æœ‰é™åº¦ï¼Œå¿…é¡» æ»¡è¶³å•ä¸€èŒè´£ (SRP) â€‹ 2.æ¥å£è¦é«˜å†…èšï¼šé«˜å†…èšå°±æ˜¯æé«˜æ¥å£ã€ç±»ã€æ¨¡å—çš„å¤„ç†èƒ½åŠ›ï¼Œå‡å°‘å¯¹å¤–çš„äº¤äº’ã€‚æ¥å£ä¸­å°½é‡å°‘å…¬å¸ƒpublicæ–¹æ³•ï¼Œæ¥å£çš„å¯¹å¤–çš„æ‰¿è¯ºè¶Šå°‘å¯¹ç³»ç»Ÿçš„å¼€å‘è¶Šæœ‰åˆ©ï¼Œå˜æ›´çš„é£é™©å°±è¶Šå°‘ï¼ŒåŒæ—¶ä¹Ÿæœ‰åˆ©äºé™ä½æˆæœ¬ã€‚ â€‹ 3.å®šåˆ¶æœåŠ¡ï¼šå•ç‹¬ä¸ºä¸€ä¸ªä¸ªä½“ä½“ç”¨ä¼˜è‰¯çš„æœåŠ¡ã€‚åªæä¾›è®¿é—®è€…éœ€è¦çš„æ–¹æ³•ã€‚ â€‹ 4.æ¥å£è®¾è®¡æ˜¯ç”±é™åº¦çš„:æ¥å£è®¾è®¡ç²’åº¦è¶Šå°è¶Šçµæ´»ï¼Œçµæ´»å¸¦æ¥äº†æ¥å£å¤æ‚åŒ–ï¼Œå¼€å‘éš¾åº¦å¢åŠ ï¼Œå¯ç»´æŠ¤æ€§é™ä½ã€‚æŠŠæ¡å¥½â€œåº¦â€ã€‚ 5. è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆLKP/LoDï¼‰è‹±æ–‡ï¼šLaw of Demeter ä¹Ÿç§° Least Knowledge Principle å…³é”®è¯ï¼šé«˜å†…èšã€ä½è€¦åˆ å®šä¹‰ï¼šä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡æœ‰æœ€å°‘çš„äº†è§£ã€‚ â€‹ é€šä¿—è§£é‡Šï¼šä¸€ä¸ªç±»åº”è¯¥å¯¹è‡ªå·±éœ€è¦è€¦åˆæˆ–è€…è°ƒç”¨çš„ç±»çŸ¥é“å¾—è¶Šå°‘(å³è§£è€¦ã€å¼±è€¦) å®šä¹‰æ‹†è§£ï¼š â€‹ 4å±‚å«ä¹‰ï¼š â€‹ 1.åªä¸ç›´æ¥çš„æœ‹å‹é€šä¿¡ ï¼Œæœ‹å‹ç±»ï¼šå‡ºç°åœ¨æˆå‘˜å˜é‡ã€æ–¹æ³•çš„è¾“å…¥è¾“å‡ºå‚æ•°ä¸­çš„ç±»ç§°ä¸ºæˆå‘˜æœ‹å‹ç±»ï¼Œè€Œå‡ºç°åœ¨æ–¹æ³•ä½“å†…éƒ¨çš„ç±»ä¸å±äºæœ‹å‹ç±» â€‹ 2.æœ‹å‹é—´æ˜¯æœ‰è·ç¦»çš„ï¼šå°½é‡ä¸è¦å¯¹å¤–å…¬å¸ƒå¤ªå¤šçš„publicæ–¹æ³•å’Œéé™æ€çš„publicå˜é‡ï¼Œå°½é‡å†…æ•›ï¼Œå¤šä½¿ç”¨privateã€package-privateã€protectç­‰è®¿é—®æƒé™ â€‹ 3.æ˜¯è‡ªå·±çš„å°±æ˜¯è‡ªå·±çš„ï¼šå¦‚æœä¸€ä¸ªæ–¹æ³•æ”¾åœ¨æœ¬ç±»ä¸­ï¼Œå³ä¸å¢åŠ ç±»é—´å…³ç³»ï¼Œä¹Ÿå¯¹æœ¬ç±»ä¸äº§ç”Ÿè´Ÿé¢å½±å“ï¼Œé‚£å°±æ”¾ç½®åœ¨æœ¬ç±»ä¸­ã€‚ â€‹ 4.è°¨æ…ä½¿ç”¨Serializable æœ€ä½³å®è·µï¼šä¸€ä¸ªç±»è·³è½¬ä¸¤æ¬¡ä»¥ä¸Šæ‰èƒ½è®¿é—®åˆ°å¦ä¸€ä¸ªç±»ï¼Œå°±éœ€è¦æƒ³åŠæ³•è¿›è¡Œé‡æ„ 6. å¼€é—­åŸåˆ™ï¼ˆOCPï¼‰è‹±æ–‡ï¼šOpen Closed Principle å®šä¹‰ï¼šä¸€ä¸ªè½¯ä»¶å®ä½“å¦‚ç±»ã€æ¨¡å—å’Œå‡½æ•°åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ äºŒã€23ç§è®¾è®¡æ¨¡å¼ï¼ˆ5ï¼‰1. åˆ›å»ºå‹æ¨¡å¼1.1. ç®€å•å·¥å‚æ¨¡å¼ï¼ˆSFPï¼‰è‹±æ–‡ï¼šSimple Factory Pattern å®šä¹‰ï¼šç”±ä¸€ä¸ªå·¥å‚å¯¹è±¡å†³å®šåˆ›å»ºå‡ºå“ªä¸€ç§ç±»å‹å®ä¾‹ã€‚å®¢æˆ·ç«¯åªéœ€ä¼ å…¥å·¥å‚ç±»çš„å‚æ•°ï¼Œæ— éœ€å…³å¿ƒåˆ›å»ºè¿‡ç¨‹ã€‚ ä¼˜ç‚¹ï¼šå…·ä½“äº§å“ä»å®¢æˆ·ç«¯ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œè§£è€¦ã€‚ ç¼ºç‚¹ï¼šå·¥å‚ç±»èŒè´£è¿‡é‡ï¼Œå¢åŠ æ–°çš„ç±»å‹æ—¶ï¼Œå¾—ä¿®æ”¹å·¥å‚ç±»çš„ä»£ç ï¼Œè¿èƒŒOCPã€‚ æœ€ä½³å®è·µï¼šä¸¥æ ¼æ„ä¹‰æ¥è¯´ï¼ŒSFPä¸å±äºè®¾è®¡æ¨¡å¼çš„ä¸€ç§ ä¸¾ä¾‹ï¼šç®€å•å·¥å‚æ¨¡å¼-ç³–æœç”Ÿäº§ åˆ›å»ºç³–æœæŠ½è±¡ç±» public abstract class Candy { public abstract void eat(); } åˆ›å»ºæŠ½è±¡ç³–æœå®ç°ç±»-å·§å…‹åŠ›ç­‰ public class Chocolate extends Candy{ @Override public void eat() { System.out.println("eat chocolate ing..."); } } åˆ›å»ºç³–æœå·¥å‚ç±» public class CandyFactory { public Candy product(String candyName){ if("chocolate".equalsIgnoreCase(candyName)){ return new Chocolate(); }else{ return null; } } } æµ‹è¯• public class SfpTest { public static void main(String[] args) { CandyFactory candyFactory = new CandyFactory(); Candy chocolate = candyFactory.product("chocolate"); chocolate.eat(); } } è¾“å‡º eat chocolate ing... 1.2. å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFMPï¼‰è‹±æ–‡ï¼šFactory Method Pattern å®šä¹‰ï¼šå®šä¹‰åˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å®ç°è¿™ä¸ªæ¥å£çš„ç±»æ¥å†³å®šå®ä¾‹åŒ–å“ªä¸ªç±»ï¼Œå·¥å‚æ–¹æ³•è®©ç±»çš„å®ä¾‹åŒ–æ¨è¿Ÿåˆ°å­ç±»è¿›è¡Œã€‚ ä¼˜ç‚¹ï¼š å…·ä½“äº§å“ä»å®¢æˆ·ç«¯ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œå®ç°äº†è§£è€¦ã€‚ åŠ å…¥æ–°çš„ç±»å‹æ—¶ï¼Œåªéœ€æ·»åŠ æ–°çš„å·¥å‚æ–¹æ³•ï¼ˆæ— éœ€ä¿®æ”¹æ—§çš„å·¥å‚æ–¹æ³•ä»£ç ï¼‰ï¼Œç¬¦åˆOCPã€‚ ç¼ºç‚¹ï¼šç±»çš„ä¸ªæ•°å®¹æ˜“è¿‡å¤šï¼Œå¢åŠ å¤æ‚åº¦ã€‚ æœ€ä½³å®è·µï¼š ä¸¾ä¾‹ï¼š åˆ›å»ºç³–æœæŠ½è±¡ç±» public abstract class Candy { public abstract void eat(); } åˆ›å»ºæŠ½è±¡å·¥å‚ç±» public abstract class CandyFactory { public abstract Candy product(); } åˆ›å»ºæŠ½è±¡ç³–æœå®ç°ç±»-ç‰ç±³è½¯ç³–ç­‰ public class CornFudge extends Candy{ @Override public void eat() { System.out.println("eat corn fudge ing..."); } } åˆ›å»ºæŠ½è±¡å·¥å‚å®ç°ç±»-ç‰ç±³è½¯ç³–å·¥å‚ç­‰ public class CornFudgeFactory extends CandyFactory { @Override public Candy product() { return new CornFudge(); } } æµ‹è¯• public class FmpTest { public static void main(String[] args) { CornFudgeFactory cornFudgeFactory = new CornFudgeFactory(); Candy cornFudge = cornFudgeFactory.product(); cornFudge.eat(); } } 6.è¾“å‡º eat corn fudge ing... 1.3. æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAFPï¼‰è‹±æ–‡ï¼šAbstract Factory Pattern å®šä¹‰ï¼šæä¾›äº†ä¸€ç³»åˆ—ç›¸å…³æˆ–è€…ç›¸äº’ä¾èµ–çš„å¯¹è±¡çš„æ¥å£ ä¼˜ç‚¹ï¼š å…·ä½“äº§å“ä»å®¢æˆ·ç«¯ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œå®ç°è§£è€¦ã€‚ å°†ä¸€ä¸ªç³»åˆ—çš„äº§å“æ—ç»Ÿä¸€åˆ°ä¸€èµ·åˆ›å»º ç¼ºç‚¹ï¼šæ‹“å±•æ–°çš„åŠŸèƒ½å›°éš¾ï¼Œéœ€è¦ä¿®æ”¹æŠ½è±¡å·¥å‚çš„æ¥å£ æœ€ä½³å®è·µï¼š ä¸¾ä¾‹ï¼š åˆ›å»ºæŠ½è±¡ç³–æœç±» public abstract class Candy { public abstract void eat(); public abstract void buy(); } åˆ›å»ºæŠ½è±¡ä»·æ ¼ç±» public abstract class Price { public abstract void pay(); } åˆ›å»ºæŠ½è±¡å·¥å‚æ¥å£ public interface CandyFactory { Candy getCandy(); Price getPrice(); } å®ç°æŠ½è±¡å·¥å‚æ¥å£-æ£’æ£’ç³–å·¥å‚ public class LollipopFactory implements CandyFactory{ @Override public Candy getCandy() { return new Lollipop(); } @Override public Price getPrice() { return new LollipopPrice(); } } åˆ›å»ºäº§å“æ— public class Lollipop extends Candy { @Override public void eat() { System.out.println("eat lollipop ing..."); } @Override public void buy() { System.out.println("buy lollipop"); } } public class LollipopPrice extends Price{ @Override public void pay() { System.out.println("lollipop sell $2"); } } æµ‹è¯• public class afpTest { public static void main(String[] args) { LollipopFactory lollipopFactory = new LollipopFactory(); lollipopFactory.getPrice().pay(); lollipopFactory.getCandy().buy(); lollipopFactory.getCandy().eat(); } } è¾“å‡º lollipop sell $2 buy lollipop eat lollipop ing... 1.4. å»ºé€ è€…æ¨¡å¼ï¼ˆBPï¼‰è‹±æ–‡ï¼šBuilder Pattern å®šä¹‰ï¼šä¹Ÿç§°ä¸ºç”Ÿæˆå™¨æ¨¡å¼ï¼Œå°†å¤æ‚å¯¹è±¡çš„å»ºé€ è¿‡ç¨‹æŠ½è±¡å‡ºæ¥ï¼ˆæŠ½è±¡ç±»åˆ«ï¼‰ï¼Œä½¿è¿™ä¸ªæŠ½è±¡è¿‡ç¨‹çš„ä¸åŒå®ç°æ–¹æ³•å¯ä»¥æ„é€ å‡ºä¸åŒè¡¨ç°ï¼ˆå±æ€§ï¼‰çš„å¯¹è±¡ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼Œç›¸åŒçš„è¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“ã€‚ ä¼˜ç‚¹ï¼š å°è£…æ€§å¥½ï¼Œåˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦» æ‹“å±•æ€§å¥½ï¼Œå»ºé€ ç±»ä¹‹é—´ç‹¬ç«‹ï¼Œä¸€å®šç¨‹åº¦ä¸Šè§£è€¦ã€‚ ç¼ºç‚¹ï¼š äº§ç”Ÿå¤šä½™çš„Builderå¯¹è±¡ï¼› äº§å“å†…éƒ¨å‘ç”Ÿå˜åŒ–ï¼Œå»ºé€ è€…éœ€è¦æ›´æ”¹ï¼Œæˆæœ¬è¾ƒå¤§ã€‚ æœ€ä½³å®è·µï¼š ä¸€ä¸ªå¯¹è±¡æœ‰éå¸¸å¤æ‚çš„å†…éƒ¨ç»“æ„ï¼ˆå¾ˆå¤šå±æ€§ï¼‰ æƒ³å°†å¤æ‚å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»ã€‚ ä¸¾ä¾‹ï¼š åˆ›å»ºå•†é“ºç±»Store(åŒ…å«å¤šå±æ€§) public class Store { private String name; private String location; private String type; @Override public String toString() { return "Store{" + "name='" + name + '\'' + ", location='" + location + '\'' + ", type='" + type + '\'' + '}'; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String getLocation() { return location; } public void setLocation(String location) { this.location = location; } public String getType() { return type; } public void setType(String type) { this.type = type; } } åˆ›å»ºå•†é“ºæŠ½è±¡ç”Ÿæˆå™¨ StoreBuilderï¼ˆåŒ…å«å’ŒStoreç›¸åŒçš„å±æ€§åŠå¯¹åº”çš„æŠ½è±¡æ„é€ æ–¹æ³•ï¼‰ public abstract class StoreBuilder { private String name; private String location; private String type; public abstract void name(String name); public abstract void location(String location); public abstract void type(String type); public abstract Store build(); } åˆ›å»ºå•†é“ºæŠ½è±¡ç”Ÿæˆå™¨çš„å®ç°ï¼Œç³–æœé“ºæ„é€ å™¨CandyStoreBuilder public class CandyStoreBuilder extends StoreBuilder { private Store store = new Store(); @Override public void name(String name) { this.store.setName(name); } @Override public void location(String location) { this.store.setLocation(location); } @Override public void type(String type) { this.store.setType(type); } @Override public Store build() { return store; } } åˆ›å»ºç»é”€å•†ç±»Dealer,ç”¨äºé€šè¿‡StoreBuilderæ„å»ºå…·ä½“çš„å•†é“º public class Dealer { private StoreBuilder storeBuilder; public void setStoreBuilder(StoreBuilder storeBuilder) { this.storeBuilder = storeBuilder; } public Store build(String name, String location, String type) { this.storeBuilder.name(name); this.storeBuilder.location(location); this.storeBuilder.type(type); return storeBuilder.build(); } } æµ‹è¯• public class BpTest { public static void main(String[] args) { Dealer dealer = new Dealer(); dealer.setStoreBuilder(new CandyStoreBuilder()); Store store = dealer.build("ç”œèœœèœœç³–æœåº—", "ä¸Šæµ·å¸‚é™†å®¶å˜´77å·", "ç³–æœç»é”€"); System.out.println(store); } } è¾“å‡º Store{name='ç”œèœœèœœç³–æœåº—', location='ä¸Šæµ·å¸‚é™†å®¶å˜´77å·', type='ç³–æœç»é”€'} 1.5. å•ä¾‹æ¨¡å¼ (SP)è‹±æ–‡ï¼šSingleton Pattern å®šä¹‰ï¼šä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ ä¼˜ç‚¹ï¼š å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜å¼€é”€ï¼› é¿å…å¯¹èµ„æºçš„å¤šé‡å ç”¨ï¼› ç¼ºç‚¹ï¼šæ²¡æœ‰æ¥å£ï¼Œæ‹“å±•å›°éš¾ã€‚ æœ€ä½³å®è·µï¼š æ¨¡å¼ æè¿° æ–¹å¼ ä¼˜ç‚¹ ç¼ºç‚¹ æ˜¯å¦æ¨è é¥¿æ±‰æ¨¡å¼ ä¸ç®¡éœ€ä¸éœ€è¦ç”¨åˆ°å®ä¾‹éƒ½è¦å»åˆ›å»ºå®ä¾‹ - çº¿ç¨‹å®‰å…¨ ä¸ç®¡ç”¨åˆ°ä¸å¦,ç±»åŠ è½½åˆ°å†…å­˜åï¼Œå°±å®ä¾‹åŒ–ä¸€ä¸ªå•ä¾‹ æœ‰ç¼ºç‚¹,ç®€å•å®ç”¨,æ¨èä½¿ç”¨ æ‡’æ±‰æ¨¡å¼ éœ€è¦ç”¨åˆ°åˆ›å»ºå®ä¾‹äº†ç¨‹åºå†å»åˆ›å»ºå®ä¾‹ æ–¹å¼ä¸€ï¼šé”,åŒé‡åˆ¤ç©ºæ–¹å¼ 1.çº¿ç¨‹å®‰å…¨ 2.ç”¨çš„æ—¶å€™,å†å®ä¾‹åŒ– é™ä½ç¨‹åºæ•ˆç‡(åˆ¤ç©º+é”) ä¸æ¨è æ–¹å¼äºŒï¼šé™æ€å†…éƒ¨ç±»æ–¹å¼ 1.çº¿ç¨‹å®‰å…¨(JVMä¿è¯å•ä¾‹) 2.åŠ è½½å¤–éƒ¨ç±»ä¸ä¼šåŠ è½½å†…éƒ¨ç±»,å®ç°äº†æ‡’åŠ è½½ - å®Œç¾å†™æ³•,æ¨è æšä¸¾æ¨¡å¼ - - 1. è§£å†³çº¿ç¨‹åŒæ­¥2. é˜²æ­¢ååºåˆ—åŒ–åŸå› ï¼šç”±äºæšä¸¾æ²¡æœ‰æ„é€ æ–¹æ³•ï¼Œä¸ä¼šè¢«åå°„åå°„åŸç†ï¼šç±»çš„classæ–‡ä»¶åŠ è½½åˆ°å†…å­˜,åå°„ï¼ˆååºåˆ—åŒ–çš„æ–¹å¼ï¼‰newä¸€ä¸ªå®ä¾‹ï¼ˆå‰æè¦æœ‰æ„é€ æ–¹æ³•ï¼‰ - å®Œç¾ä¸­çš„å®Œç¾,æ¨è ä¸¾ä¾‹ï¼š é¥¿æ±‰æ¨¡å¼ã€æ‡’æ±‰æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ 1.1. é¥¿æ±‰æ¨¡å¼ æ–¹å¼ä¸€ï¼šé—´æ¥å£°æ˜-é™æ€ä»£ç å—new public class SingletonHunger01 { //æ–¹å¼ä¸€ ï¼šé—´æ¥å£°æ˜-é™æ€ä»£ç å—new private static final SingletonHunger01 INSTANCE; static{ INSTANCE = new SingletonHunger01(); } //æ„é€ æ–¹æ³•è®¾ä¸ºç§æœ‰,ä½¿å¾—å…¶ä»–ç±»ä¸èƒ½new private SingletonHunger01(){}; public static SingletonHunger01 getInstance(){ return INSTANCE; } } â€‹ æ–¹å¼äºŒï¼šç›´æ¥å£°æ˜-ç›´æ¥new public class SingletonHunger02 { //æ–¹å¼äºŒï¼šç›´æ¥å£°æ˜-ç›´æ¥new private static final SingletonHunger02 INSTANCE = new SingletonHunger02(); //æ„é€ æ–¹æ³•è®¾ä¸ºç§æœ‰,ä½¿å¾—å…¶ä»–ç±»ä¸èƒ½new private SingletonHunger02(){}; public static SingletonHunger02 getInstance(){ return INSTANCE; } } â€‹ 1.2. æ‡’æ±‰æ¨¡å¼ â€‹ æ–¹å¼ä¸€ï¼šé”,åŒé‡åˆ¤ç©ºæ–¹å¼ public class SingletonLazy01 { public static SingletonLazy01 INSTANCE = null; //æ„é€ æ–¹æ³•è®¾ä¸ºç§æœ‰,ä½¿å¾—å…¶ä»–ç±»ä¸èƒ½new private SingletonLazy01(){}; public static SingletonLazy01 getInstance(){ if(INSTANCE == null){ //é™ä½æ¯æ¬¡è¿›æ¥éƒ½éœ€è¦åˆ¤æ–­é” synchronized (SingletonLazy01.class){ if(INSTANCE == null){ INSTANCE = new SingletonLazy01(); } } } return INSTANCE; } } â€‹ æ–¹å¼äºŒï¼šé™æ€å†…éƒ¨ç±»æ–¹å¼ public class SingletonLazy02 { private SingletonLazy02(){}; //é™æ€å†…éƒ¨ç±» private static class StaticInner{ private final static SingletonLazy02 INSTANCE = new SingletonLazy02(); } public static SingletonLazy02 getInstance(){ return StaticInner.INSTANCE; } } â€‹ 1.3. æšä¸¾å•ä¾‹ public enum SingletonEnum { //å•ä¾‹æšä¸¾ INSTANCE; } æµ‹è¯• public class SpTest { public static void main(String[] args) { System.out.println("HASHCODE-hashç ,åŒä¸€ä¸ªç±»ä¸­çš„hashç ä¸ä¼šç›¸åŒ,ä¸åŒç±»çš„hashcodeä¸èƒ½ä¿è¯ç›¸åŒ"); System.out.println("é¥¿æ±‰æ¨¡å¼-é—´æ¥å£°æ˜æ–¹å¼-"+SingletonHunger01.getInstance().hashCode()); System.out.println("é¥¿æ±‰æ¨¡å¼-ç›´æ¥å£°æ˜æ–¹å¼-"+SingletonHunger02.getInstance().hashCode()); System.out.println("æ‡’æ±‰æ¨¡å¼-é”,åŒé‡åˆ¤ç©ºæ–¹å¼-"+SingletonLazy01.getInstance().hashCode()); System.out.println("æ‡’æ±‰æ¨¡å¼-é™æ€å†…éƒ¨ç±»æ–¹å¼-"+SingletonLazy02.getInstance().hashCode()); System.out.println("å•ä¾‹æ¨¡å¼-"+SingletonEnum.INSTANCE.hashCode()); } } è¾“å‡º HASHCODE-hashç ,åŒä¸€ä¸ªç±»ä¸­çš„hashç ä¸ä¼šç›¸åŒ,ä¸åŒç±»çš„hashcodeä¸èƒ½ä¿è¯ç›¸åŒ é¥¿æ±‰æ¨¡å¼-é—´æ¥å£°æ˜æ–¹å¼-1856056345 é¥¿æ±‰æ¨¡å¼-ç›´æ¥å£°æ˜æ–¹å¼-221036634 æ‡’æ±‰æ¨¡å¼-é”,åŒé‡åˆ¤ç©ºæ–¹å¼-1418370913 æ‡’æ±‰æ¨¡å¼-é™æ€å†…éƒ¨ç±»æ–¹å¼-707610042 å•ä¾‹æ¨¡å¼-551734240 1.6. åŸå‹æ¨¡å¼ï¼ˆPPï¼‰è‹±æ–‡ï¼šPrototype Pattern å®šä¹‰ï¼šç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ ä¼˜ç‚¹ï¼š åŸå‹æ¨¡å¼æ˜¯åœ¨å†…å­˜ä¸­äºŒè¿›åˆ¶æµçš„æ‹·è´ï¼Œè¦æ¯”newä¸€ä¸ªå¯¹è±¡çš„æ€§èƒ½è¦å¥½ï¼Œç‰¹åˆ«æ˜¯éœ€è¦äº§ç”Ÿå¤§é‡å¯¹è±¡æ—¶ã€‚ ç®€åŒ–åˆ›å»ºå¯¹è±¡è¿‡ç¨‹ã€‚ ç¼ºç‚¹ï¼š å¯¹è±¡å¿…é¡»é‡å†™Objectå…‹éš†æ–¹æ³•ï¼› ç›´æ¥åœ¨å†…å­˜ä¸­æ‹·è´ï¼Œæ„é€ å‡½æ•°æ˜¯ä¸ä¼šæ‰§è¡Œ å¤æ‚å¯¹è±¡çš„å…‹éš†æ–¹æ³•å†™èµ·æ¥è¾ƒéº»çƒ¦ï¼ˆæµ…å…‹éš†ã€æ·±å…‹éš†ï¼‰ å…‹éš†ä¼šç ´åå®ç°äº†Cloneableæ¥å£çš„å•ä¾‹å¯¹è±¡ æœ€ä½³å®è·µï¼š å¦‚æœç±»çš„åˆå§‹åŒ–éœ€è¦è€—è´¹è¾ƒå¤šçš„èµ„æºï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡åŸå‹æ‹·è´é¿å…è¿™äº›æ¶ˆè€—ã€‚ é€šè¿‡newäº§ç”Ÿä¸€ä¸ªå¯¹è±¡éœ€è¦éå¸¸ç¹ççš„æ•°æ®å‡†å¤‡æˆ–è®¿é—®æƒé™ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼ã€‚ ä¸€ä¸ªå¯¹è±¡éœ€è¦æä¾›ç»™å…¶ä»–å¯¹è±¡è®¿é—®ï¼Œè€Œä¸”å„ä¸ªè°ƒç”¨è€…å¯èƒ½éƒ½éœ€è¦ä¿®æ”¹å…¶å€¼æ—¶ï¼Œå¯ä»¥æ‹·è´å¤šä¸ªå¯¹è±¡ä¾›è°ƒç”¨è€…ä½¿ç”¨ï¼Œå³ä¿æŠ¤æ€§æ‹·è´ã€‚ æ‹“å±•ï¼š å…‹éš†åˆ†ç±» å®ç° æµ…å…‹éš† åªå¤åˆ¶åŸºæœ¬ç±»å‹çš„æ•°æ®ï¼Œå¼•ç”¨ç±»å‹çš„æ•°æ®åªå¤åˆ¶äº†å¼•ç”¨çš„åœ°å€ï¼Œå¼•ç”¨çš„å¯¹è±¡å¹¶æ²¡æœ‰å¤åˆ¶ï¼Œåœ¨æ–°çš„å¯¹è±¡ä¸­ä¿®æ”¹å¼•ç”¨ç±»å‹çš„æ•°æ®ä¼šå½±å“åŸå¯¹è±¡ä¸­çš„å¼•ç”¨ã€‚ æ·±å…‹éš† æ–¹å¼ä¸€ï¼šåµŒå¥—é‡å†™cloneæ–¹æ³•ï¼šå®ç°Cloneableæ¥å£ï¼ˆå¼•ç”¨æ•°æ®ç±»å‹ä¹Ÿè¦å®ç°Cloneableæ¥å£ï¼‰ï¼Œé‡å†™cloneæ–¹æ³•ï¼Œcloneçš„åµŒå¥—ï¼Œå¤åˆ¶åçš„å¯¹è±¡ä¸åŸå¯¹è±¡ä¹‹é—´å®Œå…¨ä¸ä¼šå½±å“ã€‚æ–¹å¼äºŒï¼šåºåˆ—åŒ–å¯¹è±¡ï¼šå®ç°åºåˆ—åŒ–Serializableæ¥å£ï¼ˆä¸å®ç°Cloneableæ¥å£ï¼‰ï¼Œï¼ˆå¼•ç”¨æ•°æ®ç±»å‹ä¹Ÿè¦å®ç°Serializableï¼‰ï¼Œå¯¹è±¡åºåˆ—åŒ–åå†™å…¥æµä¸­ï¼Œæ­¤æ—¶ä¸å­˜åœ¨å¼•ç”¨æ•°æ®ç±»å‹çš„æ¦‚å¿µï¼Œä»æµä¸­è¯»å–ï¼Œç”Ÿæˆæ–°çš„å¯¹è±¡ï¼Œæ–°å¯¹è±¡å’ŒåŸå¯¹è±¡ä¹‹é—´ä¹Ÿæ˜¯å®Œå…¨äº’ä¸å½±å“çš„ã€‚ ä¸¾ä¾‹ï¼š 1.1. æµ…å…‹éš†ï¼ˆç®€å•å±æ€§ï¼‰ï¼šåˆ›å»ºå¯¹è±¡ï¼Œå®ç°Cloneableï¼Œé‡å†™cloneæ–¹æ³• public class CandyShallow implements Cloneable { private String name; private String color; public String getName() { return name; } public void setName(String name) { this.name = name; } public String getColor() { return color; } public void setColor(String color) { this.color = color; } //æµ…å…‹éš† @Override protected Object clone() throws CloneNotSupportedException { return super.clone(); } @Override public String toString() { return "CandyShallow{" + "name='" + name + '\'' + ", color='" + color + '\'' + '}'; } } 1.2. æµ‹è¯• public class PpTest { public static void main(String[] args) throws CloneNotSupportedException { CandyShallow candyShallow = new CandyShallow(); ArrayList&lt;CandyShallow> list = new ArrayList&lt;>(); for (int i = 0; i &lt; 3; i++) { CandyShallow clone = (CandyShallow)candyShallow.clone(); clone.setName("ALPENLIEBE"+i); clone.setColor("color"+i); list.add(clone); } System.out.println(list); } } 1.3. è¾“å‡º [Candy{name='ALPENLIEBE0', color='color0'}, Candy{name='ALPENLIEBE1', color='color1'}, Candy{name='ALPENLIEBE2', color='color2'}] 2.1. æ–¹å¼ä¸€ï¼šå®ç°Cloneable,åµŒå¥—é‡å†™cloneæ–¹æ³• public class CandyDeep implements Cloneable { private String name; private String color; private Stuffing stuffing; //--------------------------------------é‡ç‚¹â†“ /** * æ–¹å¼ä¸€ï¼šé‡å†™cloneæ–¹æ³•ï¼Œå®ç°æ·±æ‹·è´ * æ³¨ï¼šè¯¥æ–¹å¼çš„ç¼ºé™·æ˜¯éœ€è¦å•ç‹¬å¤„ç†æ‰€æœ‰è¦å…‹éš†çš„ç±»ä¸­çš„å¼•ç”¨æ•°æ®ç±»å‹(Stuffing) */ @Override protected Object clone(){ CandyDeep candyDeep = null; try { candyDeep = (CandyDeep) super.clone(); candyDeep.stuffing = (Stuffing)this.stuffing.clone(); } catch (CloneNotSupportedException e) { e.printStackTrace(); } return candyDeep; } //--------------------------------------é‡ç‚¹â†‘ @Override public String toString() { return "CandyDeep{" + "name='" + name + '\'' + ", color='" + color + '\'' + ", stuffing=" + stuffing + '}'; } public CandyDeep(String name, String color, Stuffing stuffing) { this.name = name; this.color = color; this.stuffing = stuffing; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String getColor() { return color; } public void setColor(String color) { this.color = color; } public Stuffing getStuffing() { return stuffing; } public void setStuffing(Stuffing stuffing) { this.stuffing = stuffing; } } public class Stuffing implements Cloneable{ private String body; private String form; private String color; //--------------------------------------é‡ç‚¹â†“ //æ— å¼•ç”¨æ•°æ®ç±»å‹,æµ…å…‹éš†å³å¯ @Override protected Object clone() throws CloneNotSupportedException { return super.clone(); } //--------------------------------------é‡ç‚¹â†‘ @Override public String toString() { return "Stuffing{" + "body='" + body + '\'' + ", form='" + form + '\'' + ", color='" + color + '\'' + '}'; } public Stuffing(String body, String form, String color) { this.body = body; this.form = form; this.color = color; } public String getBody() { return body; } public void setBody(String body) { this.body = body; } public String getForm() { return form; } public void setForm(String form) { this.form = form; } public String getColor() { return color; } public void setColor(String color) { this.color = color; } } 2.2. æ–¹å¼äºŒï¼ˆæ¨èï¼‰ï¼šåºåˆ—åŒ–å¯¹è±¡ public class CandyDeep2 implements Serializable { private static final long serialVersionUID = 1L; private String name; private String color; private Stuffing2 stuffing2; //--------------------------------------é‡ç‚¹â†“ public CandyDeep2 deepClone() { ByteArrayOutputStream bos = null; ObjectOutputStream oos = null; ByteArrayInputStream bis = null; ObjectInputStream ois = null; try { //åˆ›å»ºåºåˆ—åŒ–æµ bos = new ByteArrayOutputStream(); oos = new ObjectOutputStream(bos); //å°†å½“å‰å¯¹è±¡ä»¥å¯¹è±¡æµçš„æ–¹å¼è¾“å‡º oos.writeObject(this); //åˆ›å»ºååºåˆ—åŒ–æµ bis = new ByteArrayInputStream(bos.toByteArray()); ois = new ObjectInputStream(bis); //å°†æµå¯¹è±¡ååºåˆ—åŒ–,ä»è€Œå®ç°ç±»çš„æ·±æ‹·è´ return (CandyDeep2) ois.readObject(); } catch (IOException | ClassNotFoundException e) { e.printStackTrace(); return null; } finally { try { //èµ„æºé‡Šæ”¾ bos.close(); bis.close(); oos.close(); ois.close(); } catch (IOException e) { e.printStackTrace(); } } } //--------------------------------------é‡ç‚¹â†‘ @Override public String toString() { return "CandyDeep2{" + "name='" + name + '\'' + ", color='" + color + '\'' + ", stuffing2=" + stuffing2 + '}'; } public CandyDeep2(String name, String color, Stuffing2 stuffing2) { this.name = name; this.color = color; this.stuffing2 = stuffing2; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String getColor() { return color; } public void setColor(String color) { this.color = color; } public Stuffing2 getStuffing2() { return stuffing2; } public void setStuffing2(Stuffing2 stuffing2) { this.stuffing2 = stuffing2; } } public class Stuffing2 implements Serializable { private static final long serialVersionUID = 1L; private String body; private String form; private String color; @Override public String toString() { return "Stuffing2{" + "body='" + body + '\'' + ", form='" + form + '\'' + ", color='" + color + '\'' + '}'; } public Stuffing2(String body, String form, String color) { this.body = body; this.form = form; this.color = color; } public String getBody() { return body; } public void setBody(String body) { this.body = body; } public String getForm() { return form; } public void setForm(String form) { this.form = form; } public String getColor() { return color; } public void setColor(String color) { this.color = color; } } 2.3. æµ‹è¯• public static void main(String[] args) { System.out.println("æ·±å…‹éš†,æ–¹å¼ä¸€:"); CandyDeep candyDeep = new CandyDeep("é»‘è‰²","é…’å¿ƒå·§å…‹åŠ›",new Stuffing("é…’é¥®æ–™","æ¶²ä½“","æ— è‰²")); System.out.println(candyDeep); //candyDeep å’Œ cloneCandy éåŒä¸€ä¸ªå¯¹è±¡ CandyDeep cloneCandy = (CandyDeep) candyDeep.clone(); System.out.println(cloneCandy); System.out.println("+++++++++++++++++++åä¸½çš„åˆ†ç•Œçº¿++++++++++++++++++++++"); System.out.println("æ·±å…‹éš†,æ–¹å¼äºŒ:"); CandyDeep2 candyDeep2 = new CandyDeep2("ç™½è‰²","æœä»å·§å…‹åŠ›",new Stuffing2("æœä»","å›ºä½“","æ£•è‰²")); System.out.println(candyDeep2); //candyDeep2 å’Œ cloneCandy2 éåŒä¸€ä¸ªå¯¹è±¡ CandyDeep2 cloneCandy2 = candyDeep2.deepClone(); System.out.println(cloneCandy2); } 2.4. è¾“å‡º æ·±å…‹éš†,æ–¹å¼ä¸€: CandyDeep{name='é»‘è‰²', color='é…’å¿ƒå·§å…‹åŠ›', stuffing=Stuffing{body='é…’é¥®æ–™', form='æ¶²ä½“', color='æ— è‰²'}} CandyDeep{name='é»‘è‰²', color='é…’å¿ƒå·§å…‹åŠ›', stuffing=Stuffing{body='é…’é¥®æ–™', form='æ¶²ä½“', color='æ— è‰²'}} +++++++++++++++++++åä¸½çš„åˆ†ç•Œçº¿++++++++++++++++++++++ æ·±å…‹éš†,æ–¹å¼äºŒ: CandyDeep2{name='ç™½è‰²', color='æœä»å·§å…‹åŠ›', stuffing2=Stuffing2{body='æœä»', form='å›ºä½“', color='æ£•è‰²'}} CandyDeep2{name='ç™½è‰²', color='æœä»å·§å…‹åŠ›', stuffing2=Stuffing2{body='æœä»', form='å›ºä½“', color='æ£•è‰²'}} 2.ç»“æ„å‹æ¨¡å¼ï¼ˆ7ï¼‰2.1. å¤–è§‚æ¨¡å¼ï¼ˆFPï¼‰è‹±æ–‡ï¼šFacade Pattern å®šä¹‰ï¼šå¤–è§‚æ¨¡å¼åˆå«é—¨é¢æ¨¡å¼ï¼Œæä¾›äº†ç»Ÿä¸€çš„æ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£ã€‚ ä¼˜ç‚¹ï¼š ç®€åŒ–äº†è°ƒç”¨è¿‡ç¨‹ï¼Œæ— éœ€äº†è§£æ·±å…¥å­ç³»ç»Ÿ å‡ä½è€¦åˆåº¦ï¼› æ›´å¥½çš„å±‚æ¬¡åˆ’åˆ†ï¼› ç¬¦åˆLKPã€‚ ç¼ºç‚¹ï¼š å¢åŠ å­ç³»ç»Ÿï¼Œæ‹“å±•å­ç³»ç»Ÿè¡Œä¸ºå®¹æ˜“å¼•å…¥é£é™©ï¼› ä¸ç¬¦åˆOCPã€‚ æœ€ä½³å®è·µï¼š å­ç³»ç»Ÿè¶Šæ¥è¶Šå¤æ‚ï¼Œå¢åŠ å¤–è§‚æ¨¡å¼æä¾›ç®€å•æ¥å£è°ƒç”¨ï¼› æ„å»ºå¤šå±‚ç³»ç»Ÿç»“æ„ï¼Œåˆ©ç”¨å¤–è§‚å¯¹è±¡ä½œä¸ºæ¯å±‚çš„å…¥å£ï¼Œç®€åŒ–å±‚é—´è°ƒç”¨ã€‚ ä¸¾ä¾‹ï¼š å®¢æˆ·è´­ä¹°ç°åšè›‹ç³•ï¼Œå®¢æˆ·ç›´æ¥å’Œå‰å°æ‰“äº¤é“ï¼Œå‰å°å’Œåå°(åˆ¶ä½œè›‹ç³•,è£…é¥°,æ‰“åŒ…)ä¼ è¾¾ä¿¡æ¯ï¼Œåå°å¯¹äºå®¢æˆ·è¢«é€æ˜åŒ– åˆ›å»ºè›‹ç³•ä¿¡æ¯å®ä½“ public class CakeInfo { private String cakeName; private Double amount; private Integer num; @Override public String toString() { return "CakeInfo{" + "cakeName='" + cakeName + '\'' + ", amount=" + amount + ", num=" + num + '}'; } public Double getAmount() { return amount; } public void setAmount(Double amount) { this.amount = amount; } public Integer getNum() { return num; } public void setNum(Integer num) { this.num = num; } public String getCakeName() { return cakeName; } public void setCakeName(String cakeName) { this.cakeName = cakeName; } } åˆ›å»ºåå°-åˆ¶ä½œæœåŠ¡ public class MakeService { public boolean makeCake(String cakeName){ System.out.println("ç³•ç‚¹å¸ˆåˆ¶ä½œ"+cakeName); return true; } } åˆ›å»ºåå°-è£…é¥°æœåŠ¡ public class DecorateService { public boolean decorateCake(String cakeName){ System.out.println("è£…é¥°å¸ˆè£…é¥°"+cakeName); return true; } } åˆ›å»ºåå°-æ‰“åŒ…æœåŠ¡ public class PackageService { public boolean packageCake(String cakeName){ System.out.println("æ‰“åŒ…å¸ˆæ‰“åŒ…"+cakeName+",å¹¶è½¬äº¤å‰å°"); return true; } } åˆ›å»ºå‰å°æœåŠ¡èšåˆåå°æœåŠ¡ public class FrontDeskService { private MakeService maker = new MakeService(); private DecorateService decorator = new DecorateService(); private PackageService packer = new PackageService(); public void sellCake(CakeInfo cakeInfo){ System.out.println("å‰å°ä»å®¢æˆ·æ¥å—è›‹ç³•ä¿¡æ¯:"+cakeInfo); String cakeName = cakeInfo.getCakeName(); if(maker.makeCake(cakeName)){ if(decorator.decorateCake(cakeName)){ if(packer.packageCake(cakeName)){ System.out.println("å‰å°æ”¶åˆ°è›‹ç³•->è½¬äº¤å®¢æˆ·->æ”¶é“¶->é”€å”®æˆåŠŸ"); } } } } } æµ‹è¯• public class FpTest { public static void main(String[] args) { CakeInfo cakeInfo = new CakeInfo(); cakeInfo.setAmount(100.00); cakeInfo.setNum(1); cakeInfo.setCakeName("å·§å…‹åŠ›è›‹ç³•"); FrontDeskService frontDeskService = new FrontDeskService(); frontDeskService.sellCake(cakeInfo); } } è¾“å‡º å‰å°ä»å®¢æˆ·æ¥å—è›‹ç³•ä¿¡æ¯:CakeInfo{cakeName='å·§å…‹åŠ›è›‹ç³•', amount=100.0, num=1} ç³•ç‚¹å¸ˆåˆ¶ä½œå·§å…‹åŠ›è›‹ç³• è£…é¥°å¸ˆè£…é¥°å·§å…‹åŠ›è›‹ç³• æ‰“åŒ…å¸ˆæ‰“åŒ…å·§å…‹åŠ›è›‹ç³•,å¹¶è½¬äº¤å‰å° å‰å°æ”¶åˆ°è›‹ç³•->è½¬äº¤å®¢æˆ·->æ”¶é“¶->é”€å”®æˆåŠŸ 2.2. è£…é¥°è€…æ¨¡å¼ï¼ˆDPï¼‰è‹±æ–‡ï¼šDecorator Pattern å®šä¹‰ï¼šåœ¨ä¸æ”¹å˜åŸæœ‰å¯¹è±¡çš„åŸºç¡€ä¹‹ä¸Šï¼Œå°†åŠŸèƒ½é™„åŠ åˆ°å¯¹è±¡ä¸Šï¼Œæä¾›äº†æ¯”ç»§æ‰¿æ›´æœ‰å¼¹æ€§çš„æ›¿ä»£æ–¹æ¡ˆ ä¼˜ç‚¹ï¼š ç»§æ‰¿çš„æœ‰åŠ›è¡¥å……ï¼Œä¸æ”¹å˜åŸæœ‰å¯¹è±¡çš„æƒ…å†µä¸‹ç»™å¯¹è±¡æ‹“å±•åŠŸèƒ½ é€šè¿‡ä½¿ç”¨ä¸åŒçš„è£…é¥°ç±»ã€ä¸åŒçš„ç»„åˆæ–¹å¼ï¼Œå®ç°ä¸åŒçš„æ•ˆæœ ç¬¦åˆOCP ç¼ºç‚¹ï¼šå¢åŠ ç¨‹åºå¤æ‚æ€§ æœ€ä½³å®è·µï¼š æ‹“å±•ä¸€ä¸ªç±»çš„åŠŸèƒ½ åŠ¨æ€ç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½ï¼Œå¹¶ä¸”åŠ¨æ€æ’¤é”€ ä¸¾ä¾‹ï¼š å®¢æˆ·ä¹°è›‹ç³•ï¼Œè¦æ±‚å¯¹è›‹ç³•åŠ ä¸åŒææ–™(æœåˆ‡ï¼Œå¥¶æ²¹ï¼Œå·§å…‹åŠ›ï¼Œè£…é¥°ç”»ç­‰)ï¼Œä»·æ ¼ä¹Ÿéšä¹‹å˜åŠ¨ 1.åˆ›å»ºè›‹ç³•å¥—é¤æŠ½è±¡ç±» public abstract class CakePackage { public abstract String remark(); public abstract int price(); } 2.åˆ›å»ºè£…é¥°å™¨ç±»ç»§æ‰¿è›‹ç³•å¥—é¤æŠ½è±¡ç±» public class CakeDecorator extends CakePackage{ private CakePackage cakePackage; public CakeDecorator(CakePackage cakePackage) { this.cakePackage = cakePackage; } @Override public String remark() { return cakePackage.remark(); } @Override public int price() { return cakePackage.price(); } } 3.åˆ›å»ºæ ‡å‡†è›‹ç³•å¥—é¤ç±» public class StandardCakePackage extends CakePackage{ @Override public String remark() { return "è›‹ç³•èƒš\n"; } @Override public int price() { return 5; } } 4.åˆ›å»ºåŠ å¥¶æ²¹ã€æ°´æœã€ç³–æœç­‰å¢å€¼å¥—é¤ç±» public class CreamCakePackage extends CakeDecorator { public CreamCakePackage(CakePackage cakePackage) { super(cakePackage); } @Override public String remark() { return super.remark()+"åŠ å¥¶æ²¹\n"; } @Override public int price() { return super.price()+5; } } public class FruitCakePackage extends CakeDecorator { public FruitCakePackage(CakePackage cakePackage) { super(cakePackage); } @Override public String remark() { return super.remark() + "åŠ æ°´æœ\n"; } @Override public int price() { return super.price()+10; } } public class CandyCakePackage extends CakeDecorator { public CandyCakePackage(CakePackage cakePackage) { super(cakePackage); } @Override public String remark() { return super.remark()+"åŠ ç³–æœ\n"; } @Override public int price() { return super.price()+15; } } 5.æµ‹è¯• public class DpTest { public static void main(String[] args) { CakePackage cake = new StandardCakePackage(); cake = new CreamCakePackage(cake); cake = new FruitCakePackage(cake); cake = new CandyCakePackage(cake); System.out.println(cake.remark()+"ä»·æ ¼ï¼š"+cake.price()+"å…ƒ"); } } 6.è¾“å‡º è›‹ç³•èƒš åŠ å¥¶æ²¹ åŠ æ°´æœ åŠ ç³–æœ ä»·æ ¼ï¼š35å…ƒ 2.3. é€‚é…å™¨æ¨¡å¼ï¼ˆAPï¼‰è‹±æ–‡ï¼šAdapter Pattern å®šä¹‰ï¼šå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢ä¸ºæœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼Œä½¿åŸæœ¬ä¸å…¼å®¹çš„ç±»å¯ä»¥ä¸€èµ·å·¥ä½œ ä¼˜ç‚¹ï¼š æé«˜ç±»çš„é€æ˜æ€§å’Œå¤ç”¨ï¼Œç°æœ‰çš„ç±»å¤ç”¨ä½†ä¸éœ€æ”¹å˜ ç›®æ ‡ç±»å’Œé€‚é…å™¨ç±»è§£è€¦ï¼Œæé«˜ç¨‹åºæ‹“å±•æ€§ ç¬¦åˆOCP ç¼ºç‚¹ï¼š é€‚é…å™¨ç¼–å†™è¿‡ç¨‹éœ€è¦å…¨é¢è€ƒè™‘ï¼Œå¯èƒ½ä¼šå¢åŠ ç³»ç»Ÿçš„å¤æ‚æ€§ é™ä½ä»£ç å¯è¯»æ€§ æœ€ä½³å®è·µï¼šå·²å­˜åœ¨çš„ç±»ï¼Œå®ƒçš„æ–¹æ³•å’Œéœ€æ±‚ä¸åŒ¹é…æ—¶ï¼ˆæ–¹æ³•ç»“æœç›¸åŒæˆ–è€…ç›¸ä¼¼ï¼‰ ä¸¾ä¾‹ï¼š åŸæœ‰çš„è›‹ç³•äº§å“çº¿ï¼Œæ–°å¢ä¸€ä¸ªç‰©æ–™äº§å“çº¿(æ°´æœã€å¥¶æ²¹ç­‰)ï¼Œåœ¨ä¸ä¿®æ”¹åŸäº§å“çº¿çš„åŒæ—¶,ä¸¤ä¸ªäº§å“çº¿å…±åŒå·¥ä½œ åˆ›å»ºè›‹ç³•äº§å“çº¿ç±» public class Cake { public void makeCakes(){ System.out.println("ç”Ÿäº§è›‹ç³•"); } } åˆ›å»ºç‰©æ–™äº§å“çº¿æ¥å£ public interface Materiel { void make(); } è›‹ç³•äº§å“ç±»åŠ å…¥åˆ°ç‰©æ–™äº§å“çº¿ï¼Œåˆ›å»ºä¸€ä¸ªé€‚é…å™¨ //ä¸€èˆ¬é€‚é…å™¨ public class CreamCakeAdaptor extends Cake implements Materiel{ @Override public void make() { System.out.println("ç”Ÿäº§å¥¶æ²¹é¢„å¤‡"); super.makeCakes(); System.out.println("æ··åˆæˆå¥¶æ²¹è›‹ç³•"); } } //å¯¹è±¡é€‚é…å™¨ public class FruitCakeAdaptor implements Materiel{ Cake cake = new Cake(); @Override public void make() { System.out.println("ç”Ÿäº§æœåˆ‡é¢„å¤‡"); cake.makeCakes(); System.out.println("æ··åˆæˆæ°´æœè›‹ç³•"); } } æµ‹è¯• public class ApTest { public static void main(String[] args) { CreamCakeAdaptor creamCakeAdaptor = new CreamCakeAdaptor(); creamCakeAdaptor.make(); System.out.println("++++++++++++++åä¸½çš„åˆ†å‰²çº¿+++++++++++++++"); FruitCakeAdaptor fruitCakeAdaptor = new FruitCakeAdaptor(); fruitCakeAdaptor.make(); } } è¾“å‡º ç”Ÿäº§å¥¶æ²¹é¢„å¤‡ ç”Ÿäº§è›‹ç³• æ··åˆæˆå¥¶æ²¹è›‹ç³• ++++++++++++++åä¸½çš„åˆ†å‰²çº¿+++++++++++++++ ç”Ÿäº§æœåˆ‡é¢„å¤‡ ç”Ÿäº§è›‹ç³• æ··åˆæˆæ°´æœè›‹ç³• 2.4. äº«å…ƒæ¨¡å¼ï¼ˆFPï¼‰è‹±æ–‡ï¼šFlyweight Pattern å®šä¹‰ï¼šæä¾›äº†å‡å°‘å¯¹è±¡æ•°é‡ä»è€Œæ”¹å–„åº”ç”¨æ‰€éœ€çš„å¯¹è±¡ç»“æ„çš„æ–¹å¼ï¼Œè¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚ ä¼˜ç‚¹ï¼šå‡å°‘å¯¹è±¡çš„åˆ›å»ºï¼Œé™ä½å†…å­˜å ç”¨ï¼› ç¼ºç‚¹ï¼š å…³æ³¨å†…éƒ¨çŠ¶æ€æˆ–å¤–éƒ¨çŠ¶æ€ï¼Œå…³æ³¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼›ï¼ˆå†…éƒ¨çŠ¶æ€ï¼šäº«å…ƒå¯¹è±¡çš„å±æ€§çŠ¶æ€ï¼Œä¸ä¼šå› ä¸ºå¤–éƒ¨çš„æ”¹å˜è€Œæ”¹å˜ï¼› å¤–éƒ¨çŠ¶æ€ï¼šæ–¹æ³•å‚æ•°ï¼‰ ç¨‹åºçš„é€»è¾‘å¤æ‚åŒ–ã€‚ æœ€ä½³å®è·µï¼š å‡å°‘å¯¹è±¡çš„åˆ›å»ºï¼Œé™ä½å†…å­˜å ç”¨ï¼› ç»Ÿæ‹¥æœ‰å¤§é‡ç›¸ä¼¼å¯¹è±¡ï¼Œéœ€è¦ç¼“å†²æ± çš„åœºæ™¯ã€‚ ä¸¾ä¾‹ï¼šåˆ¶ä½œå¤§é‡ç›¸åŒç±»å‹çš„è›‹ç³•ï¼ˆä»£ç å…³é”®æ˜¯é€šè¿‡HashMapå­˜å‚¨å¯¹è±¡ï¼‰ åˆ›å»ºè›‹ç³•æ¥å£ public interface Cake { void make() throws InterruptedException; } å…·ä½“ç±»(å¦‚ï¼šæ°´æœç±»å‹è›‹ç³•)å®ç°è›‹ç³•æ¥å£ public class FruitCake implements Cake { private String name; private LocalDateTime productTime; public FruitCake(String name){ this.name = name; } public void setProductTime(LocalDateTime productTime) { this.productTime = productTime; } @Override public void make() { try { Thread.sleep(100); System.out.println(name+"ç”Ÿäº§æ—¶é—´ï¼š"+this.productTime); } catch (InterruptedException e) { e.printStackTrace(); } } } åˆ›å»ºæ°´æœè›‹ç³•çš„å·¥å‚ public class FruitCakeFactory { //å…³é”®ç‚¹ private static final HashMap&lt;String,FruitCake> CAKE_HASH_MAP = new HashMap&lt;>(); public static FruitCake product(String name){ FruitCake fruitCake = CAKE_HASH_MAP.get(name); if(fruitCake == null){ System.out.println("æ²¡æœ‰"+name+"åˆ¶ä½œæ–¹æ³•,å­¦ä¹ åˆ¶ä½œæ–¹æ³•"); fruitCake = new FruitCake(name); CAKE_HASH_MAP.put(name,fruitCake); } return fruitCake; } } æµ‹è¯• public class FpTest { private static final String[] CAKE_TYPE = {"è“è“è›‹ç³•","ç«é¾™æœè›‹ç³•","è‰è“è›‹ç³•","é¦™è•‰è›‹ç³•"}; public static void main(String[] args) { IntStream.range(0,10).forEach((i)->{ String name = CAKE_TYPE[(int)(Math.random() * CAKE_TYPE.length)]; FruitCake cake = FruitCakeFactory.product(name); cake.setProductTime(LocalDateTime.now()); cake.make(); }); } } è¾“å‡º 10æ¬¡å¾ªç¯ä¸­ï¼Œåªç”Ÿäº§äº†4ä¸ªå¯¹è±¡ï¼Œå¾ˆå¥½çš„æè¿°äº†ç³»ç»Ÿæœ‰å¤§é‡ç›¸ä¼¼å¯¹è±¡ï¼Œéœ€è¦ç¼“å†²æ± çš„åœºæ™¯ã€‚ JDKä¸­çš„å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œæ•°æ®åº“è¿æ¥æ± ç­‰éƒ½æ˜¯ç”¨çš„äº«å…ƒæ¨¡å¼ã€‚ æ²¡æœ‰è“è“è›‹ç³•åˆ¶ä½œæ–¹æ³•,å­¦ä¹ åˆ¶ä½œæ–¹æ³• è“è“è›‹ç³•ç”Ÿäº§æ—¶é—´ï¼š2020-12-13T10:49:17.647076600 è“è“è›‹ç³•ç”Ÿäº§æ—¶é—´ï¼š2020-12-13T10:49:17.779721700 æ²¡æœ‰è‰è“è›‹ç³•åˆ¶ä½œæ–¹æ³•,å­¦ä¹ åˆ¶ä½œæ–¹æ³• è‰è“è›‹ç³•ç”Ÿäº§æ—¶é—´ï¼š2020-12-13T10:49:17.881450300 è‰è“è›‹ç³•ç”Ÿäº§æ—¶é—´ï¼š2020-12-13T10:49:17.982180600 æ²¡æœ‰é¦™è•‰è›‹ç³•åˆ¶ä½œæ–¹æ³•,å­¦ä¹ åˆ¶ä½œæ–¹æ³• é¦™è•‰è›‹ç³•ç”Ÿäº§æ—¶é—´ï¼š2020-12-13T10:49:18.085903500 è“è“è›‹ç³•ç”Ÿäº§æ—¶é—´ï¼š2020-12-13T10:49:18.204594900 è“è“è›‹ç³•ç”Ÿäº§æ—¶é—´ï¼š2020-12-13T10:49:18.305322300 é¦™è•‰è›‹ç³•ç”Ÿäº§æ—¶é—´ï¼š2020-12-13T10:49:18.430981100 è‰è“è›‹ç³•ç”Ÿäº§æ—¶é—´ï¼š2020-12-13T10:49:18.541684900 è“è“è›‹ç³•ç”Ÿäº§æ—¶é—´ï¼š2020-12-13T10:49:18.645407200 2.5. ç»„åˆæ¨¡å¼ï¼ˆCPï¼‰è‹±æ–‡ï¼šComposite Pattern å®šä¹‰ï¼šåˆå«éƒ¨åˆ†æ•´ä½“æ¨¡å¼ï¼Œæ˜¯ç”¨äºæŠŠä¸€ç»„ç›¸ä¼¼çš„å¯¹è±¡å½“ä½œä¸€ä¸ªå•ä¸€çš„å¯¹è±¡ã€‚ç»„åˆæ¨¡å¼ä¾æ®æ ‘å½¢ç»“æ„æ¥ç»„åˆå¯¹è±¡ï¼Œç”¨æ¥è¡¨ç¤ºéƒ¨åˆ†ä»¥åŠæ•´ä½“å±‚æ¬¡ã€‚ ä¼˜ç‚¹ï¼š å±‚æ¬¡æ¸…æ™° å®¢æˆ·ç«¯ä¸å¿…å…³ç³»å±‚æ¬¡å·®å¼‚ï¼Œæ–¹ä¾¿æ§åˆ¶ ç¬¦åˆOCP ç¼ºç‚¹ï¼šæ ‘å½¢å¤„ç†è¾ƒä¸ºå¤æ‚ æœ€ä½³å®è·µï¼š å®¢æˆ·ç«¯å¯ä»¥å¿½ç•¥ç»„åˆå¯¹è±¡ä¸å•ä¸ªå¯¹è±¡çš„å·®å¼‚ å¤„ç†æ ‘å½¢ç»“æ„æ•°æ® ä¸¾ä¾‹ï¼šèœå•æŒ‰é’®ç»„æˆçš„æ ‘å½¢ åˆ›å»ºèœå•æŒ‰é’®ç»„åˆæŠ½è±¡ç±» public abstract class MenuButton { public void add(MenuButton menuButton) { throw new UnsupportedOperationException("ä¸æ”¯æŒåˆ›å»ºæ“ä½œ"); } public String getName() { throw new UnsupportedOperationException("ä¸æ”¯æŒåç§°è·å–"); } public String getType() { throw new UnsupportedOperationException("ä¸æ”¯æŒç±»å‹è·å–"); } public String getIcon() { throw new UnsupportedOperationException("ä¸æ”¯æŒå›¾æ ‡"); } public void print() { throw new UnsupportedOperationException("ä¸æ”¯æŒæ‰“å°æ“ä½œ"); } } åˆ›å»ºæŒ‰é’®ç±» public class Button extends MenuButton{ private String name; public Button(String name) { this.name = name; } @Override public String getName() { return name; } @Override public String getType(){ return "æŒ‰é’®"; } @Override public void print() { System.out.println(getName() + "[" + getType() + "]"); } } åˆ›å»ºèœå•ç±» public class Menu extends MenuButton { private List&lt;MenuButton> items = new ArrayList&lt;>(); private String name; private String icon; private Integer level; public Menu(String name, String icon, Integer level) { this.name = name; this.icon = icon; this.level = level; } @Override public void add(MenuButton menuButton){ items.add(menuButton); } @Override public String getName() { return this.name; } @Override public String getType() { return "èœå•"; } @Override public String getIcon() { return this.icon; } @Override public void print() { System.out.println(getIcon() + getName() + "[" + getType() + "]"); for (MenuButton item : items) { if (this.level != null) { for (int i = 0; i &lt; this.level; i++) { System.out.print(" "); } } item.print(); } } } æµ‹è¯• public class CpTest { public static void main(String[] args) { Menu userMenu = new Menu("ç”¨æˆ·ç®¡ç†", "ğŸ§‘", 2); Button createUser = new Button("æ–°å¢ç”¨æˆ·"); Button updateUser = new Button("ä¿®æ”¹ç”¨æˆ·"); Button deleteUser = new Button("åˆ é™¤ç”¨æˆ·"); userMenu.add(createUser); userMenu.add(updateUser); userMenu.add(deleteUser); Menu logMenu = new Menu("æ“ä½œæ—¥å¿—", "ğŸ“ƒ", 2); Button export = new Button("å¯¼å‡ºExcel"); logMenu.add(export); Menu systemMenu = new Menu("ç³»ç»Ÿç®¡ç†", "ğŸ”¨", 1); systemMenu.add(userMenu); systemMenu.add(logMenu); systemMenu.print(); } } è¾“å‡º ğŸ”¨ç³»ç»Ÿç®¡ç†[èœå•] ğŸ§‘ç”¨æˆ·ç®¡ç†[èœå•] æ–°å¢ç”¨æˆ·[æŒ‰é’®] ä¿®æ”¹ç”¨æˆ·[æŒ‰é’®] åˆ é™¤ç”¨æˆ·[æŒ‰é’®] ğŸ“ƒæ“ä½œæ—¥å¿—[èœå•] å¯¼å‡ºExcel[æŒ‰é’®] 2.6. æ¡¥æ¥æ¨¡å¼ï¼ˆBPï¼‰è‹±æ–‡ï¼šBridge Pattern å®šä¹‰ï¼šå°†æŠ½è±¡éƒ¨åˆ†å’Œå…·ä½“å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚é€šè¿‡ç»„åˆçš„æ–¹å¼å»ºç«‹ä¸¤ä¸ªç±»ä¹‹é—´çš„å…³ç³»ï¼Œè€Œä¸æ˜¯é€šè¿‡ç»§æ‰¿ã€‚ ä¼˜ç‚¹ï¼š åˆ†ç¦»æŠ½è±¡éƒ¨åˆ†å’Œå…·ä½“å®ç°éƒ¨åˆ† æé«˜äº†ç³»ç»Ÿå¯æ‹“å±•æ€§ ç¬¦åˆOCPå’Œåˆæˆå¤ç”¨åŸåˆ™ ç¼ºç‚¹ï¼šå¢åŠ äº†ç³»ç»Ÿçš„ç†è§£å’Œè®¾è®¡éš¾åº¦ æœ€ä½³å®è·µï¼š æŠ½è±¡å’Œå®ä½“å®ç°ä¹‹é—´å¢åŠ æ›´å¤šçš„çµæ´»æ€§ ä¸€ä¸ªç±»å­˜åœ¨å¤šä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œå¹¶ä¸”éœ€è¦ç‹¬ç«‹æ‹“å±• ä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿ ä¸¾ä¾‹ï¼š 1.åˆ›å»ºè›‹ç³•çš„æ¥å£ç±» public interface Cake { Cake makeCake(); void getCake(); } 2.åˆ›å»ºè›‹ç³•æ¥å£çš„å®ç°ç±» æ°´æœè›‹ç³• public class FruitCake implements Cake { @Override public Cake makeCake() { System.out.println("åˆ¶ä½œæ°´æœè›‹ç³•"); return new FruitCake(); } @Override public void getCake() { System.out.println("è·å¾—æ°´æœè›‹ç³•"); } } å¥¶æ²¹è›‹ç³• public class CreamCake implements Cake { @Override public Cake makeCake() { System.out.println("åˆ¶ä½œå¥¶æ²¹è›‹ç³•"); return new CreamCake(); } @Override public void getCake() { System.out.println("è·å¾—å¥¶æ²¹è›‹ç³•"); } } 3.åˆ›å»ºåº—é“ºæŠ½è±¡ç±»,é€šè¿‡å±æ€§çš„æ–¹å¼å’Œè›‹ç³•æ¥å£ç›¸å…³è”ï¼Œç›®çš„æ˜¯å¯ä»¥åœ¨ä¸åŒçš„åº—é“ºå®ç°ç±»ä¸­çµæ´»åœ°åˆ¶ä½œå„ç§è›‹ç³• åº—é“ºæŠ½è±¡ç±» public abstract class Store { protected Cake cake; public Store(Cake cake){ this.cake = cake; } abstract Cake makeCake(); } åº—é“ºå®ç°ç±» public class ZhangSanStore extends Store{ public ZhangSanStore(Cake cake) { super(cake); } @Override Cake makeCake() { System.out.println("å¼ ä¸‰çš„è›‹ç³•åº—"); return cake.makeCake(); } } public class LiSiStore extends Store { public LiSiStore(Cake cake) { super(cake); } @Override Cake makeCake() { System.out.println("æå››çš„è›‹ç³•åº—"); return cake.makeCake(); } } 4.æµ‹è¯• public class BpTest { public static void main(String[] args) { ZhangSanStore zhangSanStore = new ZhangSanStore(new FruitCake()); Cake cake = zhangSanStore.makeCake(); cake.getCake(); System.out.println("++++++++++++++++åä¸½çš„åˆ†å‰²çº¿+++++++++++++++++"); LiSiStore liSiStore = new LiSiStore(new CreamCake()); Cake cake1 = liSiStore.makeCake(); cake1.getCake(); } } 5.è¾“å‡º å¼ ä¸‰çš„è›‹ç³•åº— åˆ¶ä½œæ°´æœè›‹ç³• è·å¾—æ°´æœè›‹ç³• ++++++++++++++++åä¸½çš„åˆ†å‰²çº¿+++++++++++++++++ æå››çš„è›‹ç³•åº— åˆ¶ä½œå¥¶æ²¹è›‹ç³• è·å¾—å¥¶æ²¹è›‹ç³• 2.7. ä»£ç†æ¨¡å¼ï¼ˆPPï¼‰è‹±æ–‡ï¼šProxy Pattern å®šä¹‰ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ï¼Œä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ï¼Œä»£ç†å¯¹è±¡åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°äº†ä¸­ä»‹çš„ä½œç”¨ ä¼˜ç‚¹ï¼š å°†ä»£ç†å¯¹è±¡å’ŒçœŸå®è¢«è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡åˆ†ç¦» é™ä½è€¦åˆï¼Œæ‹“å±•æ€§å¥½ ä¿æŠ¤ç›®æ ‡å¯¹è±¡ï¼Œå¢å¼ºç›®æ ‡å¯¹è±¡ ç¼ºç‚¹ï¼š é€ æˆç±»çš„æ•°ç›®å¢åŠ ï¼Œå¢åŠ å¤æ‚åº¦ å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡å¢åŠ ä»£ç†å¯¹è±¡ï¼Œä¼šé€ æˆå¤„ç†é€Ÿåº¦å˜æ…¢ æœ€ä½³å®è·µï¼š ä¿æŠ¤ç›®æ ‡å¯¹è±¡ å¢å¼ºç›®æ ‡å¯¹è±¡ ä»£ç†åˆ†ç±» åŠŸèƒ½ ç¼ºç‚¹ é™æ€ä»£ç† é€šè¿‡åœ¨ä»£ç ä¸­æ˜¾å¼åœ°å®šä¹‰äº†ä¸€ä¸ªä»£ç†ç±»ï¼Œåœ¨ä»£ç†ç±»ä¸­é€šè¿‡åŒåçš„æ–¹æ³•å¯¹ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•è¿›è¡ŒåŒ…è£…ï¼Œå®¢æˆ·ç«¯é€šè¿‡è°ƒç”¨ä»£ç†ç±»çš„æ–¹æ³•æ¥è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ã€‚ æ¯éœ€è¦ä»£ç†ä¸€ä¸ªç±»ï¼Œå°±éœ€è¦æ‰‹å†™å¯¹åº”çš„ä»£ç†ç±» åŠ¨æ€ä»£ç† JDKçš„åŠ¨æ€ä»£ç†åªèƒ½ä»£ç†æ¥å£ï¼Œé€šè¿‡æ¥å£çš„æ–¹æ³•ååœ¨åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»ä¸­è°ƒç”¨ä¸šåŠ¡å®ç°ç±»çš„åŒåæ–¹æ³•ã€‚ CGLibä»£ç† é€šè¿‡ç»§æ‰¿æ¥å®ç°ï¼Œç”Ÿæˆçš„ä»£ç†ç±»å°±æ˜¯ç›®æ ‡å¯¹è±¡ç±»çš„å­ç±»ï¼Œé€šè¿‡é‡å†™ä¸šåŠ¡æ–¹æ³•æ¥å®ç°ä»£ç† Springå¯¹ä»£ç†æ¨¡å¼çš„æ‹“å±• 1. å½“Beanæœ‰å®ç°æ¥å£æ—¶ï¼Œä½¿ç”¨JDKåŠ¨æ€ä»£ç†ï¼› 2. å½“Beanæ²¡æœ‰å®ç°æ¥å£æ—¶ï¼Œä½¿ç”¨CGLibä»£ç†ã€‚ ä¸¾ä¾‹ï¼š 1.é™æ€ä»£ç† ï¼ˆ1ï¼‰åˆ›å»ºç³–æœç±»æ¥å£ public interface ICandyService { void makeCandy(); } ï¼ˆ2ï¼‰åˆ›å»ºç³–æœç±»å®ç°ç±» public class CandyServiceServiceImpl implements ICandyService { @Override public void makeCandy() { System.out.println("åˆ¶ä½œç³–æœ"); } } ï¼ˆ3ï¼‰åˆ›å»ºä»£ç†å¯¹è±¡ public class ProxyService { private ICandyService iCandyService; public void makeCandy(){ beforeMethod(); iCandyService = new CandyServiceServiceImpl(); iCandyService.makeCandy(); afterMethod(); } private void afterMethod() { System.out.println("åŒ…è£…"); } private void beforeMethod() { System.out.println("å‡†å¤‡ææ–™"); } } ï¼ˆ4ï¼‰æµ‹è¯• public class PpTest { public static void main(String[] args) { System.out.println("[ä»£ç†æ¨¡å¼-é™æ€ä»£ç†]"); ProxyService proxyService = new ProxyService(); proxyService.makeCandy(); } } ï¼ˆ5ï¼‰è¾“å‡º [ä»£ç†æ¨¡å¼-é™æ€ä»£ç†] å‡†å¤‡ææ–™ åˆ¶ä½œç³–æœ åŒ…è£… 2.åŠ¨æ€ä»£ç† ï¼ˆ1ï¼‰åˆ›å»ºé¥¼å¹²ç±»æ¥å£ public interface IBiscuitService { void makeBiscuit(String ingredients); } ï¼ˆ2ï¼‰åˆ›å»ºé¥¼å¹²ç±»å®ç°ç±» public class BiscuitServiceImpl implements IBiscuitService { @Override public void makeBiscuit(String ingredients) { System.out.println("åˆ¶ä½œ"+ingredients+"é¥¼å¹²"); } } ï¼ˆ3ï¼‰åˆ›å»ºåŠ¨æ€ä»£ç† public class DynamicProxy implements InvocationHandler { // ä»£ç†çš„ç›®æ ‡å¯¹è±¡ private Object object; public DynamicProxy(Object object) { this.object = object; } public Object proxy(){ Class&lt;?> clazz = object.getClass(); return Proxy.newProxyInstance(clazz.getClassLoader(), clazz.getInterfaces(), this); } /** * @param proxy åŠ¨æ€ç”Ÿæˆçš„ä»£ç†å¯¹è±¡ * @param method ä»£ç†æ–¹æ³• * @param args ä»£ç†æ–¹æ³•çš„æ–¹æ³•å‚æ•° * @return ç»“æœ * @throws Throwable å¼‚å¸¸ */ @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { beforeMethod(object); // åå°„æ‰§è¡Œä»£ç†å¯¹è±¡çš„ç›®æ ‡æ–¹æ³• Object result = method.invoke(object, args); afterMethod(object); return result; } private void beforeMethod(Object object) { if (object instanceof IBiscuitService) { System.out.println("å‡†å¤‡é¥¼å¹²é…æ–™"); } else if (object instanceof ICandyService) { System.out.println("å‡†å¤‡ç³–æœé…æ–™"); } else { throw new RuntimeException("æš‚ä¸æ”¯æŒä»£ç†" + object.getClass() + "ç±»å‹"); } } private void afterMethod(Object object) { if (object instanceof IBiscuitService) { System.out.println("åŒ…è£…é¥¼å¹²"); } else if (object instanceof ICandyService) { System.out.println("åŒ…è£…ç³–æœ"); } else { throw new RuntimeException("æš‚ä¸æ”¯æŒä»£ç†" + object.getClass() + "ç±»å‹"); } } } ï¼ˆ4ï¼‰æµ‹è¯• public class Pp2Test { public static void main(String[] args) { System.out.println("[ä»£ç†æ¨¡å¼-åŠ¨æ€ä»£ç†]"); ICandyService candyService = (ICandyService) new DynamicProxy(new CandyServiceServiceImpl()).proxy(); candyService.makeCandy(); System.out.println("++++++++++++++++åä¸½çš„åˆ†å‰²çº¿+++++++++++++++++"); IBiscuitService biscuitService = (IBiscuitService) new DynamicProxy(new BiscuitServiceImpl()).proxy(); biscuitService.makeBiscuit("è‰è“"); System.out.println("++++++++++++++++åä¸½çš„åˆ†å‰²çº¿+++++++++++++++++"); biscuitService.makeBiscuit("å¥¶æ²¹"); } } ï¼ˆ5ï¼‰è¾“å‡º [ä»£ç†æ¨¡å¼-åŠ¨æ€ä»£ç†] å‡†å¤‡ç³–æœé…æ–™ åˆ¶ä½œç³–æœ åŒ…è£…ç³–æœ ++++++++++++++++åä¸½çš„åˆ†å‰²çº¿+++++++++++++++++ å‡†å¤‡é¥¼å¹²é…æ–™ åˆ¶ä½œè‰è“é¥¼å¹² åŒ…è£…é¥¼å¹² ++++++++++++++++åä¸½çš„åˆ†å‰²çº¿+++++++++++++++++ å‡†å¤‡é¥¼å¹²é…æ–™ åˆ¶ä½œå¥¶æ²¹é¥¼å¹² åŒ…è£…é¥¼å¹² 3.CGLibä»£ç† â€‹ é€šè¿‡ç»§æ‰¿æ¥å®ç°ï¼Œç”Ÿæˆçš„ä»£ç†ç±»å°±æ˜¯ç›®æ ‡å¯¹è±¡ç±»çš„å­ç±»ï¼Œé€šè¿‡é‡å†™ä¸šåŠ¡æ–¹æ³•æ¥å®ç°ä»£ç†ã€‚ 4.Springå¯¹ä»£ç†æ¨¡å¼çš„æ‰©å±• â€‹ å¯ä»¥é€šè¿‡ä»¥ä¸‹é…ç½®å¼ºåˆ¶ä½¿ç”¨CGLibä»£ç†; spring: aop: proxy-target-class: true 3.è¡Œä¸ºå‹æ¨¡å¼ï¼ˆ11ï¼‰3.1. æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTPï¼‰è‹±æ–‡ï¼šTemplate Pattern å®šä¹‰ï¼šæ¨¡æ¿æ–¹æ³•æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªæµç¨‹çš„éª¨æ¶ï¼Œç”±å¤šä¸ªæ–¹æ³•ç»„æˆã€‚å¹¶å…è®¸å­ç±»ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªæ­¥éª¤æä¾›å®ç°ã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯å…¬å…±çš„ä¸å˜çš„éƒ¨åˆ†ç”±çˆ¶ç±»ç»Ÿä¸€å®ç°ï¼Œå˜åŒ–çš„éƒ¨åˆ†ç”±å­ç±»æ¥ä¸ªæ€§åŒ–å®ç°ã€‚ ä¼˜ç‚¹ï¼š æé«˜å¤ç”¨æ€§ æé«˜æ‹“å±•æ€§ OCP ç¼ºç‚¹ï¼š ç±»çš„æ•°ç›®å¢åŠ  å¢åŠ äº†ç³»ç»Ÿå®ç°çš„å¤æ‚åº¦ çˆ¶ç±»æ·»åŠ æ–°çš„æŠ½è±¡æ–¹æ³•ï¼Œæ‰€æœ‰å­ç±»éƒ½è¦æ”¹ä¸€é æœ€ä½³å®è·µï¼š ä¸¾ä¾‹ï¼šå¤–å–1.åˆ›å»ºå›ºå®šæµç¨‹æŠ½è±¡ç±» public abstract class Takeaway { final void order() { System.out.println("(æµç¨‹å›ºå®š)ä¸‹å•"); } final void packageSend() { System.out.println("(æµç¨‹å›ºå®š)æ‰“åŒ…æ´¾é€"); } protected abstract void make(); protected boolean needTableware() { return true; } final void flow() { this.order(); this.make(); if (needTableware()) { System.out.println("èµ é€ä¸€æ¬¡æ€§é¤å…·"); } this.packageSend(); } } 2.åˆ›å»ºå­ç±»å®ç°ç±» public class CakeTakeaway extends Takeaway{ @Override protected void make() { System.out.println("åˆ¶ä½œè›‹ç³•"); } @Override protected boolean needTableware(){ return super.needTableware(); } } public class BiscuitTakeaway extends Takeaway{ @Override protected void make() { System.out.println("åˆ¶ä½œé¥¼å¹²"); } @Override protected boolean needTableware() { return false; } } 3.æµ‹è¯• public class TpTest { public static void main(String[] args) { CakeTakeaway cakeTakeaway = new CakeTakeaway(); cakeTakeaway.flow(); System.out.println("++++++++++++++åä¸½çš„åˆ†å‰²çº¿+++++++++++++++"); BiscuitTakeaway biscuitTakeaway = new BiscuitTakeaway(); biscuitTakeaway.flow(); } } 4.å®ç° (æµç¨‹å›ºå®š)ä¸‹å• åˆ¶ä½œè›‹ç³• èµ é€ä¸€æ¬¡æ€§é¤å…· (æµç¨‹å›ºå®š)æ‰“åŒ…æ´¾é€ ++++++++++++++åä¸½çš„åˆ†å‰²çº¿+++++++++++++++ (æµç¨‹å›ºå®š)ä¸‹å• åˆ¶ä½œé¥¼å¹² (æµç¨‹å›ºå®š)æ‰“åŒ…æ´¾é€ 3.2. è¿­ä»£å™¨æ¨¡å¼ï¼ˆIPï¼‰è‹±æ–‡ï¼šIterator Pattern å®šä¹‰ï¼šè¿­ä»£å™¨æ¨¡å¼ï¼Œåˆç§°æ¸¸æ ‡æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼æä¾›ä¸€ç§æ–¹æ³•è®¿é—®ä¸€ä¸ªå®¹å™¨å¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚ã€‚ ä¼˜ç‚¹ï¼š 1.å®ƒæ”¯æŒä»¥ä¸åŒçš„æ–¹å¼éå†ä¸€ä¸ªèšåˆå¯¹è±¡ï¼Œåœ¨åŒä¸€ä¸ªèšåˆå¯¹è±¡ä¸Šå¯ä»¥å®šä¹‰å¤šç§éå†æ–¹å¼ã€‚æ›¿æ¢è¿­ä»£å™¨å°±å¯ä»¥åˆ‡æ¢éå†æ–¹æ³•ã€‚ 2.è¿­ä»£å™¨ç®€åŒ–äº†èšåˆç±»ã€‚èšåˆå¯¹è±¡å¯ä»¥ä¸ç”¨è‡ªå·±å†æä¾›éå†æ–¹æ³•ã€‚ 3.åœ¨è¿­ä»£å™¨æ¨¡å¼ä¸­ç”±äºå¼•å…¥äº†æŠ½è±¡å±‚ï¼Œå¢åŠ æ–°çš„èšåˆç±»å’Œè¿­ä»£å™¨ç±»éƒ½å¾ˆæ–¹ä¾¿ï¼Œæ— é¡»ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œæ»¡è¶³â€œå¼€é—­åŸåˆ™â€çš„è¦æ±‚ã€‚ ç¼ºç‚¹ï¼š 1.ç”±äºè¿­ä»£å™¨æ¨¡å¼å°†å­˜å‚¨æ•°æ®å’Œéå†æ•°æ®çš„èŒè´£åˆ†ç¦»ï¼Œå¢åŠ æ–°çš„èšåˆç±»éœ€è¦å¯¹åº”å¢åŠ æ–°çš„è¿­ä»£å™¨æ¥ï¼Œç±»çš„ä¸ªæ•°æˆå¯¹å¢åŠ ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚ 2.æŠ½è±¡è¿­ä»£å™¨è®¾è®¡éš¾åº¦ç›¸å¯¹è¾ƒå¤§ï¼Œéœ€è¦å……åˆ†è€ƒè™‘åˆ°ç³»ç»Ÿå°†æ¥çš„æ‰©å±•ï¼Œï¼Œä¾‹å¦‚JDKå†…ç½®è¿­ä»£å™¨Iteratorå°±æ— æ³•å®ç°é€†å‘éå†ï¼Œå¦‚æœéœ€è¦å®ç°é€†å‘éå†ï¼Œåªèƒ½é€šè¿‡å…¶å­ç±»ListIteratorç­‰æ¥å®ç°ï¼Œè€ŒListIteratorè¿­ä»£å™¨æ— æ³•ç”¨äºæ“ä½œSetç±»å‹çš„èšåˆå¯¹è±¡ã€‚ æœ€ä½³å®è·µï¼š 1.è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å†…å®¹è€Œæ— é¡»æš´éœ²å®ƒçš„å†…éƒ¨è¡¨ç¤ºã€‚å°†èšåˆå¯¹è±¡çš„è®¿é—®ä¸å†…éƒ¨æ•°æ®çš„å­˜å‚¨åˆ†ç¦»ï¼Œä½¿å¾—è®¿é—®èšåˆå¯¹è±¡æ—¶æ— é¡»äº†è§£å…¶å†…éƒ¨å®ç°ç»†èŠ‚ã€‚ 2.éœ€è¦ä¸ºä¸€ä¸ªèšåˆå¯¹è±¡æä¾›å¤šç§éå†æ–¹å¼ã€‚ 3.ä¸ºéå†ä¸åŒèšåˆç»“æ„æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œè¯¥æ¥å£çš„å®ç°ç±»ä¸­ä¸ºä¸åŒçš„èšåˆç»“æ„æä¾›ä¸åŒçš„éå†æ–¹å¼ï¼Œè€Œå®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´æ€§çš„æ“ä½œè¯¥æ¥å£ã€‚ ä¸¾ä¾‹ï¼š 1.åˆ›å»ºæŠ½è±¡å®¹å™¨ public interface Aggregate { void add(Object obj); void remove(Object obj); Iterator iterator(); } 2.åˆ›å»ºå®¹å™¨å®ç°ç±» public class ConcreteAggregate implements Aggregate{ private List list = new ArrayList(); @Override public void add(Object obj) { list.add(obj); } @Override public void remove(Object obj) { list.remove(obj); } @Override public Iterator iterator() { return new ConcreteIterator(list); } } 3.åˆ›å»ºæŠ½è±¡è¿­ä»£å™¨ public interface Iterator { Object next(); boolean hasNext(); } 4.åˆ›å»ºå…·ä½“è¿­ä»£å™¨å®ç°ç±» public class ConcreteIterator implements Iterator { private List list = new ArrayList(); private int cursor = 0; public ConcreteIterator(List list) { this.list = list; } @Override public Object next() { Object obj = null; if (this.hasNext()) { obj = this.list.get(cursor++); } return obj; } @Override public boolean hasNext() { if (cursor == list.size()) { return false; } return true; } } 5.æµ‹è¯• public class IpTest { public static void main(String[] args) { Aggregate ag = new ConcreteAggregate(); ag.add("a"); ag.add("b"); ag.add("c"); Iterator it = ag.iterator(); while(it.hasNext()){ String str = (String)it.next(); System.out.println(str); } } } 6.è¾“å‡º a b c 3.3. ç­–ç•¥æ¨¡å¼ï¼ˆSPï¼‰è‹±æ–‡ï¼šStrategy Pattern å®šä¹‰ï¼šç­–ç•¥æ¨¡å¼å®šä¹‰äº†ç®—æ³•å®¶æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©å®ƒä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ã€‚æ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ä¸ä¼šå½±å“åˆ°ä½¿ç”¨ç®—æ³•çš„ç”¨æˆ·ã€‚ç­–ç•¥æ¨¡å¼å¸¸ç”¨äºæ¶ˆé™¤å¤§é‡çš„if elseä»£ç ã€‚ ä¼˜ç‚¹ï¼š ç¼ºç‚¹ï¼š æœ€ä½³å®è·µï¼š ç³»ç»Ÿæœ‰å¾ˆå¤šç±»ï¼Œå®ƒä»¬çš„åŒºåˆ«ä»…ä»…åœ¨äºè¡Œä¸ºä¸åŒ ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ ä¸¾ä¾‹ï¼šä¿ƒé”€æ´»åŠ¨ 1.åˆ›å»ºæ´»åŠ¨æ¥å£ public interface Activity { void discount(); } 2.åˆ›å»ºå¤šæ¥å£å®ç°ç±» public class StrategyOne implements Activity{ @Override public void discount() { System.out.println("æ»¡å‡è¿”ç°"); } } public class StrategyTwo implements Activity { @Override public void discount() { System.out.println("æ»¡å‡æ‰“æŠ˜"); } } 3.æµ‹è¯• public class SpTest { public static void main(String[] args) { String plan = "A"; if("A".equalsIgnoreCase(plan)){ StrategyOne strategyOne = new StrategyOne(); strategyOne.discount(); }else if("B".equalsIgnoreCase(plan)){ StrategyTwo strategyTwo = new StrategyTwo(); strategyTwo.discount(); }else{ throw new RuntimeException("æš‚ä¸æ”¯æŒæ´»åŠ¨ç­–ç•¥"); } } } 4.è¾“å‡º æ»¡å‡è¿”ç° 3.4. è§£é‡Šå™¨æ¨¡å¼ï¼ˆIPï¼‰â€“ TODOè‹±æ–‡ï¼šInterpreter Pattern å®šä¹‰ï¼š ä¼˜ç‚¹ï¼š ç¼ºç‚¹ï¼š æœ€ä½³å®è·µï¼š ä¸¾ä¾‹ï¼šæœ€éš¾æ¨¡å¼ï¼Œä¸å¸¸ç”¨ï¼Œåè¡¥å…… 3.5. è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆOPï¼‰è‹±æ–‡ï¼šObserver Pattern å®šä¹‰ï¼šè§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šä¾èµ–ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…åŒæ—¶ç›‘å¬æŸä¸ªä¸»é¢˜å¯¹è±¡ï¼Œå½“ä¸»ä½“å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒçš„æ‰€æœ‰è§‚å¯Ÿè€…éƒ½ä¼šæ”¶åˆ°å“åº”çš„é€šçŸ¥ã€‚ ä¼˜ç‚¹ï¼š è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä¹‹é—´å»ºç«‹ä¸€ä¸ªæŠ½è±¡çš„è€¦åˆï¼› è§‚å¯Ÿè€…æ¨¡å¼æ”¯æŒå¹¿æ’­é€šä¿¡ã€‚ ç¼ºç‚¹ï¼š è§‚å¯Ÿè€…ä¹‹é—´æœ‰è¿‡å¤šçš„ç»†èŠ‚ä¾èµ–ï¼Œæé«˜æ—¶é—´æ¶ˆè€—åŠç¨‹åºå¤æ‚åº¦ åº”é¿å…å¾ªç¯è°ƒç”¨ æœ€ä½³å®è·µï¼š ä¸¾ä¾‹ï¼šå…¬ä¼—å·æ¨é€æ–‡ç«  1.åˆ›å»ºè¢«è§‚å¯Ÿè€…(å…¬ä¼—å·) public class OfficialAccount extends Observable { private String accountName; public OfficialAccount(String accountName) { this.accountName = accountName; } public String getAccountName() { return accountName; } public void push(Article article) { System.out.println("ã€"+this.accountName+"ã€‘" +"å‘èµ·æ¨é€>>>"+article.getAuthor()+"çš„ã€Š"+article.getName()+"ã€‹"); // è®¾ç½®æ ‡è¯†ä½ changed = trueï¼Œè¡¨ç¤ºè¢«è§‚å¯Ÿè€…å‘ç”Ÿäº†æ”¹å˜ setChanged(); // é€šçŸ¥è§‚å¯Ÿè€…ï¼Œå¯ä»¥ç»™è§‚å¯Ÿè€…ä¼ é€’æ•°æ® notifyObservers(article); } } 2.åˆ›å»ºè§‚å¯Ÿè€…ï¼ˆè®¢é˜…è€…ï¼‰ public class Followers implements Observer { private String name; public Followers(String name) { this.name = name; } @Override public void update(Observable o, Object arg) { OfficialAccount officialAccount = (OfficialAccount) o; Article article = (Article) arg; System.out.println(name+":::æ”¶åˆ°ã€"+officialAccount.getAccountName()+"ã€‘çš„æ¨é€:"+article.getAuthor()+"çš„ã€Š"+article.getName()+"ã€‹"); } } 3.åˆ›å»ºæ¨é€å¯¹è±¡ï¼ˆæ–‡ç« ï¼‰ public class Article { private String name; private String author; public Article(String name, String author) { this.name = name; this.author = author; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String getAuthor() { return author; } public void setAuthor(String author) { this.author = author; } } 4.æµ‹è¯• public class OpTest { public static void main(String[] args) { OfficialAccount officialAccount = new OfficialAccount("JAVAå¤§æœ¬è¥"); //æ·»åŠ è®¢é˜…è€… Followers follower1 = new Followers("è·¯äººç”²"); officialAccount.addObserver(follower1); Followers follower2 = new Followers("è·¯äººä¹™"); officialAccount.addObserver(follower2); //æ¨é€ Article article = new Article("å¤§è¯è®¾è®¡æ¨¡å¼","èœé¸Ÿ"); officialAccount.push(article); } } 5.è¾“å‡º ã€JAVAå¤§æœ¬è¥ã€‘å‘èµ·æ¨é€>>>èœé¸Ÿçš„ã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹ è·¯äººä¹™:::æ”¶åˆ°ã€JAVAå¤§æœ¬è¥ã€‘çš„æ¨é€:èœé¸Ÿçš„ã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹ è·¯äººç”²:::æ”¶åˆ°ã€JAVAå¤§æœ¬è¥ã€‘çš„æ¨é€:èœé¸Ÿçš„ã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹ 3.6. å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMPï¼‰è‹±æ–‡ï¼šMemento Pattern å®šä¹‰ï¼šåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯ä»¥å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚ ä¼˜ç‚¹ï¼š 1.å®ƒæä¾›äº†ä¸€ç§çŠ¶æ€æ¢å¤çš„å®ç°æœºåˆ¶ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°å›åˆ°ä¸€ä¸ªç‰¹å®šçš„å†å²æ­¥éª¤ï¼Œå½“æ–°çš„çŠ¶æ€æ— æ•ˆæˆ–è€…å­˜åœ¨é—®é¢˜æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æš‚æ—¶å­˜å‚¨èµ·æ¥çš„å¤‡å¿˜å½•å°†çŠ¶æ€å¤åŸã€‚ 2.å¤‡å¿˜å½•å®ç°äº†å¯¹ä¿¡æ¯çš„å°è£…ï¼Œä¸€ä¸ªå¤‡å¿˜å½•å¯¹è±¡æ˜¯ä¸€ç§åŸå‘å™¨å¯¹è±¡çŠ¶æ€çš„è¡¨ç¤ºï¼Œä¸ä¼šè¢«å…¶ä»–ä»£ç æ‰€æ”¹åŠ¨ã€‚å¤‡å¿˜å½•ä¿å­˜äº†åŸå‘å™¨çš„çŠ¶æ€ï¼Œé‡‡ç”¨åˆ—è¡¨ã€å †æ ˆç­‰é›†åˆæ¥å­˜å‚¨å¤‡å¿˜å½•å¯¹è±¡å¯ä»¥å®ç°å¤šæ¬¡æ’¤é”€æ“ä½œã€‚ ç¼ºç‚¹ï¼šèµ„æºæ¶ˆè€—è¿‡å¤§ï¼Œå¦‚æœéœ€è¦ä¿å­˜çš„åŸå‘å™¨ç±»çš„æˆå‘˜å˜é‡å¤ªå¤šï¼Œå°±ä¸å¯é¿å…éœ€è¦å ç”¨å¤§é‡çš„å­˜å‚¨ç©ºé—´ï¼Œæ¯ä¿å­˜ä¸€æ¬¡å¯¹è±¡çš„çŠ¶æ€éƒ½éœ€è¦æ¶ˆè€—ä¸€å®šçš„ç³»ç»Ÿèµ„æºã€‚ æœ€ä½³å®è·µï¼š ä¿å­˜ä¸€ä¸ªå¯¹è±¡åœ¨æŸä¸€ä¸ªæ—¶åˆ»çš„å…¨éƒ¨çŠ¶æ€æˆ–éƒ¨åˆ†çŠ¶æ€ï¼Œè¿™æ ·ä»¥åéœ€è¦æ—¶å®ƒèƒ½å¤Ÿæ¢å¤åˆ°å…ˆå‰çš„çŠ¶æ€ï¼Œå®ç°æ’¤é”€æ“ä½œã€‚ é˜²æ­¢å¤–ç•Œå¯¹è±¡ç ´åä¸€ä¸ªå¯¹è±¡å†å²çŠ¶æ€çš„å°è£…æ€§ï¼Œé¿å…å°†å¯¹è±¡å†å²çŠ¶æ€çš„å®ç°ç»†èŠ‚æš´éœ²ç»™å¤–ç•Œå¯¹è±¡ã€‚ åç§° ä½œç”¨ åŸå‘å™¨ç±»ï¼ˆOriginatorï¼‰ åˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½•å¯¹è±¡ï¼Œä½¿ç”¨å¤‡å¿˜å½•å­˜å‚¨å®ƒçš„å†…éƒ¨çŠ¶æ€ è´Ÿè´£äººç±»ï¼ˆCareTakerï¼‰ è´Ÿè´£ä¿å­˜å¥½å¤‡å¿˜å½•å¯¹è±¡ï¼Œä¸èƒ½æ£€æŸ¥æˆ–æ“ä½œå¤‡å¿˜å½•çš„å†…å®¹ å¤‡å¿˜å½•ç±»ï¼ˆMementoï¼‰ å°†åŸå‘å™¨çš„å†…éƒ¨çŠ¶æ€å­˜å‚¨èµ·æ¥ï¼ŒåŸå‘å™¨æ ¹æ®éœ€è¦å†³å®šå¤‡å¿˜å½•å­˜å‚¨åŸå‘å™¨çš„å“ªäº›å†…éƒ¨çŠ¶æ€ ä¸¾ä¾‹ï¼šå†’é™©å²›é—¯å…³ 1.åˆ›å»ºæ¸¸æˆç±» public class AdventureIslandGame { /**å…³å¡*/ private Integer point; /**å»ºæ¡£*/ public GameMemento createMemento(Integer point){ return new GameMemento(point); } /**å¼€å§‹æ¸¸æˆ*/ public void play(){ point = 1; } /**æ¢å¤å¤‡ä»½*/ public void restore(GameMemento gameMemento){ this.point = gameMemento.getPoint(); } public Integer getPoint() { return point; } public void setPoint(Integer point) { this.point = point; } } 2.åˆ›å»ºå¤‡ä»½ public class GameMemento { /**å…³å¡*/ private Integer point; /** * å¤‡ä»½å…³å¡ */ public GameMemento(int point){ this.point = point; } public Integer getPoint() { return point; } public void setPoint(Integer point) { this.point = point; } } 3.åˆ›å»ºå¤‡ä»½ç®¡ç†ç±» public class Caretaker { private GameMemento gameMemento; /**æ¢å¤å¤‡ä»½*/ public GameMemento retrieveMemento(){ return this.gameMemento; } /**ä¿å­˜å¤‡ä»½*/ public void saveMemento(GameMemento gameMemento){ this.gameMemento = gameMemento; } } 4.æµ‹è¯• public class MpTest { public static void main(String[] args) { System.out.println("[å†’é™©å²›é—¯å…³æ¸¸æˆ]"); AdventureIslandGame game = new AdventureIslandGame(); System.out.println("æ¸¸æˆå¼€å§‹"); game.play(); System.out.println("è¿›å…¥ç¬¬"+game.getPoint()+"å…³"); System.out.println("å‡»æ€ç¬¬"+game.getPoint()+"å…³boss,è¿›å…¥ä¸‹ä¸€å…³"); System.out.println("åˆ›å»ºæ–°æ¡£..."); GameMemento gameMemento = game.createMemento(game.getPoint()); Caretaker caretaker = new Caretaker(); caretaker.saveMemento(gameMemento); System.out.println("~~~~~~ç¬¬"+game.getPoint()+"å…³,å­˜æ¡£å®Œæˆ~~~~~~"); game.setPoint(game.getPoint()+1); System.out.println("è¿›å…¥ç¬¬"+game.getPoint()+"å…³"); System.out.println("å‡»æ€ç¬¬"+game.getPoint()+"å…³boss,è¿›å…¥ä¸‹ä¸€å…³"); gameMemento.setPoint(game.getPoint()); caretaker.saveMemento(gameMemento); System.out.println("~~~~~~ç¬¬"+game.getPoint()+"å…³,å­˜æ¡£å®Œæˆ~~~~~~"); game.setPoint(game.getPoint()+1); System.out.println("è¿›å…¥ç¬¬"+game.getPoint()+"å…³"); System.out.println("è¢«ç¬¬"+game.getPoint()+"å…³bossæ€æ­»,æ¸¸æˆç»“æŸ"); System.out.println("å›é€€å…³å¡..."); game.restore(caretaker.retrieveMemento()); System.out.println("~~~~~~å›é€€å®Œæˆ,å½“å‰å…³å¡ç¬¬"+game.getPoint()+"å…³~~~~~~"); game.setPoint(game.getPoint()+1); System.out.println("è·å–å½“å‰å…³å¡ï¼šè¿›å…¥ç¬¬"+game.getPoint()+"å…³"); } } 5.è¾“å‡º [å†’é™©å²›é—¯å…³æ¸¸æˆ] æ¸¸æˆå¼€å§‹ è¿›å…¥ç¬¬1å…³ å‡»æ€ç¬¬1å…³boss,è¿›å…¥ä¸‹ä¸€å…³ åˆ›å»ºæ–°æ¡£... è¿›å…¥ç¬¬2å…³ å‡»æ€ç¬¬2å…³boss,è¿›å…¥ä¸‹ä¸€å…³ â€‹~~~~~~ç¬¬2å…³,å­˜æ¡£å®Œæˆ~~~~~~ è¿›å…¥ç¬¬3å…³ è¢«ç¬¬3å…³bossæ€æ­»,æ¸¸æˆç»“æŸ å›é€€å…³å¡... â€‹~~~~~~å›é€€å®Œæˆ,å½“å‰å…³å¡ç¬¬2å…³~~~~~~ è·å–å½“å‰å…³å¡ï¼šè¿›å…¥ç¬¬3å…³ 3.7. å‘½ä»¤æ¨¡å¼ï¼ˆCPï¼‰è‹±æ–‡ï¼šCommand Pattern å®šä¹‰ï¼š å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿æˆ‘ä»¬å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹ç”¨æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚ åç§° ä½œç”¨ æŠ½è±¡å‘½ä»¤è€…ï¼ˆCommandï¼‰ å®šä¹‰å‘½ä»¤çš„æ¥å£ï¼Œå£°æ˜æ‰§è¡Œçš„æ–¹æ³•ã€‚ å…·ä½“å‘½ä»¤ç±»ï¼ˆConcreteCommandï¼‰ å‘½ä»¤æ¥å£å®ç°å¯¹è±¡ï¼Œæ˜¯â€œè™šâ€çš„å®ç°ï¼›é€šå¸¸ä¼šæŒæœ‰æ¥æ”¶è€…ï¼Œå¹¶è°ƒç”¨æ¥æ”¶è€…çš„åŠŸèƒ½æ¥å®Œæˆå‘½ä»¤è¦æ‰§è¡Œçš„æ“ä½œã€‚ æ¥æ”¶è€…ï¼ˆReceiverï¼‰ çœŸæ­£æ‰§è¡Œå‘½ä»¤çš„å¯¹è±¡ã€‚ä»»ä½•ç±»éƒ½å¯èƒ½æˆä¸ºä¸€ä¸ªæ¥æ”¶è€…ï¼Œåªè¦å®ƒèƒ½å¤Ÿæ ¹æ®å‘½ä»¤è¦æ±‚å®ç°çš„ç›¸åº”åŠŸèƒ½ã€‚ è°ƒç”¨è€…ï¼ˆInvokerï¼‰ è¦æ±‚å‘½ä»¤è¦æ±‚å‘½ä»¤å¯¹è±¡æ‰§è¡Œè¯·æ±‚ï¼Œé€šå¸¸ä¼šæŒæœ‰å‘½ä»¤å¯¹è±¡ï¼Œå¯ä»¥æŒæœ‰å¾ˆå¤šçš„å‘½ä»¤å¯¹è±¡ã€‚è¿™æ˜¯ç”¨æˆ·ç«¯çœŸæ­£å‡ºå‘å‘½ä»¤å¹¶è¦æ±‚å‘½ä»¤æ‰§è¡Œç›¸åº”æ“ä½œçš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›¸å½“äºä½¿ç”¨å‘½ä»¤å¯¹è±¡çš„å…¥å£ã€‚ å…·ä½“å‘½ä»¤å¯¹è±¡ï¼ˆclientï¼‰ åˆ›å»ºå…·ä½“çš„å‘½ä»¤å¯¹è±¡ï¼Œå¹¶ä¸”è®¾ç½®å‘½ä»¤å¯¹è±¡çš„æ¥æ”¶è€…ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºè£…é…è€…ã€‚ ä¼˜ç‚¹ï¼š é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ã€‚ç”±äºè¯·æ±‚è€…ä¸æ¥æ”¶è€…ä¹‹é—´ä¸å­˜åœ¨ç›´æ¥å¼•ç”¨ï¼Œå› æ­¤è¯·æ±‚è€…ä¸æ¥æ”¶è€…ä¹‹é—´å®ç°å®Œå…¨è§£è€¦ï¼Œç›¸åŒçš„è¯·æ±‚è€…å¯ä»¥å¯¹åº”ä¸åŒçš„æ¥æ”¶è€…ï¼ŒåŒæ ·ï¼Œç›¸åŒçš„æ¥æ”¶è€…ä¹Ÿå¯ä»¥ä¾›ä¸åŒçš„è¯·æ±‚è€…ä½¿ç”¨ï¼Œä¸¤è€…ä¹‹é—´å…·æœ‰è‰¯å¥½çš„ç‹¬ç«‹æ€§ã€‚ æ–°çš„å‘½ä»¤å¯ä»¥å¾ˆå®¹æ˜“åœ°åŠ å…¥åˆ°ç³»ç»Ÿä¸­ã€‚ç”±äºå¢åŠ æ–°çš„å…·ä½“å‘½ä»¤ç±»ä¸ä¼šå½±å“åˆ°å…¶ä»–ç±»ï¼Œå› æ­¤å¢åŠ æ–°çš„å…·ä½“å‘½ä»¤ç±»å¾ˆå®¹æ˜“ï¼Œæ— é¡»ä¿®æ”¹åŸæœ‰ç³»ç»Ÿæºä»£ç ï¼Œç”šè‡³å®¢æˆ·ç±»ä»£ç ï¼Œæ»¡è¶³â€œå¼€é—­åŸåˆ™â€çš„è¦æ±‚ã€‚ ç¼ºç‚¹ï¼šä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´æŸäº›ç³»ç»Ÿæœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»ã€‚å› ä¸ºé’ˆå¯¹æ¯ä¸€ä¸ªå¯¹è¯·æ±‚æ¥æ”¶è€…çš„è°ƒç”¨æ“ä½œéƒ½éœ€è¦è®¾è®¡ä¸€ä¸ªå…·ä½“å‘½ä»¤ç±»ï¼Œå› æ­¤åœ¨æŸäº›ç³»ç»Ÿä¸­å¯èƒ½éœ€è¦æä¾›å¤§é‡çš„å…·ä½“å‘½ä»¤ç±»ï¼Œè¿™å°†å½±å“å‘½ä»¤æ¨¡å¼çš„ä½¿ç”¨ã€‚ æœ€ä½³å®è·µï¼š 1.ç³»ç»Ÿéœ€è¦å°†è¯·æ±‚è°ƒç”¨è€…å’Œè¯·æ±‚æ¥æ”¶è€…è§£è€¦ï¼Œä½¿å¾—è°ƒç”¨è€…å’Œæ¥æ”¶è€…ä¸ç›´æ¥äº¤äº’ã€‚ 2.ç³»ç»Ÿéœ€è¦åœ¨ä¸åŒçš„æ—¶é—´æŒ‡å®šè¯·æ±‚ã€å°†è¯·æ±‚æ’é˜Ÿå’Œæ‰§è¡Œè¯·æ±‚ã€‚ ä¸¾ä¾‹ï¼šSiriè¯­éŸ³åŠ©æ‰‹ 1.åˆ›å»ºå‘½ä»¤æ¥å£ public interface Command { //æ‰§è¡Œå‘½ä»¤ void execute(); } 2.åˆ›å»ºå…·ä½“å®ç°å‘½ä»¤å®ç°ç±» public class OpenCommand implements Command { private Application app; public OpenCommand(Application app){ this.app = app; } @Override public void execute() { app.on(); } } public class CloseCommand implements Command { private Application app; public CloseCommand(Application app){ this.app = app; } @Override public void execute() { app.off(); } } 3.åˆ›å»ºåº”ç”¨æŠ½è±¡ç±» public abstract class Application { public abstract void on(); public abstract void off(); } 4.åˆ›å»ºåº”ç”¨å®ç°ç±» public class WeChat extends Application { @Override public void on() { System.out.println("å¾®ä¿¡æ‰“å¼€äº†"); } @Override public void off() { System.out.println("å¾®ä¿¡å…³é—­äº†"); } } public class Alipay extends Application { @Override public void on() { System.out.println("æ”¯ä»˜å®æ‰“å¼€äº†"); } @Override public void off() { System.out.println("æ”¯ä»˜å®å…³é—­äº†"); } } 5.å®ç°å‘½ä»¤å‘èµ·è€… public class Siri { private Command command; /** * è®¾ç½®è¦æ‰§è¡Œçš„å‘½ä»¤ * @param command å‘½ä»¤ */ public void setCommand(Command command){ this.command = command; } /** * æ‰§è¡Œå‘½ä»¤ */ public void executeCommand(){ command.execute(); } } 6.æµ‹è¯• public class CpTest { public static void main(String[] args) { Siri siri = new Siri(); System.out.println("å˜¿ siriï¼Œ æ‰“å¼€å¾®ä¿¡"); Application weChat = new WeChat(); Command command = new OpenCommand(weChat); //siriä¼ é€’å‘½ä»¤ siri.setCommand(command); siri.executeCommand(); System.out.println("å˜¿ siriï¼Œæ‰“å¼€æ”¯ä»˜å®"); Application alipay = new Alipay(); command = new OpenCommand(alipay); //siriä¼ é€’å‘½ä»¤ siri.setCommand(command); siri.executeCommand(); } } 7.è¾“å‡º å˜¿ siriï¼Œ æ‰“å¼€å¾®ä¿¡ å¾®ä¿¡æ‰“å¼€äº† å˜¿ siriï¼Œæ‰“å¼€æ”¯ä»˜å® æ”¯ä»˜å®æ‰“å¼€äº† 3.8. ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMPï¼‰è‹±æ–‡ï¼šMediator Pattern å®šä¹‰ï¼šä¸­ä»‹è€…æ¨¡å¼æ˜¯æŒ‡ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ã€‚ä¸­ä»‹è€…ä½¿ä¸ªå¯¹è±¡ä¸éœ€è¦æ˜¾ç¤ºçš„ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ ä¼˜ç‚¹ï¼š 1.ç®€åŒ–äº†å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œå®ƒç”¨ä¸­ä»‹è€…å’ŒåŒäº‹çš„ä¸€å¯¹å¤šäº¤äº’ä»£æ›¿äº†åŸæ¥åŒäº‹ä¹‹é—´çš„å¤šå¯¹å¤šäº¤äº’ï¼Œä¸€å¯¹å¤šå…³ç³»æ›´å®¹æ˜“ç†è§£ã€ç»´æŠ¤æ‰©å±•ï¼Œå°†åŸæœ¬éš¾ä»¥ç†è§£çš„ç½‘çŠ¶ç»“æ„è½¬æ¢æˆç›¸å¯¹ç®€å•çš„æ˜Ÿå‹ç»“æ„ã€‚ 2.å¯å°†å„åŒäº‹å¯¹è±¡è§£è€¦ã€‚ä¸­ä»‹è€…æœ‰åˆ©äºå„åŒäº‹ä¹‹é—´çš„æ¾è€¦åˆï¼Œæˆ‘ä»¬å¯ä»¥ç‹¬ç«‹çš„æ”¹å˜å’Œå¤ç”¨æ¯ä¸€ä¸ªåŒäº‹å’Œä¸­ä»‹è€…ï¼Œå¢åŠ æ–°çš„ä¸­ä»‹è€…å’Œæ–°çš„åŒäº‹ç±»éƒ½æ¯”è¾ƒæ–¹ä¾¿ï¼Œæ›´å¥½çš„ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚ 3.å¯ä»¥å‡å°‘å­ç±»ç”Ÿæˆï¼Œä¸­ä»‹è€…å°†åŸæœ¬åˆ†å¸ƒäºå¤šä¸ªå¯¹è±¡é—´çš„è¡Œä¸ºé›†ä¸­åœ¨ä¸€èµ·ï¼Œæ”¹å˜è¿™äº›è¡Œä¸ºåªéœ€ç”Ÿæˆæ–°çš„ä¸­ä»‹è€…å­ç±»å³å¯ï¼Œè¿™ä½¿å¾—å„ä¸ªåŒäº‹ç±»å¯è¢«é‡ç”¨ï¼Œæ— é¡»å¯¹åŒäº‹ç±»è¿›è¡Œæ‰©å±•ã€‚ ç¼ºç‚¹ï¼šåœ¨å…·ä½“ä¸­ä»‹è€…ç±»ä¸­åŒ…å«äº†å¤§é‡åŒäº‹ä¹‹é—´çš„äº¤äº’ç»†èŠ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…·ä½“ä¸­ä»‹è€…ç±»éå¸¸å¤æ‚ï¼Œä½¿å¾—ç³»ç»Ÿéš¾ä»¥ç»´æŠ¤ã€‚ æœ€ä½³å®è·µï¼š 1.ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤æ‚çš„å¼•ç”¨å…³ç³»ï¼Œç³»ç»Ÿç»“æ„æ··ä¹±ä¸”éš¾ä»¥ç†è§£ã€‚ 2.ä¸€ä¸ªå¯¹è±¡ç”±äºå¼•ç”¨äº†å…¶ä»–å¾ˆå¤šå¯¹è±¡å¹¶ä¸”ç›´æ¥å’Œè¿™äº›å¯¹è±¡é€šä¿¡ï¼Œå¯¼è‡´éš¾ä»¥å¤ç”¨è¯¥å¯¹è±¡ã€‚ 3.æƒ³é€šè¿‡ä¸€ä¸ªä¸­é—´ç±»æ¥å°è£…å¤šä¸ªç±»ä¸­çš„è¡Œä¸ºï¼Œè€Œåˆä¸æƒ³ç”Ÿæˆå¤ªå¤šçš„å­ç±»ã€‚å¯ä»¥é€šè¿‡å¼•å…¥ä¸­ä»‹è€…ç±»æ¥å®ç°ï¼Œåœ¨ä¸­ä»‹è€…ä¸­å®šä¹‰å¯¹è±¡äº¤äº’çš„å…¬å…±è¡Œä¸ºï¼Œå¦‚æœéœ€è¦æ”¹å˜è¡Œä¸ºåˆ™å¯ä»¥å¢åŠ æ–°çš„å…·ä½“ä¸­ä»‹è€…ç±»ã€‚ ä¸¾ä¾‹ï¼šåŒäº‹ç±»ç›¸äº’å½±å“ 1.åˆ›å»ºåŒäº‹ç±»æŠ½è±¡ç±» public abstract class Colleague { protected int number; public int getNumber() { return number; } public void setNumber(int number){ this.number = number; } public abstract void setNumber(int number, Mediator mediator); } 2.åˆ›å»ºåŒäº‹ç±»å®ç°ç±» public class ColleagueA extends Colleague{ @Override public void setNumber(int number, Mediator mediator) { this.number = number; mediator.A2B(); } } public class ColleagueB extends Colleague{ @Override public void setNumber(int number, Mediator mediator) { this.number = number; mediator.B2A(); } } 3.åˆ›å»ºä¸­ä»‹è€…æŠ½è±¡ç±» public abstract class Mediator { protected Colleague ca; protected Colleague cb; public Mediator(Colleague a, Colleague b) { this.ca = a; this.cb = b; } public abstract void A2B(); public abstract void B2A(); } 4.åˆ›å»ºä¸­ä»‹è€…å®ç°ç±» public class MediatorImpl extends Mediator { public MediatorImpl(Colleague a, Colleague b) { super(a, b); } @Override public void A2B() { int number = ca.getNumber(); cb.setNumber(number*100); } @Override public void B2A() { int number = cb.getNumber(); ca.setNumber(number/100); } } 5.æµ‹è¯• public class MpTest { public static void main(String[] args) { ColleagueA colleagueA = new ColleagueA(); ColleagueB colleagueB = new ColleagueB(); Mediator mediator = new MediatorImpl(colleagueA,colleagueB); System.out.println("++++++++++++é€šè¿‡è®¾ç½®Aå½±å“B++++++++++++"); colleagueA.setNumber(1000,mediator); System.out.println("Açš„å€¼ä¸ºï¼š"+colleagueA.getNumber()); System.out.println("Bçš„å€¼ä¸ºAçš„10å€ï¼š"+colleagueB.getNumber()); System.out.println("++++++++++++é€šè¿‡è®¾ç½®Bå½±å“A++++++++++++"); colleagueB.setNumber(2000,mediator); System.out.println("Bçš„å€¼ä¸ºï¼š"+colleagueB.getNumber()); System.out.println("Açš„å€¼ä¸ºBçš„0.1å€ï¼š"+colleagueA.getNumber()); } } 6.è¾“å‡º ++++++++++++é€šè¿‡è®¾ç½®Aå½±å“B++++++++++++ Açš„å€¼ä¸ºï¼š1000 Bçš„å€¼ä¸ºAçš„10å€ï¼š100000 ++++++++++++é€šè¿‡è®¾ç½®Bå½±å“A++++++++++++ Bçš„å€¼ä¸ºï¼š2000 Açš„å€¼ä¸ºBçš„0.1å€ï¼š20 3.9. èŒè´£é“¾æ¨¡å¼ï¼ˆCRPï¼‰è‹±æ–‡ï¼šChain of Responsibility Pattern å®šä¹‰ï¼šè´£ä»»é“¾æ¨¡å¼æ˜¯ä¸ºäº†é¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œä½¿å¤šä¸ªæ¥æ”¶å¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ã€‚å°†è¿™äº›å¯¹è±¡ç»ƒæˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚ èŒè´£é“¾åˆ†ç±» å®šä¹‰ çº¯çš„èŒè´£é“¾æ¨¡å¼ çº¯çš„èŒè´£é“¾æ¨¡å¼è¦æ±‚ä¸€ä¸ªå…·ä½“çš„å¤„ç†è€…å¯¹è±¡åªèƒ½åœ¨ä¸¤ä¸ªè¡Œä¸ºä¸­é€‰æ‹©ä¸€ä¸ªï¼šä¸€ä¸ªæ˜¯æ‰¿æ‹…è´£ä»»ï¼›äºŒæ˜¯æŠŠè´£ä»»æ¨ç»™ä¸‹å®¶ã€‚ä¸å…è®¸å‡ºç°æŸä¸€ä¸ªå…·ä½“å¤„ç†è€…å¯¹è±¡åœ¨æ‰¿æ‹…äº†ä¸€éƒ¨åˆ†è´£ä»»ååˆæŠŠè´£ä»»å‘ä¸‹ä¼ çš„æƒ…å†µã€‚åœ¨ä¸€ä¸ªçº¯çš„èŒè´£é“¾ä¸­ï¼Œä¸€ä¸ªè¯·æ±‚å¿…é¡»è¢«æŸä¸€ä¸ªå¤„ç†è€…å¯¹è±¡æ‰€æ¥å—ã€‚ ä¸çº¯çš„èŒè´£é“¾æ¨¡å¼ ä¸çº¯çš„èŒè´£é“¾æ¨¡å¼ä¸­å…è®¸æŸä¸ªè¯·æ±‚è¢«ä¸€ä¸ªå…·ä½“å¤„ç†è€…éƒ¨åˆ†å¤„ç†åå†å‘ä¸‹ä¼ é€’ï¼Œæˆ–è€…ä¸€ä¸ªå…·ä½“å¤„ç†è€…å¤„ç†å®ŒæŸè¯·æ±‚åå…¶åç»§å¤„ç†è€…å¯ä»¥ç»§ç»­å¤„ç†è¯¥è¯·æ±‚ï¼Œè€Œä¸”ä¸€ä¸ªè¯·æ±‚å¯ä»¥æœ€ç»ˆä¸è¢«ä»»ä½•å¤„ç†è€…å¯¹è±¡æ‰€æ¥æ”¶ã€‚ ä¼˜ç‚¹ï¼š 1.è¯·æ±‚ä¸éœ€è¦æŒ‡å‡ºè¢«å“ªä¸ªå¯¹è±¡å¤„ç†äº†ï¼Œè¿™æ ·çš„æ•ˆæœæ˜¯è¯·æ±‚è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è§£è€¦ï¼Œè€Œä¸”é“¾ä¸­çš„å¯¹è±¡ä¹Ÿä¸éœ€è¦æ¸…æ¥šå…¶ä»–é“¾çš„ç»“æ„ï¼Œä¹Ÿé™ä½äº†è€¦åˆã€‚ 2.è¯·æ±‚å¤„ç†å¯¹è±¡ä»…éœ€è¦ç»´æŠ¤ä¸€ä¸ªæŒ‡å‘å…¶åç»§è€…çš„çš„å¼•ç”¨ï¼Œè€Œä¸éœ€è¦ç»´æŠ¤æ‰€æœ‰çš„å¤„ç†å¯¹è±¡ï¼Œç®€åŒ–äº†å¯¹è±¡ä¹‹é—´çš„ç›¸äº’è¿æ¥ã€‚ 3.åœ¨ç»™å¯¹è±¡åˆ†æ´¾èŒè´£æ—¶ï¼ŒèŒè´£é“¾å¯ä»¥ç»™æˆ‘ä»¬æ›´å¤šçš„çµæ´»æ€§ï¼Œå¯ä»¥é€šè¿‡åœ¨è¿è¡Œæ—¶å¯¹è¯¥é“¾è¿›è¡ŒåŠ¨æ€çš„å¢åŠ æˆ–ä¿®æ”¹æ¥å¢åŠ æˆ–æ”¹å˜å¤„ç†ä¸€ä¸ªè¯·æ±‚çš„èŒè´£ã€‚ 4.æ–°å¢ä¸€ä¸ªè¯·æ±‚å¤„ç†å¯¹è±¡ï¼Œä¸éœ€è¦æ”¹åŠ¨ç°æœ‰ä»£ç ï¼Œåªéœ€è¦é‡æ–°è®¾ç½®è¿æ¥å³å¯ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚ ç¼ºç‚¹ï¼š 1.å¦‚æœä¸€ä¸ªè¯·æ±‚æ²¡æœ‰æ˜ç¡®çš„æ¥æ”¶è€…ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä¿è¯å®ƒä¸€å®šä¼šè¢«å¤„ç†ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¸€ç›´åˆ°é“¾çš„æœ«ç«¯éƒ½å¾—ä¸åˆ°å¤„ç†ï¼›ä¸€ä¸ªè¯·æ±‚ä¹Ÿå¯èƒ½å› èŒè´£é“¾æ²¡æœ‰è¢«æ­£ç¡®é…ç½®è€Œå¾—ä¸åˆ°å¤„ç†ã€‚ 2.å¯¹äºæ¯”è¾ƒé•¿çš„èŒè´£é“¾ï¼Œè¯·æ±‚çš„å¤„ç†å¯èƒ½æ¶‰åŠåˆ°å¤šä¸ªå¤„ç†å¯¹è±¡ï¼Œä¸ä»…å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§å¹¶ä¸”ç³»ç»Ÿæ€§èƒ½ä¹Ÿå°†å—åˆ°ä¸€å®šå½±å“ï¼Œè€Œä¸”åœ¨è¿›è¡Œä»£ç è°ƒè¯•æ—¶ä¸å¤ªæ–¹ä¾¿ã€‚ 3.è‹¥å»ºé“¾ä¸å½“ï¼Œå¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ï¼Œå°†å¯¼è‡´ç³»ç»Ÿé™·å…¥æ­»å¾ªç¯ã€‚ æœ€ä½³å®è·µï¼š 1.æœ‰å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ï¼Œå…·ä½“å“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚å¾…è¿è¡Œæ—¶åˆ»å†ç¡®å®šï¼Œå®¢æˆ·ç«¯åªéœ€å°†è¯·æ±‚æäº¤åˆ°é“¾ä¸Šï¼Œè€Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†å¯¹è±¡æ˜¯è°ä»¥åŠå®ƒæ˜¯å¦‚ä½•å¤„ç†çš„ã€‚ 2.åœ¨ä¸æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…çš„æƒ…å†µä¸‹ï¼Œå‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤ä¸€ä¸ªè¯·æ±‚ã€‚ 3.å¯åŠ¨æ€æŒ‡å®šä¸€ç»„å¯¹è±¡å¤„ç†è¯·æ±‚ï¼Œå®¢æˆ·ç«¯å¯ä»¥åŠ¨æ€åˆ›å»ºèŒè´£é“¾æ¥å¤„ç†è¯·æ±‚ï¼Œè¿˜å¯ä»¥æ”¹å˜é“¾ä¸­å¤„ç†è€…ä¹‹é—´çš„å…ˆåæ¬¡åºã€‚å…¶å®åœ¨æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ä¹Ÿä¼šæœ‰é€‚ç”¨åˆ°è´£ä»»é“¾æ¨¡å¼çš„åœºæ™¯ï¼Œtry/catchã€servlet(å„ä¸ªserveltäº’ç›¸è°ƒç”¨)ã€ä»¥åŠfilterç­‰ ä¸¾ä¾‹ï¼šè¯·å‡å®¡æ‰¹ 1.åˆ›å»ºè¯·å‡å¯¹è±¡ public class Leave { //å§“å private String name; //éƒ¨é—¨ private String department; //å¤©æ•° private Double day; //åŸå›  private String cause; public String getName() { return name; } public void setName(String name) { this.name = name; } public String getDepartment() { return department; } public void setDepartment(String department) { this.department = department; } public Double getDay() { return day; } public void setDay(Double day) { this.day = day; } public String getCause() { return cause; } public void setCause(String cause) { this.cause = cause; } @Override public String toString() { return "Leave{" + "name='" + name + '\'' + ", department='" + department + '\'' + ", day=" + day + ", cause='" + cause + '\'' + '}'; } } 2.åˆ›å»ºå®¡æ‰¹è€…æŠ½è±¡ç±» public abstract class Approver { //å®¡æ ¸äººå public String name; //ä¸‹ä¸€ä¸ªå®¡æ ¸äºº public Approver nextApprove; public Approver(String name) { this.name = name; } //è®¾ç½®ä¸‹ä¸€ä¸ªå®¡æ ¸äºº public void setNextApprove(Approver nextApprove) { this.nextApprove = nextApprove; } //å®¡æ ¸ public abstract void approval(Leave leave); } 3.åˆ›å»ºå®¡æ‰¹è€…å®ç°ç±» public class Manager extends Approver { public Manager(String name) { super(name); } @Override public void approval(Leave leave) { if(leave.getDay() &lt; 5){ System.out.println(name+"æƒé™èŒƒå›´å†…,æ‰¹å‡†äº†"); System.out.println("ç»“æŸå®¡æ‰¹"); }else{ if(Objects.nonNull(nextApprove)){ System.out.println(name+"æƒé™èŒƒå›´å¤–,ç§»äº¤ä¸Šä¸€çº§é¢†å¯¼"); this.nextApprove.approval(leave); }else{ System.out.println("é¢†å¯¼ä¸åœ¨,å®¡æ‰¹è´¨æŠ¼"); } } } } public class Boss extends Approver { public Boss(String name) { super(name); } @Override public void approval(Leave leave) { if (leave.getDay() > 5 &amp;&amp; leave.getDay() &lt; 10) { System.out.println(name+"ï¼šæœªè¶…é¢„æœŸ,æ‰¹å‡†"); System.out.println("ç»“æŸå®¡æ‰¹"); } else { System.out.println(name+"æ—¶é—´å¤ªé•¿äº†,å½±å“å…¬å¸æŒ£é’±,é©³å›"); System.out.println("ç»“æŸå®¡æ‰¹"); } } } 4.æµ‹è¯• public class CrpTest { public static void main(String[] args) { Leave leave = new Leave(); leave.setName("å°ç‹"); leave.setDepartment("ç ”å‘éƒ¨"); leave.setDay(8.0D); leave.setCause("ç»“å©š"); Manager manager = new Manager("æç»ç†"); Boss boss = new Boss("é’±æ€»"); manager.setNextApprove(boss); System.out.println("è¯·å‡å‘èµ·è€…ï¼š"+leave.toString()); manager.approval(leave); } } 5.è¾“å‡º è¯·å‡å‘èµ·è€…ï¼šLeave{name='å°ç‹', department='ç ”å‘éƒ¨', day=8.0, cause='ç»“å©š'} æç»ç†æƒé™èŒƒå›´å¤–,ç§»äº¤ä¸Šä¸€çº§é¢†å¯¼ é’±æ€»ï¼šæœªè¶…é¢„æœŸ,æ‰¹å‡† ç»“æŸå®¡æ‰¹ 3.10. è®¿é—®è€…æ¨¡å¼ï¼ˆVPï¼‰è‹±æ–‡ï¼šVisitor Pattern å®šä¹‰ï¼šè¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œã€‚å®ƒä½¿ä½ å¯ä»¥åœ¨ä¸æ”¹å˜å„å…ƒç´ ç±»çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚ ä¼˜ç‚¹ï¼š 1.ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ 2.ä¼˜ç§€çš„æ‰©å±•æ€§ 3.çµæ´»æ€§ ç¼ºç‚¹ï¼š 1.å…·ä½“å…ƒç´ å¯¹è®¿é—®è€…å…¬å¸ƒç»†èŠ‚ï¼Œè¿åäº†è¿ªç±³ç‰¹åŸåˆ™ 2.å…·ä½“å…ƒç´ å˜æ›´æ¯”è¾ƒå›°éš¾ 3.è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ï¼Œä¾èµ–äº†å…·ä½“ç±»ï¼Œæ²¡æœ‰ä¾èµ–æŠ½è±¡ã€‚ æœ€ä½³å®è·µï¼š 1.å¯¹è±¡ç»“æ„ä¸­å¯¹è±¡å¯¹åº”çš„ç±»å¾ˆå°‘æ”¹å˜ï¼Œä½†ç»å¸¸éœ€è¦åœ¨æ­¤å¯¹è±¡ç»“æ„ä¸Šå®šä¹‰æ–°çš„æ“ä½œã€‚ 2.éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œå¾ˆå¤šä¸åŒçš„å¹¶ä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œéœ€è¦é¿å…è®©è¿™äº›æ“ä½œâ€æ±¡æŸ“â€è¿™äº›å¯¹è±¡çš„ç±»ï¼Œä¹Ÿä¸å¸Œæœ›åœ¨å¢åŠ æ–°æ“ä½œæ—¶ä¿®æ”¹è¿™äº›ç±»ã€‚ æ³¨æ„äº‹é¡¹ï¼šè®¿é—®è€…å¯ä»¥å¯¹åŠŸèƒ½è¿›è¡Œç»Ÿä¸€ï¼Œå¯ä»¥åšæŠ¥è¡¨ã€UIã€æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨ã€‚ ä¸¾ä¾‹ï¼š åœºæ™¯ï¼š CEOå’ŒCTOå¼€å§‹è¯„å®šå‘˜å·¥ä¸€å¹´çš„å·¥ä½œç»©æ•ˆï¼Œå‘˜å·¥åˆ†ä¸ºå·¥ç¨‹å¸ˆå’Œç»ç†ï¼ŒCTOå…³æ³¨å·¥ç¨‹å¸ˆçš„ä»£ç é‡ã€ç»ç†çš„æ–°äº§å“æ•°é‡ï¼›CEOå…³æ³¨çš„æ˜¯å·¥ç¨‹å¸ˆçš„KPIå’Œç»ç†çš„KPIä»¥åŠæ–°äº§å“æ•°é‡ã€‚ç”±äºCEOå’ŒCTOå¯¹äºä¸åŒå‘˜å·¥çš„å…³æ³¨ç‚¹æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™å°±éœ€è¦å¯¹ä¸åŒå‘˜å·¥ç±»å‹è¿›è¡Œä¸åŒçš„å¤„ç†ã€‚è®¿é—®è€…æ¨¡å¼æ­¤æ—¶å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ã€‚ 1.åˆ›å»ºæŠ½è±¡å‘˜å·¥ç±» public abstract class Staff { //å‘˜å·¥å§“å public String name; //å‘˜å·¥KPI public Integer kpi; public Staff(String name) { this.name = name; this.kpi = new Random().nextInt(10); } //æ¥å—visitorè®¿é—® public abstract void accept(Visitor visitor); } 2.åˆ›å»ºå‘˜å·¥å®ç°ç±» public class Engineer extends Staff { public Engineer(String name) { super(name); } @Override public void accept(Visitor visitor) { visitor.visit(this); } public int getCodeLines(){ return new Random().nextInt(100000); } } public class Manager extends Staff { public Manager(String name) { super(name); } @Override public void accept(Visitor visitor) { visitor.visit(this); } public int getProductNum(){ return new Random().nextInt(10); } } 3.åˆ›å»ºè§‚æ¥å£ public interface Visitor { // è®¿é—®å·¥ç¨‹å¸ˆç±»å‹ void visit(Engineer engineer); // è®¿é—®ç»ç†ç±»å‹ void visit(Manager manager); } 4.åˆ›å»ºè§‚å¯Ÿè€…æ¥å£å®ç°ç±» public class CEO implements Visitor { private String name; public CEO(String name) { this.name = name; } @Override public void visit(Engineer engineer) { System.out.println(name+"æŸ¥çœ‹:"+engineer.name+"çš„KPIï¼š"+engineer.kpi); } @Override public void visit(Manager manager) { System.out.println(name+"æŸ¥çœ‹:"+manager.name+"çš„KPIï¼š"+manager.kpi); } } public class CTO implements Visitor { private String name; public CTO(String name) { this.name = name; } @Override public void visit(Engineer engineer) { System.out.println(name+"æŸ¥çœ‹:"+engineer.name+"çš„ä»£ç æ•°ï¼š"+engineer.getCodeLines()); } @Override public void visit(Manager manager) { System.out.println(name+"æŸ¥çœ‹:"+manager.name+"çš„äº§å“æ•°ï¼š"+manager.getProductNum()); } } 5.åˆ›å»ºæŠ¥è¡¨ç±» public class ExcelReport { private List&lt;Staff> staffs = new ArrayList&lt;>(); public ExcelReport(){ staffs.add(new Manager("æç»ç†")); staffs.add(new Manager("å¼ ç»ç†")); staffs.add(new Engineer("å°ç‹")); staffs.add(new Engineer("å°æ")); } public void showReport(Visitor visitor){ for (Staff staff : staffs) { staff.accept(visitor); } } } 6.æµ‹è¯• public class VpTest { public static void main(String[] args) { ExcelReport excelReport = new ExcelReport(); excelReport.showReport(new CEO("å´è‘£")); excelReport.showReport(new CTO("ç¨‹æ€»")); } } 7.è¾“å‡º å´è‘£æŸ¥çœ‹:æç»ç†çš„KPIï¼š3 å´è‘£æŸ¥çœ‹:å¼ ç»ç†çš„KPIï¼š7 å´è‘£æŸ¥çœ‹:å°ç‹çš„KPIï¼š5 å´è‘£æŸ¥çœ‹:å°æçš„KPIï¼š8 ç¨‹æ€»æŸ¥çœ‹:æç»ç†çš„äº§å“æ•°ï¼š1 ç¨‹æ€»æŸ¥çœ‹:å¼ ç»ç†çš„äº§å“æ•°ï¼š3 ç¨‹æ€»æŸ¥çœ‹:å°ç‹çš„ä»£ç æ•°ï¼š55701 ç¨‹æ€»æŸ¥çœ‹:å°æçš„ä»£ç æ•°ï¼š31420 3.11. çŠ¶æ€æ¨¡å¼ï¼ˆSPï¼‰è‹±æ–‡ï¼šState Pattern å®šä¹‰ï¼šå…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»ã€‚ ä¼˜ç‚¹ï¼š 1.å°è£…äº†çŠ¶æ€çš„è½¬æ¢è§„åˆ™ï¼Œåœ¨çŠ¶æ€æ¨¡å¼ä¸­å¯ä»¥å°†çŠ¶æ€è½¬æ¢çš„å·¥ä½œå°è£…åœ¨ç¯å¢ƒç±»æˆ–å…·ä½“çš„çŠ¶æ€ç±»ä¸­ï¼Œå¯ä»¥å¯¹çŠ¶æ€è½¬æ¢ç è¿›è¡Œé›†ä¸­ç®¡ç†ï¼Œè€Œä¸æ˜¯åˆ†æ•£åœ¨ä¸€ä¸ªä¸ªçš„ä¸šåŠ¡ä¸­ã€‚ 2.å°†æ‰€æœ‰ä¸æŸä¸ªçŠ¶æ€æœ‰å…³çš„è¡Œä¸ºæ”¾åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œåªéœ€è¦æ³¨å…¥ä¸€ä¸ªä¸åŒçš„çŠ¶æ€å¯¹è±¡å³å¯ä½¿ç¯å¢ƒå¯¹è±¡æ‹¥æœ‰ä¸åŒçš„è¡Œä¸ºã€‚ 3.å…è®¸çŠ¶æ€è½¬æ¢é€»è¾‘ä¸çŠ¶æ€å¯¹è±¡åˆä¸ºä¸€ä½“ï¼Œè€Œä¸æ˜¯æä¾›ä¸€ä¸ªå·¨å¤§çš„æ¡ä»¶è¯­å¥å—ï¼ŒçŠ¶æ€æ¨¡å¼å¯ä»¥è®©æˆ‘ä»¬é¿å…ä½¿ç”¨åºå¤§çš„æ¡ä»¶è¯­å¥æ¥å°†ä¸šåŠ¡æ–¹æ³•å’ŒçŠ¶æ€è½¬æ¢ä»£ç äº¤ç»‡åœ¨ä¸€èµ·ã€‚ ç¼ºç‚¹ï¼š 1.çŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨å¿…ç„¶ä¼šå¢åŠ ç³»ç»Ÿä¸­ç±»å’Œå¯¹è±¡çš„ä¸ªæ•°ï¼Œå¯¼è‡´ç³»ç»Ÿè¿è¡Œå¼€é”€å¢å¤§ã€‚ 2.çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°éƒ½è¾ƒä¸ºå¤æ‚ï¼Œå¦‚æœä½¿ç”¨ä¸å½“å°†å¯¼è‡´ç¨‹åºç»“æ„å’Œä»£ç çš„æ··ä¹±ï¼Œå¢åŠ ç³»ç»Ÿè®¾è®¡çš„éš¾åº¦ã€‚ æœ€ä½³å®è·µï¼š 1.å¯¹è±¡çš„è¡Œä¸ºä¾èµ–äºå®ƒçš„çŠ¶æ€ï¼ˆå¦‚æŸäº›å±æ€§å€¼ï¼‰ï¼ŒçŠ¶æ€çš„æ”¹å˜å°†å¯¼è‡´è¡Œä¸ºçš„å˜åŒ–ã€‚ 2.åœ¨ä»£ç ä¸­åŒ…å«å¤§é‡ä¸å¯¹è±¡çŠ¶æ€æœ‰å…³çš„æ¡ä»¶è¯­å¥ï¼Œè¿™äº›æ¡ä»¶è¯­å¥çš„å‡ºç°ï¼Œä¼šå¯¼è‡´ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œçµæ´»æ€§å˜å·®ï¼Œä¸èƒ½æ–¹ä¾¿åœ°å¢åŠ å’Œåˆ é™¤çŠ¶æ€ï¼Œå¹¶ä¸”å¯¼è‡´å®¢æˆ·ç±»ä¸ç±»åº“ä¹‹é—´çš„è€¦åˆå¢å¼ºã€‚ ä¸¾ä¾‹ï¼šè¯·å‡å®¡æ ¸ 1.åˆ›å»ºè¯·å‡å¯¹è±¡ public class LeaveApply { //ç”³è¯·å•åˆå§‹çŠ¶æ€æ˜¯å¾…æäº¤çŠ¶æ€ private ApplyState applyState = new Audit(); //è®¾ç½®çŠ¶æ€ public void setState(ApplyState state){ applyState = state; } //çŠ¶æ€å˜åŒ–å,æ›´æ–°å¯¹è±¡è‡ªèº«çš„è¡Œä¸º public void getResult(){ applyState.changeHandle(); } } 2.åˆ›å»ºå®¡æ ¸çŠ¶æ€æ¥å£ public interface ApplyState { //çŠ¶æ€å˜åŒ–å¤„ç†æ“ä½œ void changeHandle(); } 3.åˆ›å»ºå„å®¡æ ¸çŠ¶æ€å…·ä½“å®ç°ç±» public class Audit implements ApplyState { @Override public void changeHandle() { System.out.println("[å®¡æ ¸ä¸­]"); } } public class AuditPass implements ApplyState { @Override public void changeHandle() { System.out.println("[å®¡æ ¸é€šè¿‡]"); } } public class AuditReject implements ApplyState{ @Override public void changeHandle() { System.out.println("[å®¡æ ¸æœªé€šè¿‡]"); } } 4.æµ‹è¯• public class SpTest { public static void main(String[] args) { LeaveApply leaveApply = new LeaveApply(); leaveApply.getResult(); leaveApply.setState(new AuditPass()); leaveApply.getResult(); leaveApply.setState(new AuditReject()); leaveApply.getResult(); } } 5.è¾“å‡º [å®¡æ ¸ä¸­] [å®¡æ ¸é€šè¿‡] [å®¡æ ¸æœªé€šè¿‡] document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç³»ç»Ÿä¼˜åŒ–å°è®°ï¼šCPUé•¿æ—¶é—´æ»¡è´Ÿè·è¿è¡Œ]]></title>
    <url>%2F2020%2F11%2F28%2Fsystem-optimize%2F</url>
    <content type="text"><![CDATA[CPUé•¿æ—¶é—´æ»¡è´Ÿè·è¿è¡Œ,ä¸€æ¬¡å…¥é—¨çº§é™CPUç³»ç»Ÿä¼˜åŒ–å®æˆ˜ ç°è±¡ç”¨æˆ·é‡å¢å¤§,çº¿ä¸Šä¸€ä¸ªJavaå•åº”ç”¨æœåŠ¡é•¿æ—¶é—´å ç”¨æœåŠ¡å™¨CPUè¾¾åˆ°400%ï¼Œä½¿å¾—æ¥å£å“åº”é€Ÿåº¦éå¸¸æ…¢ï¼Œçº¿ç¨‹æ‹¥å µï¼Œå‡ºç°å„ç§å“åº”è¶…æ—¶é—®é¢˜ï¼Œå³ä¾¿æœ‰æ—¶å€™æ²¡æœ‰ç”¨æˆ·æ“ä½œï¼Œä¹Ÿä¼šé•¿æ—¶é—´å ç”¨å¤§é‡CPUå’Œå†…å­˜ã€‚ è§£å†³æ€è·¯æ‰¾å‡ºå“ªäº›ç¨‹åºå¤„ç†æ»¡ï¼Œè¿›è¡Œæ’æŸ¥ä¼˜åŒ–ï¼ˆä¸šåŠ¡æµç¨‹è°ƒæ•´ã€é”å…³é—­ã€SQLä¼˜åŒ–ã€ä¸€äº›è€—æ€§èƒ½çš„ç¨‹åºä¸ä½¿ç”¨å†…å­˜æ–¹æ¡ˆï¼‰ è§£å†³æ–¹æ¡ˆlinuxå‘½ä»¤æ’æŸ¥ + Arthasç›‘æ§ + Druid sql ç›‘æ§ è§£å†³æ–¹æ¡ˆï¼šä¸€ã€Linuxå‘½ä»¤æ’æŸ¥ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š1.æ˜¾ç¤ºè¿›ç¨‹åˆ—è¡¨ï¼Œå®šä½è¿›ç¨‹å·åœ¨topå‘½ä»¤ä¸‹ï¼ŒæŒ‰shift+HæŸ¥çœ‹cpuå ç”¨æœ€é«˜è¿›ç¨‹(PID:21659) 2.æ˜¾ç¤ºçº¿ç¨‹åˆ—è¡¨ï¼Œå®šä½çº¿ç¨‹å·ï¼Œæ‰¾åˆ°å“ªäº›çº¿ç¨‹å ç”¨é«˜è€—æ—¶é•¿å‘½ä»¤ï¼šps -mp pid -o THREAD,tid,time | sort -rn | more exï¼šps -mp 21659 -o THREAD,tid,time ï¼ˆshift+Hï¼‰ psï¼šæˆªå›¾ä¸­pidå†™æˆ24275åŸå› æ˜¯ç”±äºä¸­é€”é‡å¯è¿‡ä¸€æ¬¡ç¨‹åºï¼ŒåŸPIDï¼š21659 å˜æ›´æˆ PIDï¼š24275ï¼Œå®åˆ™éƒ½æ˜¯åŒä¸€ä¸ªJavaç¨‹åº å…¶ä¸­TIDï¼š24737ã€24742ã€24745ï¼Œè€—æ—¶è¾ƒé•¿å ç”¨CPUç‡è¾ƒé«˜ 3.å°†çº¿ç¨‹å·è½¬ä¸ºç³»ç»Ÿå¯è¯†åˆ«çš„16è¿›åˆ¶å‘½ä»¤ï¼šprintf "%x\n" tid 4.æ‰“å°çº¿ç¨‹çš„å †æ ˆä¿¡æ¯ï¼Œåˆ†æåŸå› å‘½ä»¤ï¼š jstack PID | grep [16è¿›åˆ¶TID] -A 30 exï¼šæŸ¥çœ‹çº¿ç¨‹24737çš„å †æ ˆä¿¡æ¯ï¼Œ jstack 24275 | grep 60a1 -A 30 5.å¦‚æœå«Œä»¥ä¸Šæ“ä½œéº»çƒ¦ï¼Œä¹Ÿå¯ç›´æ¥ä½¿ç”¨ jstack PIDï¼Œæ‰“å°å‡ºæ‰€æœ‰å †æ ˆï¼Œè¿›è¡ŒæŸ¥çœ‹ã€‚äºŒã€è¾…åŠ©ç¥å™¨Arthasç¨‹åºç›‘æ§æœ¬æ¬¡ä¸åœ¨è¯´æ˜ï¼Œåå‡ºä¸“é¢˜è®²è§£ï¼Œé™„ä¸Šå®˜æ–¹æ–‡æ¡£ï¼š Arthasä¼ é€é—¨ ä¸‰ã€è¾…åŠ©Druid SQLç›‘æ§æœ¬æ¬¡ä¹Ÿä¸åœ¨è¯´æ˜ï¼Œåå‡ºä¸“é¢˜è®²è§£ï¼Œé™„ä¸€å¼ å›¾ æœ€ç»ˆé—®é¢˜å®šä½åœ¨å †å†…å­˜å æ»¡ï¼Œæ–°åˆ›å»ºå¯¹è±¡æ—¶æ— æ³•åˆ†é…è¶³å¤Ÿçš„å†…å­˜ï¼Œå¼•èµ·é¢‘ç¹GC 1.ç¨‹åºé¢‘ç¹è¯·æ±‚RPCæ¥å£å¾—åˆ°çš„å“åº”æ…¢ï¼Œè€—æ—¶è¿‡å¤§ï¼› è§£å†³æ–¹æ¡ˆï¼šç”±äºè·å–çš„æ•°æ®å®æ—¶æ€§è¦æ±‚ä¸é«˜ï¼Œæ”¹ä¸ºç¼“å­˜å¤„ç†ï¼Œé¿å…å®æ—¶è¯·æ±‚ã€‚ 2.å®¢æˆ·ç«¯é¢‘ç¹è¯·æ±‚æŸä¸ªæ¥å£ï¼Œä¸”æ¥å£ä¸­çš„sqlæ•ˆç‡éå¸¸ä½,å¯¼è‡´äº†sqlè¿æ¥é•¿æ—¶é—´è¢«å ç”¨ã€‚ è§£å†³æ–¹æ¡ˆï¼šç”±äºè¯¥æ¥å£å†å²é—ç•™ï¼Œä¸”å’Œå¯¹åº”çš„è°ƒç”¨å®¢æˆ·ç«¯åŒäº‹ç¡®è®¤è¯¥æ¥å£ç°ä»Šå·²ç”¨å¤„ä¸å¤§ï¼Œå› æ­¤æ³¨é‡Šæ‰äº†è¯¥æ¥å£ã€‚ 3.é¢‘ç¹æ”¶åˆ°å›è°ƒï¼Œéšå¼€å¯äº†å¤šçº¿ç¨‹å¤„ç†ä½†ç”±äºæœ‰çº¿ç¨‹é”ï¼Œä½¿å¾—å…¶ä»–çº¿ç¨‹è¢«blockï¼Œå®åˆ™ä¾ç„¶æ˜¯ä¸ªå•çº¿ç¨‹å¤„ç†ï¼Œæ¶ˆè´¹é€Ÿåº¦èµ¶ä¸ä¸Šç”Ÿäº§é€Ÿåº¦ï¼Œçº¿ç¨‹ç§¯å‹ã€‚ è§£å†³æ–¹æ¡ˆï¼šç¡®ä¿å®‰å…¨çš„æƒ…å†µä¸‹ï¼Œå…³é—­äº†çº¿ç¨‹é”ã€‚ 4.ä»£ç é€»è¾‘ä¸åˆç†; è§£å†³æ–¹æ¡ˆï¼šé‡æ–°è°ƒæ•´ä»£ç é€»è¾‘ 5.å¯¹æ•°æ®åº“æ“ä½œè¿‡äºé¢‘ç¹; è§£å†³æ–¹æ¡ˆï¼šè°ƒæ•´é€»è¾‘ï¼Œä¼˜åŒ–sqlï¼ˆè°ƒæ•´sqlï¼ŒåŠ ç´¢å¼•ï¼Œé¿å…å…¨è¡¨æ‰«æï¼‰ï¼Œå°½é‡å°‘æ“ä½œæ•°æ®åº“ï¼Œå¤šä½¿ç”¨ç¼“å­˜å¯¹æ•°æ®è¿›è¡Œæ“ä½œ æ€»ç»“ç»è¿‡æ­¤æ¬¡æ’æŸ¥ï¼Œè™½æœ€ç»ˆé—®é¢˜å¾—ä»¥ç¼“è§£ï¼Œä½†æ·±çŸ¥ç³»ç»Ÿå†…ä¾ç„¶å­˜åœ¨å¾ˆå¤šå…¶ä»–æ€§èƒ½é—®é¢˜ï¼Œæš´éœ²å‡ºå¯¹JVMçŸ¥è¯†çš„æ¬ ç¼ºï¼Œä»¥åŠJavaä»£ç ã€SQLåŠŸåº•éœ€è¦æŒç»­åŠ å¼ºã€‚ä¿è¯ç¨‹åºç³»ç»Ÿçš„ç¨³å®šï¼Œå¥å£®ï¼Œé«˜æ•ˆã€‚ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>è¿ç»´</tag>
        <tag>åç«¯</tag>
        <tag>ç³»ç»Ÿä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Docker Installs]]></title>
    <url>%2F2020%2F10%2F23%2Fdocker-installs%2F</url>
    <content type="text"><![CDATA[docker å®‰è£…è½¯ä»¶å·¥å…· å‡†å¤‡å·¥ä½œdockerå‡†å¤‡å·¥ä½œä¼ é€é—¨ å‘½ä»¤å¿«æ· æŸ¥çœ‹é•œåƒ# docker images | grep ? å¯åŠ¨å®¹å™¨# docker run -id --name=matrix_mysql -p 13306:3306 -e MYSQL_ROOT_PASSWORD=abc123 mysql è¿›å…¥å®¹å™¨# docker exec -it å®¹å™¨å/å®¹å™¨Id /bin/bash å®‰è£…Nexus3æŸ¥è¯¢é•œåƒ# docker search nexus æ‹‰å–é•œåƒ# docker pull sonatype/nexus3 é…ç½®æœ¬åœ°ä¿å­˜æ•°æ®çš„è·¯å¾„ è·¯å¾„å¯è‡ªå®šä¹‰,æˆ‘æ”¾åœ¨/docker/nexus/nexus-dataä¸‹ã€‚ æ³¨æ„ï¼šåœ¨ç”Ÿæˆç›®å½•çš„æ—¶å€™ï¼Œå› ä¸ºnexusçš„è¯»å†™é»˜è®¤æ˜¯200,docker runçš„æ—¶å€™ä¼šæŠ¥æ‰¾ä¸åˆ°è·¯å¾„çš„é”™è¯¯ å¯èƒ½é‡åˆ°çš„é—®é¢˜:æ‰¾ä¸åˆ°è·¯å¾„é”™è¯¯ ä¿®æ”¹ç›®å½•æƒé™# chmod 777 docker # chmod 777 nexus # chmod 777 nexus-data è¿è¡Œé•œåƒ# docker run -d -p 8081:8081 -p 8082:8082 -p 8083:8083 --name matrix_nexus3 -v /usr/etc/docker/nexus/nexus-data:/nexus-data sonatype/nexus3 8082 å®¢æˆ·ç«¯é¡µé¢çš„å¯¹å¤–ç«¯å£; 8082 å‡†å¤‡å»ºç«‹docker hosted ç§æœ‰åº“ä½¿ç”¨ã€‚hostedå¯ä»¥ä¸Šä¼ ä¸‹è½½æˆ‘å»ºç«‹çš„images; 8083 å‡†å¤‡å»ºç«‹docker proxy ä»£ç†åº“ä½¿ç”¨ã€‚ proxyå¯ä»¥é•œåƒè¿œç¨‹å…¬å…±ä»“åº“ï¼Œæ¯”å¦‚ï¼šdockeå®˜æ–¹ä»“åº“ã€aliyunç­‰ç­‰; daemon.json åœ¨/etc/docker/daemon.jsonè¿™ä¸ªæ–‡ä»¶å¤¹ä¸­é…ç½®; daemon.jsonæ–‡ä»¶ä¸­çš„é…ç½®è¯´æ˜ï¼š { "registry-mirrors": ["https://1v50e4uy.mirror.aliyuncs.com"], ----æ–‡ä»¶åŠ é€Ÿåœ°å€ï¼Œä¸‹è½½å›½å¤–çš„é•œåƒï¼Œé€šè¿‡å®ƒè¿›è¡ŒåŠ é€Ÿ "insecure-registries":["192.168.111.112:8083"] ---é…ç½®æœ¬åœ°çš„é•œåƒåº“åœ°å€,æ¯æ¬¡æ‹–å–é•œåƒ,å¦‚æœ8083ä¸Šæ²¡æœ‰ï¼Œå…ˆä»è¿œç¨‹åº“ä¸‹è½½ï¼Œä¸‹è½½åˆ°8083ï¼Œå†ä¸‹è½½åˆ°æœ¬åœ°åº“ï¼Œä¸‹æ¬¡å†ä¸‹è½½çš„æ—¶å€™ï¼Œå°±ä»8083ä¸Šä¸‹è½½äº†ã€‚ } ç™»å½• Nexus31.ç™»å½•é“¾æ¥ï¼šhttp://192.168.111.112:8081/ 2.é»˜è®¤ç”¨æˆ·å:admin é»˜è®¤å¯†ç ä¸å†æ˜¯admin123,æ‰€ä»¥éœ€è¦å»å®¹å™¨å†…æŸ¥çœ‹ 3.æŸ¥çœ‹é»˜è®¤å¯†ç ï¼šè¿›å…¥å®¹å™¨å†…æŸ¥çœ‹ # docker exec -it matrix_nexus3 /bin/bash # cd nexus-data/ # vi admin.password ---å¤åˆ¶å‡ºå¯†ç ,å»ç½‘é¡µç™»å½• 4.ç™»å½•å®Œæˆå,é»˜è®¤æç¤ºä¿®æ”¹æ–°å¯†ç ,æ–°å¯†ç æ”¹å®Œå,admin.passwordå°†ä¼šæ¶ˆå¤±,æ‰€ä»¥è¦ä¿ç®¡å¥½å¯†ç  document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>è¿ç»´</tag>
        <tag>åç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Docker,è½»é‡çº§çš„è™šæ‹ŸåŒ–æŠ€æœ¯]]></title>
    <url>%2F2020%2F10%2F23%2Fdocker%2F</url>
    <content type="text"><![CDATA[Docker ä¸€ä¸ªåˆ©ç”¨äº†lxcçš„æŠ€æœ¯çš„ä¸€ä¸ªè™šæ‹ŸåŒ–å¼•æ“ã€‚ Dockerç®€ä»‹ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–â€‹ åœ¨è®¡ç®—æœºä¸­ï¼Œè™šæ‹ŸåŒ–ï¼ˆè‹±è¯­ï¼šVirtualizationï¼‰æ˜¯ä¸€ç§èµ„æºç®¡ç†æŠ€æœ¯ï¼Œæ˜¯å°†è®¡ç®—æœºçš„å„ç§å®ä½“èµ„æºï¼Œå¦‚æœåŠ¡å™¨ã€ç½‘ç»œã€å†…å­˜åŠå­˜å‚¨ç­‰ï¼Œäºˆä»¥æŠ½è±¡ã€è½¬æ¢åå‘ˆç°å‡ºæ¥ï¼Œæ‰“ç ´å®ä½“ç»“æ„é—´çš„ä¸å¯åˆ‡å‰²çš„éšœç¢ï¼Œä½¿ç”¨æˆ·å¯ä»¥æ¯”åŸæœ¬çš„ç»„æ€æ›´å¥½çš„æ–¹å¼æ¥åº”ç”¨è¿™äº›èµ„æºã€‚è¿™äº›èµ„æºçš„æ–°è™šæ‹Ÿéƒ¨ä»½æ˜¯ä¸å—ç°æœ‰èµ„æºçš„æ¶è®¾æ–¹å¼ï¼Œåœ°åŸŸæˆ–ç‰©ç†ç»„æ€æ‰€é™åˆ¶ã€‚ä¸€èˆ¬æ‰€æŒ‡çš„è™šæ‹ŸåŒ–èµ„æºåŒ…æ‹¬è®¡ç®—èƒ½åŠ›å’Œèµ„æ–™å­˜å‚¨ã€‚ â€‹ åœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè™šæ‹ŸåŒ–æŠ€æœ¯ä¸»è¦ç”¨æ¥è§£å†³é«˜æ€§èƒ½çš„ç‰©ç†ç¡¬ä»¶äº§èƒ½è¿‡å‰©å’Œè€çš„æ—§çš„ç¡¬ä»¶äº§èƒ½è¿‡ä½çš„é‡ç»„é‡ç”¨ï¼Œé€æ˜åŒ–åº•å±‚ç‰©ç†ç¡¬ä»¶ï¼Œä»è€Œæœ€å¤§åŒ–çš„åˆ©ç”¨ç‰©ç†ç¡¬ä»¶ å¯¹èµ„æºå……åˆ†åˆ©ç”¨ â€‹ è™šæ‹ŸåŒ–æŠ€æœ¯ç§ç±»å¾ˆå¤šï¼Œä¾‹å¦‚ï¼šè½¯ä»¶è™šæ‹ŸåŒ–ã€ç¡¬ä»¶è™šæ‹ŸåŒ–ã€å†…å­˜è™šæ‹ŸåŒ–ã€ç½‘ç»œè™šæ‹ŸåŒ–(vip)ã€æ¡Œé¢è™šæ‹ŸåŒ–ã€æœåŠ¡è™šæ‹ŸåŒ–ã€è™šæ‹Ÿæœºç­‰ç­‰ã€‚ ä»€ä¹ˆæ˜¯Dockerâ€‹ Docker æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œè¯ç”Ÿäº 2013 å¹´åˆï¼Œæœ€åˆæ˜¯ dotCloud å…¬å¸å†…éƒ¨çš„ä¸€ä¸ªä¸šä½™é¡¹ç›®ã€‚å®ƒåŸºäº Google å…¬å¸æ¨å‡ºçš„ Go è¯­è¨€å®ç°ã€‚ é¡¹ç›®åæ¥åŠ å…¥äº† Linux åŸºé‡‘ä¼šï¼Œéµä»äº† Apache 2.0 åè®®ï¼Œé¡¹ç›®ä»£ç åœ¨ GitHub ä¸Šè¿›è¡Œç»´æŠ¤ã€‚ â€‹ â€‹ Docker è‡ªå¼€æºåå—åˆ°å¹¿æ³›çš„å…³æ³¨å’Œè®¨è®ºï¼Œä»¥è‡³äº dotCloud å…¬å¸åæ¥éƒ½æ”¹åä¸º Docker Incã€‚Redhat å·²ç»åœ¨å…¶ RHEL6.5 ä¸­é›†ä¸­æ”¯æŒ Dockerï¼›Google ä¹Ÿåœ¨å…¶ PaaS äº§å“ä¸­å¹¿æ³›åº”ç”¨ã€‚ â€‹ Docker é¡¹ç›®çš„ç›®æ ‡æ˜¯å®ç°è½»é‡çº§çš„æ“ä½œç³»ç»Ÿè™šæ‹ŸåŒ–è§£å†³æ–¹æ¡ˆã€‚ Docker çš„åŸºç¡€æ˜¯ Linux å®¹å™¨ï¼ˆLXCï¼‰ç­‰æŠ€æœ¯ã€‚ â€‹ åœ¨ LXC çš„åŸºç¡€ä¸Š Docker è¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼Œè®©ç”¨æˆ·ä¸éœ€è¦å»å…³å¿ƒå®¹å™¨çš„ç®¡ç†ï¼Œä½¿å¾—æ“ä½œæ›´ä¸ºç®€ä¾¿ã€‚ç”¨æˆ·æ“ä½œ Docker çš„å®¹å™¨å°±åƒæ“ä½œä¸€ä¸ªå¿«é€Ÿè½»é‡çº§çš„è™šæ‹Ÿæœºä¸€æ ·ç®€å•ã€‚ ä¸ºä»€ä¹ˆé€‰æ‹©Docker? ï¼ˆ1ï¼‰ä¸Šæ‰‹å¿«ã€‚ â€‹ ç”¨æˆ·åªéœ€è¦å‡ åˆ†é’Ÿï¼Œå°±å¯ä»¥æŠŠè‡ªå·±çš„ç¨‹åºâ€œDockeråŒ–â€ã€‚Dockerä¾èµ–äºâ€œå†™æ—¶å¤åˆ¶â€ï¼ˆcopy-on-writeï¼‰æ¨¡å‹ï¼Œä½¿ä¿®æ”¹åº”ç”¨ç¨‹åºä¹Ÿéå¸¸è¿…é€Ÿï¼Œå¯ä»¥è¯´è¾¾åˆ°â€œéšå¿ƒæ‰€è‡´ï¼Œä»£ç å³æ”¹â€çš„å¢ƒç•Œã€‚ éšåï¼Œå°±å¯ä»¥åˆ›å»ºå®¹å™¨æ¥è¿è¡Œåº”ç”¨ç¨‹åºäº†ã€‚å¤§å¤šæ•°Dockerå®¹å™¨åªéœ€è¦ä¸åˆ°1ç§’ä¸­å³å¯å¯åŠ¨ã€‚ç”±äºå»é™¤äº†ç®¡ç†ç¨‹åºçš„å¼€é”€ï¼ŒDockerå®¹å™¨æ‹¥æœ‰å¾ˆé«˜çš„æ€§èƒ½ï¼ŒåŒæ—¶åŒä¸€å°å®¿ä¸»æœºä¸­ä¹Ÿå¯ä»¥è¿è¡Œæ›´å¤šçš„å®¹å™¨ï¼Œä½¿ç”¨æˆ·å°½å¯èƒ½çš„å……åˆ†åˆ©ç”¨ç³»ç»Ÿèµ„æºã€‚ ï¼ˆ2ï¼‰èŒè´£çš„é€»è¾‘åˆ†ç±» â€‹ ä½¿ç”¨Dockerï¼Œå¼€å‘äººå‘˜åªéœ€è¦å…³å¿ƒå®¹å™¨ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºï¼Œè€Œè¿ç»´äººå‘˜åªéœ€è¦å…³å¿ƒå¦‚ä½•ç®¡ç†å®¹å™¨ã€‚Dockerè®¾è®¡çš„ç›®çš„å°±æ˜¯è¦åŠ å¼ºå¼€å‘äººå‘˜å†™ä»£ç çš„å¼€å‘ç¯å¢ƒä¸åº”ç”¨ç¨‹åºè¦éƒ¨ç½²çš„ç”Ÿäº§ç¯å¢ƒä¸€è‡´æ€§ã€‚ä»è€Œé™ä½é‚£ç§â€œå¼€å‘æ—¶ä¸€åˆ‡æ­£å¸¸ï¼Œè‚¯å®šæ˜¯è¿ç»´çš„é—®é¢˜ï¼ˆæµ‹è¯•ç¯å¢ƒéƒ½æ˜¯æ­£å¸¸çš„ï¼Œä¸Šçº¿åå‡ºäº†é—®é¢˜å°±å½’ç»“ä¸ºè‚¯å®šæ˜¯è¿ç»´çš„é—®é¢˜ï¼‰â€ ï¼ˆ3ï¼‰å¿«é€Ÿé«˜æ•ˆçš„å¼€å‘ç”Ÿå‘½å‘¨æœŸ â€‹ Dockerçš„ç›®æ ‡ä¹‹ä¸€å°±æ˜¯ç¼©çŸ­ä»£ç ä»å¼€å‘ã€æµ‹è¯•åˆ°éƒ¨ç½²ã€ä¸Šçº¿è¿è¡Œçš„å‘¨æœŸï¼Œè®©ä½ çš„åº”ç”¨ç¨‹åºå…·å¤‡å¯ç§»æ¤æ€§ï¼Œæ˜“äºæ„å»ºï¼Œå¹¶æ˜“äºåä½œã€‚ï¼ˆé€šä¿—ä¸€ç‚¹è¯´ï¼ŒDockerå°±åƒä¸€ä¸ªç›’å­ï¼Œé‡Œé¢å¯ä»¥è£…å¾ˆå¤šç‰©ä»¶ï¼Œå¦‚æœéœ€è¦è¿™äº›ç‰©ä»¶çš„å¯ä»¥ç›´æ¥å°†è¯¥å¤§ç›’å­æ‹¿èµ°ï¼Œè€Œä¸éœ€è¦ä»è¯¥ç›’å­ä¸­ä¸€ä»¶ä»¶çš„å–ã€‚ï¼‰ ï¼ˆ4ï¼‰é¼“åŠ±ä½¿ç”¨é¢å‘æœåŠ¡çš„æ¶æ„ â€‹ Dockerè¿˜é¼“åŠ±é¢å‘æœåŠ¡çš„ä½“ç³»ç»“æ„å’Œå¾®æœåŠ¡æ¶æ„ã€‚Dockeræ¨èå•ä¸ªå®¹å™¨åªè¿è¡Œä¸€ä¸ªåº”ç”¨ç¨‹åºæˆ–è¿›ç¨‹ï¼Œè¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªåˆ†å¸ƒå¼çš„åº”ç”¨ç¨‹åºæ¨¡å‹ï¼Œåœ¨è¿™ç§æ¨¡å‹ä¸‹ï¼Œåº”ç”¨ç¨‹åºæˆ–è€…æœåŠ¡éƒ½å¯ä»¥è¡¨ç¤ºä¸ºä¸€ç³»åˆ—å†…éƒ¨äº’è”çš„å®¹å™¨ï¼Œä»è€Œä½¿åˆ†å¸ƒå¼éƒ¨ç½²åº”ç”¨ç¨‹åºï¼Œæ‰©å±•æˆ–è°ƒè¯•åº”ç”¨ç¨‹åºéƒ½å˜å¾—éå¸¸ç®€å•ï¼ŒåŒæ—¶ä¹Ÿæé«˜äº†ç¨‹åºçš„å†…çœæ€§ã€‚ï¼ˆå½“ç„¶ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªå®¹å™¨ä¸­è¿è¡Œå¤šä¸ªåº”ç”¨ç¨‹åºï¼‰ 1.3 å®¹å™¨ä¸è™šæ‹Ÿæœºæ¯”è¾ƒâ€‹ ä¸‹é¢çš„å›¾ç‰‡æ¯”è¾ƒäº† Docker å’Œä¼ ç»Ÿè™šæ‹ŸåŒ–æ–¹å¼çš„ä¸åŒä¹‹å¤„ï¼Œå¯è§å®¹å™¨æ˜¯åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ä¸Šå®ç°è™šæ‹ŸåŒ–ï¼Œç›´æ¥å¤ç”¨æœ¬åœ°ä¸»æœºçš„æ“ä½œç³»ç»Ÿï¼Œè€Œä¼ ç»Ÿæ–¹å¼åˆ™æ˜¯åœ¨ç¡¬ä»¶å±‚é¢å®ç°ã€‚ ä¸ä¼ ç»Ÿçš„è™šæ‹Ÿæœºç›¸æ¯”ï¼ŒDockerä¼˜åŠ¿ä½“ç°ä¸ºå¯åŠ¨é€Ÿåº¦å¿«ã€å ç”¨ä½“ç§¯å°ã€‚ Docker ç»„ä»¶DockeræœåŠ¡å™¨ä¸å®¢æˆ·ç«¯â€‹ Dockeræ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯-æœåŠ¡å™¨ï¼ˆC/Sï¼‰æ¶æ„ç¨‹åºã€‚Dockerå®¢æˆ·ç«¯åªéœ€è¦å‘DockeræœåŠ¡å™¨æˆ–è€…å®ˆæŠ¤è¿›ç¨‹å‘å‡ºè¯·æ±‚ï¼ŒæœåŠ¡å™¨æˆ–è€…å®ˆæŠ¤è¿›ç¨‹å°†å®Œæˆæ‰€æœ‰å·¥ä½œå¹¶è¿”å›ç»“æœã€‚Dockeræä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·Dockerä»¥åŠä¸€æ•´å¥—RESTful APIã€‚ä½ å¯ä»¥åœ¨åŒä¸€å°å®¿ä¸»æœºä¸Šè¿è¡ŒDockerå®ˆæŠ¤è¿›ç¨‹å’Œå®¢æˆ·ç«¯ï¼Œä¹Ÿå¯ä»¥ä»æœ¬åœ°çš„Dockerå®¢æˆ·ç«¯è¿æ¥åˆ°è¿è¡Œåœ¨å¦ä¸€å°å®¿ä¸»æœºä¸Šçš„è¿œç¨‹Dockerå®ˆæŠ¤è¿›ç¨‹ã€‚ Dockeré•œåƒä¸å®¹å™¨â€‹ é•œåƒæ˜¯æ„å»ºDockerçš„åŸºçŸ³ã€‚ç”¨æˆ·åŸºäºé•œåƒæ¥è¿è¡Œè‡ªå·±çš„å®¹å™¨ã€‚é•œåƒä¹Ÿæ˜¯Dockerç”Ÿå‘½å‘¨æœŸä¸­çš„â€œæ„å»ºâ€éƒ¨åˆ†ã€‚é•œåƒæ˜¯åŸºäºè”åˆæ–‡ä»¶ç³»ç»Ÿçš„ä¸€ç§å±‚å¼ç»“æ„ï¼Œç”±ä¸€ç³»åˆ—æŒ‡ä»¤ä¸€æ­¥ä¸€æ­¥æ„å»ºå‡ºæ¥ã€‚ä¾‹å¦‚ï¼š æ·»åŠ ä¸€ä¸ªæ–‡ä»¶ï¼› æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼› æ‰“å¼€ä¸€ä¸ªçª—å£ã€‚ ä¹Ÿå¯ä»¥å°†é•œåƒå½“ä½œå®¹å™¨çš„â€œæºä»£ç â€ã€‚é•œåƒä½“ç§¯å¾ˆå°ï¼Œéå¸¸â€œä¾¿æºâ€ï¼Œæ˜“äºåˆ†äº«ã€å­˜å‚¨å’Œæ›´æ–°ã€‚ â€‹ Dockerå¯ä»¥å¸®åŠ©ä½ æ„å»ºå’Œéƒ¨ç½²å®¹å™¨ï¼Œä½ åªéœ€è¦æŠŠè‡ªå·±çš„åº”ç”¨ç¨‹åºæˆ–è€…æœåŠ¡æ‰“åŒ…æ”¾è¿›å®¹å™¨å³å¯ã€‚å®¹å™¨æ˜¯åŸºäºé•œåƒå¯åŠ¨èµ·æ¥çš„ï¼Œå®¹å™¨ä¸­å¯ä»¥è¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œé•œåƒæ˜¯Dockerç”Ÿå‘½å‘¨æœŸä¸­çš„æ„å»ºæˆ–è€…æ‰“åŒ…é˜¶æ®µï¼Œè€Œå®¹å™¨åˆ™æ˜¯å¯åŠ¨æˆ–è€…æ‰§è¡Œé˜¶æ®µã€‚ å®¹å™¨åŸºäºé•œåƒå¯åŠ¨ï¼Œä¸€æ—¦å®¹å™¨å¯åŠ¨å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥ç™»å½•åˆ°å®¹å™¨ä¸­å®‰è£…è‡ªå·±éœ€è¦çš„è½¯ä»¶æˆ–è€…æœåŠ¡ã€‚ æ‰€ä»¥Dockerå®¹å™¨å°±æ˜¯ï¼š â€‹ ä¸€ä¸ªé•œåƒæ ¼å¼ï¼› â€‹ ä¸€äº›åˆ—æ ‡å‡†æ“ä½œï¼› â€‹ ä¸€ä¸ªæ‰§è¡Œç¯å¢ƒã€‚ â€‹ Dockerå€Ÿé‰´äº†æ ‡å‡†é›†è£…ç®±çš„æ¦‚å¿µã€‚æ ‡å‡†é›†è£…ç®±å°†è´§ç‰©è¿å¾€ä¸–ç•Œå„åœ°ï¼ŒDockerå°†è¿™ä¸ªæ¨¡å‹è¿ç”¨åˆ°è‡ªå·±çš„è®¾è®¡ä¸­ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼šé›†è£…ç®±è¿è¾“è´§ç‰©ï¼Œè€ŒDockerè¿è¾“è½¯ä»¶ã€‚ å’Œé›†è£…ç®±ä¸€æ ·ï¼ŒDockeråœ¨æ‰§è¡Œä¸Šè¿°æ“ä½œæ—¶ï¼Œå¹¶ä¸å…³å¿ƒå®¹å™¨ä¸­åˆ°åº•è£…äº†ä»€ä¹ˆï¼Œå®ƒä¸ç®¡æ˜¯webæœåŠ¡å™¨ï¼Œè¿˜æ˜¯æ•°æ®åº“ï¼Œæˆ–è€…æ˜¯åº”ç”¨ç¨‹åºæœåŠ¡å™¨ä»€ä¹ˆçš„ã€‚æ‰€æœ‰çš„å®¹å™¨éƒ½æŒ‰ç…§ç›¸åŒçš„æ–¹å¼å°†å†…å®¹â€œè£…è½½â€è¿›å»ã€‚ Dockerä¹Ÿä¸å…³å¿ƒä½ è¦æŠŠå®¹å™¨è¿åˆ°ä½•æ–¹ï¼šæˆ‘ä»¬å¯ä»¥åœ¨è‡ªå·±çš„ç¬”è®°æœ¬ä¸­æ„å»ºå®¹å™¨ï¼Œä¸Šä¼ åˆ°Registryï¼Œç„¶åä¸‹è½½åˆ°ä¸€ä¸ªç‰©ç†çš„æˆ–è€…è™šæ‹Ÿçš„æœåŠ¡å™¨æ¥æµ‹è¯•ï¼Œåœ¨æŠŠå®¹å™¨éƒ¨ç½²åˆ°å…·ä½“çš„ä¸»æœºä¸­ã€‚åƒæ ‡å‡†é›†è£…ç®±ä¸€æ ·ï¼ŒDockerå®¹å™¨æ–¹ä¾¿æ›¿æ¢ï¼Œå¯ä»¥å åŠ ï¼Œæ˜“äºåˆ†å‘ï¼Œå¹¶ä¸”å°½é‡é€šç”¨ã€‚ Registryï¼ˆæ³¨å†Œä¸­å¿ƒï¼‰â€‹ Dockerç”¨Registryæ¥ä¿å­˜ç”¨æˆ·æ„å»ºçš„é•œåƒã€‚Registryåˆ†ä¸ºå…¬å…±å’Œç§æœ‰ä¸¤ç§ã€‚Dockerå…¬å¸è¿è¥å…¬å…±çš„Registryå«åšDocker Hubã€‚ç”¨æˆ·å¯ä»¥åœ¨Docker Hubæ³¨å†Œè´¦å·ï¼Œåˆ†äº«å¹¶ä¿å­˜è‡ªå·±çš„é•œåƒï¼ˆè¯´æ˜ï¼šåœ¨Docker Hubä¸‹è½½é•œåƒå·¨æ…¢ï¼Œå¯ä»¥è‡ªå·±æ„å»ºç§æœ‰çš„Registryï¼‰ã€‚ â€‹ https://hub.docker.com/ Dockerå®‰è£…ä¸å¯åŠ¨å®‰è£…Dockerâ€‹ Dockerå®˜æ–¹å»ºè®®åœ¨Ubuntuä¸­å®‰è£…ï¼Œå› ä¸ºDockeræ˜¯åŸºäºUbuntuå‘å¸ƒçš„ï¼Œè€Œä¸”ä¸€èˆ¬Dockerå‡ºç°çš„é—®é¢˜Ubuntuæ˜¯æœ€å…ˆæ›´æ–°æˆ–è€…æ‰“è¡¥ä¸çš„ã€‚åœ¨å¾ˆå¤šç‰ˆæœ¬çš„CentOSä¸­æ˜¯ä¸æ”¯æŒæ›´æ–°æœ€æ–°çš„ä¸€äº›è¡¥ä¸åŒ…çš„ã€‚ â€‹ ç”±äºæˆ‘ä»¬å­¦ä¹ çš„ç¯å¢ƒéƒ½ä½¿ç”¨çš„æ˜¯CentOSï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬å°†Dockerå®‰è£…åˆ°CentOSä¸Šã€‚æ³¨æ„ï¼šè¿™é‡Œå»ºè®®å®‰è£…åœ¨CentOS7.xä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œåœ¨CentOS6.xçš„ç‰ˆæœ¬ä¸­ï¼Œå®‰è£…å‰éœ€è¦å®‰è£…å…¶ä»–å¾ˆå¤šçš„ç¯å¢ƒè€Œä¸”Dockerå¾ˆå¤šè¡¥ä¸ä¸æ”¯æŒæ›´æ–°ã€‚ â€‹ è¯·ç›´æ¥æŒ‚è½½è¯¾ç¨‹é…å¥—çš„Centos7.xé•œåƒ ï¼ˆ1ï¼‰yum åŒ…æ›´æ–°åˆ°æœ€æ–° sudo yum update ï¼ˆ2ï¼‰å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…ï¼Œ yum-util æä¾›yum-config-manageråŠŸèƒ½ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯devicemapperé©±åŠ¨ä¾èµ–çš„ sudo yum install -y yum-utils device-mapper-persistent-data lvm2 ï¼ˆ3ï¼‰è®¾ç½®yumæºä¸ºé˜¿é‡Œäº‘ sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo ï¼ˆ4ï¼‰å®‰è£…docker sudo yum install docker-ce ï¼ˆ5ï¼‰å®‰è£…åæŸ¥çœ‹dockerç‰ˆæœ¬ docker -v è®¾ç½®ustcçš„é•œåƒustcæ˜¯è€ç‰Œçš„linuxé•œåƒæœåŠ¡æä¾›è€…äº†ï¼Œè¿˜åœ¨é¥è¿œçš„ubuntu 5.04ç‰ˆæœ¬çš„æ—¶å€™å°±åœ¨ç”¨ã€‚ustcçš„dockeré•œåƒåŠ é€Ÿå™¨é€Ÿåº¦å¾ˆå¿«ã€‚ustc docker mirrorçš„ä¼˜åŠ¿ä¹‹ä¸€å°±æ˜¯ä¸éœ€è¦æ³¨å†Œï¼Œæ˜¯çœŸæ­£çš„å…¬å…±æœåŠ¡ã€‚ https://lug.ustc.edu.cn/wiki/mirrors/help/docker ç¼–è¾‘è¯¥æ–‡ä»¶ï¼š vi /etc/docker/daemon.json åœ¨è¯¥æ–‡ä»¶ä¸­è¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š { "registry-mirrors": ["https://docker.mirrors.ustc.edu.cn"] } Dockerçš„å¯åŠ¨ä¸åœæ­¢systemctlå‘½ä»¤æ˜¯ç³»ç»ŸæœåŠ¡ç®¡ç†å™¨æŒ‡ä»¤ å¯åŠ¨dockerï¼š systemctl start docker åœæ­¢dockerï¼š systemctl stop docker é‡å¯dockerï¼š systemctl restart docker æŸ¥çœ‹dockerçŠ¶æ€ï¼š systemctl status docker å¼€æœºå¯åŠ¨ï¼š systemctl enable docker æŸ¥çœ‹dockeræ¦‚è¦ä¿¡æ¯ docker info æŸ¥çœ‹dockerå¸®åŠ©æ–‡æ¡£ docker --help å¸¸ç”¨å‘½ä»¤é•œåƒç›¸å…³å‘½ä»¤æŸ¥çœ‹é•œåƒdocker images REPOSITORYï¼šé•œåƒåç§° TAGï¼šé•œåƒæ ‡ç­¾ IMAGE IDï¼šé•œåƒID CREATEDï¼šé•œåƒçš„åˆ›å»ºæ—¥æœŸï¼ˆä¸æ˜¯è·å–è¯¥é•œåƒçš„æ—¥æœŸï¼‰ SIZEï¼šé•œåƒå¤§å° è¿™äº›é•œåƒéƒ½æ˜¯å­˜å‚¨åœ¨Dockerå®¿ä¸»æœºçš„/var/lib/dockerç›®å½•ä¸‹ æœç´¢é•œåƒå¦‚æœä½ éœ€è¦ä»ç½‘ç»œä¸­æŸ¥æ‰¾éœ€è¦çš„é•œåƒï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æœç´¢ docker search é•œåƒåç§° NAMEï¼šä»“åº“åç§° DESCRIPTIONï¼šé•œåƒæè¿° STARSï¼šç”¨æˆ·è¯„ä»·ï¼Œååº”ä¸€ä¸ªé•œåƒçš„å—æ¬¢è¿ç¨‹åº¦ OFFICIALï¼šæ˜¯å¦å®˜æ–¹ AUTOMATEDï¼šè‡ªåŠ¨æ„å»ºï¼Œè¡¨ç¤ºè¯¥é•œåƒç”±Docker Hubè‡ªåŠ¨æ„å»ºæµç¨‹åˆ›å»ºçš„ æ‹‰å–é•œåƒæ‹‰å–é•œåƒå°±æ˜¯ä»ä¸­å¤®ä»“åº“ä¸­ä¸‹è½½é•œåƒåˆ°æœ¬åœ° docker pull é•œåƒåç§° ä¾‹å¦‚ï¼Œæˆ‘è¦ä¸‹è½½centos7é•œåƒ docker pull centos:7 åˆ é™¤é•œåƒæŒ‰é•œåƒIDåˆ é™¤é•œåƒ docker rmi é•œåƒID åˆ é™¤æ‰€æœ‰é•œåƒ docker rmi `docker images -q` å®¹å™¨ç›¸å…³å‘½ä»¤æŸ¥çœ‹å®¹å™¨æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ docker ps æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ docker ps â€“a æŸ¥çœ‹æœ€åä¸€æ¬¡è¿è¡Œçš„å®¹å™¨ docker ps â€“l æŸ¥çœ‹åœæ­¢çš„å®¹å™¨ docker ps -f status=exited åˆ›å»ºä¸å¯åŠ¨å®¹å™¨åˆ›å»ºå®¹å™¨å¸¸ç”¨çš„å‚æ•°è¯´æ˜ï¼š åˆ›å»ºå®¹å™¨å‘½ä»¤ï¼šdocker run -iï¼šè¡¨ç¤ºè¿è¡Œå®¹å™¨ -tï¼šè¡¨ç¤ºå®¹å™¨å¯åŠ¨åä¼šè¿›å…¥å…¶å‘½ä»¤è¡Œã€‚åŠ å…¥è¿™ä¸¤ä¸ªå‚æ•°åï¼Œå®¹å™¨åˆ›å»ºå°±èƒ½ç™»å½•è¿›å»ã€‚å³åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ã€‚ â€“name :ä¸ºåˆ›å»ºçš„å®¹å™¨å‘½åã€‚ -vï¼šè¡¨ç¤ºç›®å½•æ˜ å°„å…³ç³»ï¼ˆå‰è€…æ˜¯å®¿ä¸»æœºç›®å½•ï¼Œåè€…æ˜¯æ˜ å°„åˆ°å®¿ä¸»æœºä¸Šçš„ç›®å½•ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ªï¼våšå¤šä¸ªç›®å½•æˆ–æ–‡ä»¶æ˜ å°„ã€‚æ³¨æ„ï¼šæœ€å¥½åšç›®å½•æ˜ å°„ï¼Œåœ¨å®¿ä¸»æœºä¸Šåšä¿®æ”¹ï¼Œç„¶åå…±äº«åˆ°å®¹å™¨ä¸Šã€‚ -dï¼šåœ¨runåé¢åŠ ä¸Š-då‚æ•°,åˆ™ä¼šåˆ›å»ºä¸€ä¸ªå®ˆæŠ¤å¼å®¹å™¨åœ¨åå°è¿è¡Œï¼ˆè¿™æ ·åˆ›å»ºå®¹å™¨åä¸ä¼šè‡ªåŠ¨ç™»å½•å®¹å™¨ï¼Œå¦‚æœåªåŠ -i -tä¸¤ä¸ªå‚æ•°ï¼Œåˆ›å»ºåå°±ä¼šè‡ªåŠ¨è¿›å»å®¹å™¨ï¼‰ã€‚ -pï¼šè¡¨ç¤ºç«¯å£æ˜ å°„ï¼Œå‰è€…æ˜¯å®¿ä¸»æœºç«¯å£ï¼Œåè€…æ˜¯å®¹å™¨å†…çš„æ˜ å°„ç«¯å£ã€‚å¯ä»¥ä½¿ç”¨å¤šä¸ª-påšå¤šä¸ªç«¯å£æ˜ å°„ ï¼ˆ1ï¼‰äº¤äº’å¼æ–¹å¼åˆ›å»ºå®¹å™¨ docker run -it --name=å®¹å™¨åç§° é•œåƒåç§°:æ ‡ç­¾ /bin/bash è¿™æ—¶æˆ‘ä»¬é€šè¿‡pså‘½ä»¤æŸ¥çœ‹ï¼Œå‘ç°å¯ä»¥çœ‹åˆ°å¯åŠ¨çš„å®¹å™¨ï¼ŒçŠ¶æ€ä¸ºå¯åŠ¨çŠ¶æ€ é€€å‡ºå½“å‰å®¹å™¨ exit ï¼ˆ2ï¼‰å®ˆæŠ¤å¼æ–¹å¼åˆ›å»ºå®¹å™¨ï¼š docker run -di --name=å®¹å™¨åç§° é•œåƒåç§°:æ ‡ç­¾ ç™»å½•å®ˆæŠ¤å¼å®¹å™¨æ–¹å¼ï¼š docker exec -it å®¹å™¨åç§° (æˆ–è€…å®¹å™¨ID) /bin/bash åœæ­¢ä¸å¯åŠ¨å®¹å™¨åœæ­¢å®¹å™¨ï¼š docker stop å®¹å™¨åç§°ï¼ˆæˆ–è€…å®¹å™¨IDï¼‰ å¯åŠ¨å®¹å™¨ï¼š docker start å®¹å™¨åç§°ï¼ˆæˆ–è€…å®¹å™¨IDï¼‰ æ–‡ä»¶æ‹·è´å¦‚æœæˆ‘ä»¬éœ€è¦å°†æ–‡ä»¶æ‹·è´åˆ°å®¹å™¨å†…å¯ä»¥ä½¿ç”¨cpå‘½ä»¤ docker cp éœ€è¦æ‹·è´çš„æ–‡ä»¶æˆ–ç›®å½• å®¹å™¨åç§°:å®¹å™¨ç›®å½• ä¹Ÿå¯ä»¥å°†æ–‡ä»¶ä»å®¹å™¨å†…æ‹·è´å‡ºæ¥ docker cp å®¹å™¨åç§°:å®¹å™¨ç›®å½• éœ€è¦æ‹·è´çš„æ–‡ä»¶æˆ–ç›®å½• ç›®å½•æŒ‚è½½æˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºå®¹å™¨çš„æ—¶å€™ï¼Œå°†å®¿ä¸»æœºçš„ç›®å½•ä¸å®¹å™¨å†…çš„ç›®å½•è¿›è¡Œæ˜ å°„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹å®¿ä¸»æœºæŸä¸ªç›®å½•çš„æ–‡ä»¶ä»è€Œå»å½±å“å®¹å™¨ã€‚åˆ›å»ºå®¹å™¨ æ·»åŠ -vå‚æ•° åè¾¹ä¸º å®¿ä¸»æœºç›®å½•:å®¹å™¨ç›®å½•ï¼Œä¾‹å¦‚ï¼š docker run -di -v /usr/local/myhtml:/usr/local/myhtml --name=mycentos3 centos:7 å¦‚æœä½ å…±äº«çš„æ˜¯å¤šçº§çš„ç›®å½•ï¼Œå¯èƒ½ä¼šå‡ºç°æƒé™ä¸è¶³çš„æç¤ºã€‚ è¿™æ˜¯å› ä¸ºCentOS7ä¸­çš„å®‰å…¨æ¨¡å—selinuxæŠŠæƒé™ç¦æ‰äº†ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å‚æ•° â€“privileged=true æ¥è§£å†³æŒ‚è½½çš„ç›®å½•æ²¡æœ‰æƒé™çš„é—®é¢˜ æŸ¥çœ‹å®¹å™¨IPåœ°å€æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å®¹å™¨è¿è¡Œçš„å„ç§æ•°æ® docker inspect å®¹å™¨åç§°ï¼ˆå®¹å™¨IDï¼‰ ä¹Ÿå¯ä»¥ç›´æ¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ç›´æ¥è¾“å‡ºIPåœ°å€ docker inspect --format='{{.NetworkSettings.IPAddress}}' å®¹å™¨åç§°ï¼ˆå®¹å™¨IDï¼‰ åˆ é™¤å®¹å™¨åˆ é™¤æŒ‡å®šçš„å®¹å™¨ï¼š docker rm å®¹å™¨åç§°ï¼ˆå®¹å™¨IDï¼‰ åº”ç”¨éƒ¨ç½²MySQLéƒ¨ç½²ï¼ˆ1ï¼‰æ‹‰å–mysqlé•œåƒ docker pull centos/mysql-57-centos7 ï¼ˆ2ï¼‰åˆ›å»ºå®¹å™¨ docker run -di --name=tensquare_mysql -p 33306:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql -p ä»£è¡¨ç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸º å®¿ä¸»æœºæ˜ å°„ç«¯å£:å®¹å™¨è¿è¡Œç«¯å£ -e ä»£è¡¨æ·»åŠ ç¯å¢ƒå˜é‡ MYSQL_ROOT_PASSWORD æ˜¯rootç”¨æˆ·çš„ç™»é™†å¯†ç  ï¼ˆ3ï¼‰è¿œç¨‹ç™»å½•mysql è¿æ¥å®¿ä¸»æœºçš„IP ,æŒ‡å®šç«¯å£ä¸º33306 tomcatéƒ¨ç½²ï¼ˆ1ï¼‰æ‹‰å–é•œåƒ docker pull tomcat:7-jre7 ï¼ˆ2ï¼‰åˆ›å»ºå®¹å™¨ åˆ›å»ºå®¹å™¨ -pè¡¨ç¤ºåœ°å€æ˜ å°„ docker run -di --name=mytomcat -p 9000:8080 -v /usr/local/webapps:/usr/local/tomcat/webapps tomcat:7-jre7 Nginxéƒ¨ç½²ï¼ˆ1ï¼‰æ‹‰å–é•œåƒ docker pull nginx ï¼ˆ2ï¼‰åˆ›å»ºNginxå®¹å™¨ docker run -di --name=mynginx -p 80:80 nginx Rediséƒ¨ç½²ï¼ˆ1ï¼‰æ‹‰å–é•œåƒ docker pull redis ï¼ˆ2ï¼‰åˆ›å»ºå®¹å™¨ docker run -di --name=myredis -p 6379:6379 redis è¿ç§»ä¸å¤‡ä»½å®¹å™¨ä¿å­˜ä¸ºé•œåƒæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å°†å®¹å™¨ä¿å­˜ä¸ºé•œåƒ docker commit mynginx mynginx_i é•œåƒå¤‡ä»½æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å°†é•œåƒä¿å­˜ä¸ºtar æ–‡ä»¶ docker save -o mynginx.tar mynginx_i é•œåƒæ¢å¤ä¸è¿ç§»é¦–å…ˆæˆ‘ä»¬å…ˆåˆ é™¤æ‰mynginx_imgé•œåƒ ç„¶åæ‰§è¡Œæ­¤å‘½ä»¤è¿›è¡Œæ¢å¤ docker load -i mynginx.tar -i è¾“å…¥çš„æ–‡ä»¶ æ‰§è¡Œåå†æ¬¡æŸ¥çœ‹é•œåƒï¼Œå¯ä»¥çœ‹åˆ°é•œåƒå·²ç»æ¢å¤ Dockerfile Dockerfileæ–‡ä»¶è¯¦è§£ ä»€ä¹ˆæ˜¯DockerfileDockerfileæ˜¯ç”±ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬ï¼Œè¿™äº›å‘½ä»¤åº”ç”¨äºåŸºç¡€é•œåƒå¹¶æœ€ç»ˆåˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚ å¯¹äºå¼€å‘äººå‘˜ï¼šå¯ä»¥ä¸ºå¼€å‘å›¢é˜Ÿæä¾›ä¸€ä¸ªå®Œå…¨ä¸€è‡´çš„å¼€å‘ç¯å¢ƒï¼› å¯¹äºæµ‹è¯•äººå‘˜ï¼šå¯ä»¥ç›´æ¥æ‹¿å¼€å‘æ—¶æ‰€æ„å»ºçš„é•œåƒæˆ–è€…é€šè¿‡Dockerfileæ–‡ä»¶æ„å»ºä¸€ä¸ªæ–°çš„é•œåƒå¼€å§‹å·¥ä½œäº†ï¼› å¯¹äºè¿ç»´äººå‘˜ï¼šåœ¨éƒ¨ç½²æ—¶ï¼Œå¯ä»¥å®ç°åº”ç”¨çš„æ— ç¼ç§»æ¤ã€‚ å¸¸ç”¨å‘½ä»¤ å‘½ä»¤ ä½œç”¨ FROM image_name:tag å®šä¹‰äº†ä½¿ç”¨å“ªä¸ªåŸºç¡€é•œåƒå¯åŠ¨æ„å»ºæµç¨‹ MAINTAINER user_name å£°æ˜é•œåƒçš„åˆ›å»ºè€… ENV key value è®¾ç½®ç¯å¢ƒå˜é‡ (å¯ä»¥å†™å¤šæ¡) RUN command æ˜¯Dockerfileçš„æ ¸å¿ƒéƒ¨åˆ†(å¯ä»¥å†™å¤šæ¡) ADD source_dir/file dest_dir/file å°†å®¿ä¸»æœºçš„æ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨å†…ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œå°†ä¼šåœ¨å¤åˆ¶åè‡ªåŠ¨è§£å‹ COPY source_dir/file dest_dir/file å’ŒADDç›¸ä¼¼ï¼Œä½†æ˜¯å¦‚æœæœ‰å‹ç¼©æ–‡ä»¶å¹¶ä¸èƒ½è§£å‹ WORKDIR path_dir è®¾ç½®å·¥ä½œç›®å½• ä½¿ç”¨è„šæœ¬åˆ›å»ºé•œåƒæ­¥éª¤ï¼š ï¼ˆ1ï¼‰åˆ›å»ºç›®å½• mkdir â€“p /usr/local/dockerjdk8 ï¼ˆ2ï¼‰ä¸‹è½½jdk-8u171-linux-x64.tar.gzå¹¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆè™šæ‹Ÿæœºï¼‰ä¸­çš„/usr/local/dockerjdk8ç›®å½• ï¼ˆ3ï¼‰åˆ›å»ºæ–‡ä»¶Dockerfile vi Dockerfile #ä¾èµ–é•œåƒåç§°å’ŒID FROM centos:7 #æŒ‡å®šé•œåƒåˆ›å»ºè€…ä¿¡æ¯ MAINTAINER ITCAST #åˆ‡æ¢å·¥ä½œç›®å½• WORKDIR /usr RUN mkdir /usr/local/java #ADD æ˜¯ç›¸å¯¹è·¯å¾„jar,æŠŠjavaæ·»åŠ åˆ°å®¹å™¨ä¸­ ADD jdk-8u171-linux-x64.tar.gz /usr/local/java/ #é…ç½®javaç¯å¢ƒå˜é‡ ENV JAVA_HOME /usr/local/java/jdk1.8.0_171 ENV JRE_HOME $JAVA_HOME/jre ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib:$CLASSPATH ENV PATH $JAVA_HOME/bin:$PATH ï¼ˆ4ï¼‰æ‰§è¡Œå‘½ä»¤æ„å»ºé•œåƒ docker build -t='jdk1.8' . æ³¨æ„åè¾¹çš„ç©ºæ ¼å’Œç‚¹ï¼Œä¸è¦çœç•¥ ï¼ˆ5ï¼‰æŸ¥çœ‹é•œåƒæ˜¯å¦å»ºç«‹å®Œæˆ docker images Dockerç§æœ‰ä»“åº“ç§æœ‰ä»“åº“æ­å»ºä¸é…ç½®ï¼ˆ1ï¼‰æ‹‰å–ç§æœ‰ä»“åº“é•œåƒï¼ˆæ­¤æ­¥çœç•¥ï¼‰ docker pull registry ï¼ˆ2ï¼‰å¯åŠ¨ç§æœ‰ä»“åº“å®¹å™¨ docker run -di --name=registry -p 5000:5000 registry ï¼ˆ3ï¼‰æ‰“å¼€æµè§ˆå™¨ è¾“å…¥åœ°å€http://192.168.184.141:5000/v2/_catalogçœ‹åˆ°`{"repositories":[]}` è¡¨ç¤ºç§æœ‰ä»“åº“æ­å»ºæˆåŠŸå¹¶ä¸”å†…å®¹ä¸ºç©º ï¼ˆ4ï¼‰ä¿®æ”¹daemon.json vi /etc/docker/daemon.json æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œä¿å­˜é€€å‡ºã€‚ {"insecure-registries":["192.168.184.141:5000"]} æ­¤æ­¥ç”¨äºè®© dockerä¿¡ä»»ç§æœ‰ä»“åº“åœ°å€ ï¼ˆ5ï¼‰é‡å¯docker æœåŠ¡ systemctl restart docker é•œåƒä¸Šä¼ è‡³ç§æœ‰ä»“åº“ï¼ˆ1ï¼‰æ ‡è®°æ­¤é•œåƒä¸ºç§æœ‰ä»“åº“çš„é•œåƒ docker tag jdk1.8 192.168.184.141:5000/jdk1.8 ï¼ˆ2ï¼‰å†æ¬¡å¯åŠ¨ç§æœå®¹å™¨ docker start registry ï¼ˆ3ï¼‰ä¸Šä¼ æ ‡è®°çš„é•œåƒ docker push 192.168.184.141:5000/jdk1.8 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>è¿ç»´</tag>
        <tag>åç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoæ“ä½œæ‰‹å†Œ]]></title>
    <url>%2F2020%2F10%2F23%2Fhexo-manual%2F</url>
    <content type="text"><![CDATA[A fast, simple &amp; powerful blog framework å®˜æ–¹ç½‘ç«™ï¼šhttps://hexo.io/zh-cn/docs/configuration å¸¸ç”¨å‘½ä»¤æ¸…é™¤ç¼“å­˜æ–‡ä»¶ (db.json) å’Œå·²ç”Ÿæˆçš„é™æ€æ–‡ä»¶ (public) $ hexo clean ç”Ÿæˆé™æ€æ–‡ä»¶ $ hexo generate -d, --deploy æ–‡ä»¶ç”Ÿæˆåç«‹å³éƒ¨ç½²ç½‘ç«™ -w, --watch ç›‘è§†æ–‡ä»¶å˜åŠ¨ éƒ¨ç½² hexo d å¯åŠ¨æœåŠ¡å™¨ã€‚é»˜è®¤æƒ…å†µä¸‹,è®¿é—®ç½‘å€ä¸º: http://localhost:4000/ $ hexo server -p, --port é‡è®¾ç«¯å£ -s, --static åªä½¿ç”¨é™æ€æ–‡ä»¶ -l, --log å¯åŠ¨æ—¥è®°è®°å½•ï¼Œä½¿ç”¨è¦†ç›–è®°å½•æ ¼å¼ å‘è¡¨è‰ç¨¿ $ hexo publish [layout] &lt;filename&gt; æ˜¾ç¤ºè‰ç¨¿ $ hexo --draft è‡ªå®šä¹‰ CWDï¼ˆCurrent working directoryï¼‰ $ hexo --cwd /path/to/cwd åˆ›å»ºæ–‡æ¡£ hexo new [layout] &lt;title&gt; ex: hexo new inner demo01 hexo new outer demo01 hexo new feeling demo01 draft--&gt;public hexo publish [layout] &lt;title&gt; ex: hexo new draft demo01 hexo publish inner &lt;title&gt; é¡µçœ‰è¯´æ˜title: Hexoæ“ä½œæ‰‹å†Œ //æ ‡é¢˜ author: 571 //ä½œè€… series: INNER //æ‰€å±ç³»åˆ— categories: INNER //æ‰€å±ç±»åˆ« comments: true //æ˜¯å¦å¼€å¯è¯„è®ºï¼š true å¼€å¯ img: /cover/abc.jpg //å°é¢å›¾ top: false //æ˜¯å¦ç½®é¡¶ true æ˜¯ cover: false //æ˜¯å¦è½®æ’­ true æ˜¯ tags: //æ ‡ç­¾ - inner - æ‰‹å†Œ date: 2020-05-14 21:58:38 //åˆ›å»ºæ—¶é—´ updated: 2020-05-14 21:58:38 //ä¿®æ”¹æ—¶é—´ åˆ›å»ºæ–‡ç« æ–‡ä»¶åˆ›å»ºæ–‡ä»¶å‘½åæ ¼å¼ï¼šå°å†™ã€ä¸­æ éš”å¼€å•è¯ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ‰‹å†Œ</category>
      </categories>
      <tags>
        <tag>æ‰‹å†Œ</tag>
        <tag>åšå®¢</tag>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux Installs]]></title>
    <url>%2F2020%2F10%2F23%2Flinux-installs%2F</url>
    <content type="text"><![CDATA[Linux è½¯ä»¶å·¥å…·å®‰è£… å®‰è£…Javaé€šè¿‡yumæ–¹å¼å®‰è£…JavaæŸ¥çœ‹JDKæ˜¯å¦å·²å®‰è£…# yum list installed | grep java è‹¥å·²ç»å®‰è£…äº†JDKï¼Œå¦‚ä½•å¸è½½Javaç¯å¢ƒï¼Ÿ å¸è½½JDKç›¸å…³æ–‡ä»¶ï¼š# yum -y remove java-1.7.0-openjdk* å¸è½½tzdata-javaï¼š# yum -y remove tzdata-java.noarch æ³¨ï¼šâ€œ*â€è¡¨ç¤ºå¸è½½æ‰java 1.7.0çš„æ‰€æœ‰openjdkç›¸å…³æ–‡ä»¶æŸ¥çœ‹yumåº“ä¸­çš„Javaå®‰è£…åŒ…# yum -y list java* å®‰è£…Javaå®‰è£…åŒ… ä»¥yumåº“ä¸­java-1.8.0ä¸ºä¾‹ï¼š # yum -y install java-1.8.0-openjdk* æ³¨ï¼šâ€œ*â€è¡¨ç¤ºå°†java-1.8.0çš„æ‰€æœ‰ç›¸å…³Javaç¨‹åºéƒ½å®‰è£…ä¸Š æŸ¥çœ‹åˆšåˆšå®‰è£…ç‰ˆæœ¬# java -version ç¯å¢ƒå˜é‡é…ç½®1.ä¿®æ”¹é…ç½®æ–‡ä»¶ # vim /etc/profile # export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk # export CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar # export PATH=$PATH:$JAVA_HOME/bin 2.ç”Ÿæ•ˆä¿®æ”¹ # source /etc/profile é€šè¿‡å‹ç¼©åŒ…å®‰è£…Java####å‡†å¤‡å·¥ä½œï¼š jdk-8u11-linux-x64.tar.gzä¸‹è½½åœ°å€ï¼šhttps://pan.baidu.com/s/1smNHABN (psï¼šä¹Ÿå¯åœ¨å®˜ç½‘ä¸‹è½½æœ€æ–°jdk:http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html) shellåœ¨windowsä¸‹è½½å®Œæˆjdkåï¼Œé€šè¿‡shellå‘é€åˆ°Linuxä¸Š ç™»å½•Linuxï¼Œåˆ‡æ¢åˆ°rootç”¨æˆ·# su root ---è·å–rootç”¨æˆ·æƒé™ï¼Œå½“å‰å·¥ä½œç›®å½•ä¸å˜(éœ€è¦rootå¯†ç ) æˆ–è€… # sudo -i ---ä¸éœ€è¦rootå¯†ç ç›´æ¥åˆ‡æ¢æˆrootï¼ˆéœ€è¦å½“å‰ç”¨æˆ·å¯†ç ï¼‰ åœ¨usrç›®å½•ä¸‹å»ºç«‹Javaå®‰è£…ç›®å½•# cd /usr/local/src/ # mkdir java è§£å‹jdkåˆ°å½“å‰ç›®å½•,å¾—åˆ°æ–‡ä»¶å¤¹ jdk1.8.0_11# tar -zxvf jdk-8u11-linux-x64.tar.gz è§£å‹å®Œå»ºç«‹ä¸€ä¸ªé“¾æ¥ä»¥èŠ‚çœç›®å½•é•¿åº¦# ln -s /usr/local/src/java/jdk1.8.0_11/ /usr/local/src/jdk ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œé…ç½®ç¯å¢ƒå˜é‡# vim /etc/profile åœ¨æ–‡æœ«æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š # JAVA_HOME=/usr/local/src/jdk # CLASSPATH=$JAVA_HOME/lib/ # PATH=$PATH:$JAVA_HOME/bin # export PATH JAVA_HOME CLASSPATH é‡å¯æœºå™¨æˆ–æ‰§è¡Œå‘½ä»¤# sudo shutdown -r now æŸ¥çœ‹åˆšåˆšå®‰è£…ç‰ˆæœ¬# java -version å®‰è£…Mavenåœ¨çº¿ä¸‹è½½å®‰è£…å®‰è£…wgetå‘½ä»¤# yum -y install wget ä¸‹è½½mavenå®‰è£…åŒ…# cd /usr/local/src/ # wget http://mirrors.cnnic.cn/apache/maven/maven-3/3.5.4/binaries/apache-maven-3.5.4-bin.tar.gz è§£å‹mavenå®‰è£…åŒ…# tar -zxvf apache-maven-3.5.4-bin.tar.gz é…ç½®maven# vi /etc/profile åœ¨é…ç½®æ–‡ä»¶é…ç½® # export MAVEN_HOME=/usr/local/src/apache-maven-3.5.4 # export PATH=$MAVEN_HOME/bin:$PATH é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ # source /etc/profile æŸ¥çœ‹maven# mvn -version å®‰è£…åŒ…å®‰è£… Mavenä¸‹è½½åœ°å€ å®‰è£…Nexus3å‡†å¤‡å·¥ä½œ å®‰è£…Java å®‰è£…Maven åœ¨çº¿ä¸‹è½½å®‰è£…åœ¨çº¿ä¸‹è½½å®‰è£…ä¼ é€é—¨ å®‰è£…åŒ…å®‰è£… Nexusä¸‹è½½åœ°å€1Nexusä¸‹è½½åœ°å€2 dockerå®‰è£…æºç ä¸‹è½½ä¸åŠ¨,æ— è€æƒ³åˆ°æ­¤æ³•,æ¨è Dockerå®‰è£…ä¼ é€é—¨ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>è¿ç»´</tag>
        <tag>åç«¯</tag>
        <tag>linux</tag>
      </tags>
  </entry>
</search>

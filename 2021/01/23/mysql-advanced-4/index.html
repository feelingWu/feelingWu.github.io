<!DOCTYPE HTML>
<html lang="zh-Hans">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="MySQLæ•°æ®åº“ä¼˜åŒ–ä¹‹ç»„åˆæ‹³(å››), TANGUO STORE">
    <meta name="description" content="
éåŸåˆ›å›¾æ–‡,å›¾æ–‡æ¥æºäºé»‘é©¬å®˜ç½‘,æ­¤å¤„ä»…ä½œä¸ºå¤‡ä»½å­¦ä¹ 


MySQLæ•°æ®åº“ä¼˜åŒ–æ€»æ¦‚


ç»„åˆæ‹³ï¼ˆä¸€ï¼‰
ç»„åˆæ‹³ï¼ˆäºŒï¼‰
ç»„åˆæ‹³ï¼ˆä¸‰ï¼‰
ğŸš©ç»„åˆæ‹³ï¼ˆå››ï¼‰




ç´¢å¼•
ä½“ç³»ç»“æ„
åº”ç”¨ä¼˜åŒ–
MySQL å¸¸ç”¨å·¥å…·


è§†å›¾
å­˜å‚¨å¼•æ“
æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–
M">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>MySQLæ•°æ®åº“ä¼˜åŒ–ä¹‹ç»„åˆæ‹³(å››) | TANGUO STORE</title>
    <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/medias/caihong32.ico">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
    
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/cais.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">TANGUO STORE</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">

      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>Contact</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/about">
          
          <i class="fas fa-user-circle" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>æµ‹è¯•æ ‡é¢˜1</span>
        </a>
      </li>
      
      <li>
        <a href="/archives">
          
          <i class="fas fa-archive" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>æµ‹è¯•æ ‡é¢˜2</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/cais.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">TANGUO STORE</div>
        <div class="logo-desc">
            
            Life was like a box of chocolates, you never know what youâ€™re gonna get.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-comments"></i>
			
			Contact
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>   
				
                  <a href="/about " style="margin-left:75px";>
				  
				   <i class="fa fas fa-user-circle" style="position: absolute;left:50px" ></i>
			      
		          <span>æµ‹è¯•æ ‡é¢˜1</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/archives " style="margin-left:75px";>
				  
				   <i class="fa fas fa-archive" style="position: absolute;left:50px" ></i>
			      
		          <span>æµ‹è¯•æ ‡é¢˜2</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/feelingWu/feelingWu.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/feelingWu/feelingWu.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('è¯·è¾“å…¥è®¿é—®æœ¬æ–‡ç« çš„å¯†ç ')).toString(CryptoJS.enc.Hex)) {
                alert('å¯†ç é”™è¯¯ï¼Œå°†è¿”å›ä¸»é¡µï¼');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/cover/')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        MySQLæ•°æ®åº“ä¼˜åŒ–ä¹‹ç»„åˆæ‹³(å››)
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/MySQLæ•°æ®åº“ä¼˜åŒ–ä¹‹ç»„åˆæ‹³-å››/">
                                <span class="chip bg-color">MySQLæ•°æ®åº“ä¼˜åŒ–ä¹‹ç»„åˆæ‹³(å››)</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/æ•°æ®åº“/" class="post-category">
                                æ•°æ®åº“
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2021-01-23
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                        3.8k
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="far fa-clock fa-fw"></i>Read Times:&nbsp;&nbsp;
                        14 Min
                    </div>
                    
                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <blockquote>
<p>éåŸåˆ›å›¾æ–‡,å›¾æ–‡æ¥æºäºé»‘é©¬å®˜ç½‘,æ­¤å¤„ä»…ä½œä¸ºå¤‡ä»½å­¦ä¹ </p>
</blockquote>
<a id="more"></a>
<h2 id="MySQLæ•°æ®åº“ä¼˜åŒ–æ€»æ¦‚"><a href="#MySQLæ•°æ®åº“ä¼˜åŒ–æ€»æ¦‚" class="headerlink" title="MySQLæ•°æ®åº“ä¼˜åŒ–æ€»æ¦‚"></a>MySQLæ•°æ®åº“ä¼˜åŒ–æ€»æ¦‚</h2><table>
<thead>
<tr>
<th>ç»„åˆæ‹³ï¼ˆä¸€ï¼‰</th>
<th>ç»„åˆæ‹³ï¼ˆäºŒï¼‰</th>
<th>ç»„åˆæ‹³ï¼ˆä¸‰ï¼‰</th>
<th>ğŸš©ç»„åˆæ‹³ï¼ˆå››ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç´¢å¼•</td>
<td>ä½“ç³»ç»“æ„</td>
<td>åº”ç”¨ä¼˜åŒ–</td>
<td>MySQL å¸¸ç”¨å·¥å…·</td>
</tr>
<tr>
<td>è§†å›¾</td>
<td>å­˜å‚¨å¼•æ“</td>
<td>æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–</td>
<td>MySQL æ—¥å¿—</td>
</tr>
<tr>
<td>å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</td>
<td>ä¼˜åŒ–SQLæ­¥éª¤</td>
<td>å†…å­˜ç®¡ç†åŠä¼˜åŒ–</td>
<td>MySQL ä¸»ä»å¤åˆ¶</td>
</tr>
<tr>
<td>è§¦å‘å™¨</td>
<td>ç´¢å¼•ä½¿ç”¨</td>
<td>MySQLé”é—®é¢˜</td>
<td></td>
</tr>
<tr>
<td></td>
<td>SQLä¼˜åŒ–</td>
<td>å¸¸ç”¨SQLæŠ€å·§</td>
</tr>
</tbody>
</table>
<h3 id="1-MySqlä¸­å¸¸ç”¨å·¥å…·"><a href="#1-MySqlä¸­å¸¸ç”¨å·¥å…·" class="headerlink" title="1. MySqlä¸­å¸¸ç”¨å·¥å…·"></a>1. MySqlä¸­å¸¸ç”¨å·¥å…·</h3><h4 id="1-1-mysql"><a href="#1-1-mysql" class="headerlink" title="1.1 mysql"></a>1.1 mysql</h4><p>è¯¥mysqlä¸æ˜¯æŒ‡mysqlæœåŠ¡ï¼Œè€Œæ˜¯æŒ‡mysqlçš„å®¢æˆ·ç«¯å·¥å…·ã€‚</p>
<p>è¯­æ³• ï¼š</p>
<pre><code>mysql [options] [database]
</code></pre><h5 id="1-1-1-è¿æ¥é€‰é¡¹"><a href="#1-1-1-è¿æ¥é€‰é¡¹" class="headerlink" title="1.1.1 è¿æ¥é€‰é¡¹"></a>1.1.1 è¿æ¥é€‰é¡¹</h5><pre><code>å‚æ•° ï¼š 
    -u, --user=name            æŒ‡å®šç”¨æˆ·å
    -p, --password[=name]    æŒ‡å®šå¯†ç 
    -h, --host=name            æŒ‡å®šæœåŠ¡å™¨IPæˆ–åŸŸå
    -P, --port=#            æŒ‡å®šè¿æ¥ç«¯å£

ç¤ºä¾‹ ï¼š
    mysql -h 127.0.0.1 -P 3306 -u root -p

    mysql -h127.0.0.1 -P3306 -uroot -p2143

</code></pre><h5 id="1-1-2-æ‰§è¡Œé€‰é¡¹"><a href="#1-1-2-æ‰§è¡Œé€‰é¡¹" class="headerlink" title="1.1.2 æ‰§è¡Œé€‰é¡¹"></a>1.1.2 æ‰§è¡Œé€‰é¡¹</h5><pre><code>-e, --execute=name        æ‰§è¡ŒSQLè¯­å¥å¹¶é€€å‡º
</code></pre><p>æ­¤é€‰é¡¹å¯ä»¥åœ¨Mysqlå®¢æˆ·ç«¯æ‰§è¡ŒSQLè¯­å¥ï¼Œè€Œä¸ç”¨è¿æ¥åˆ°MySQLæ•°æ®åº“å†æ‰§è¡Œï¼Œå¯¹äºä¸€äº›æ‰¹å¤„ç†è„šæœ¬ï¼Œè¿™ç§æ–¹å¼å°¤å…¶æ–¹ä¾¿ã€‚</p>
<pre><code>ç¤ºä¾‹ï¼š
    mysql -uroot -p2143 db01 -e "select * from tb_book";
</code></pre><p><img src="/2021/01/23/mysql-advanced-4/1555325632715.png" alt="1555325632715"> </p>
<h4 id="1-2-mysqladmin"><a href="#1-2-mysqladmin" class="headerlink" title="1.2 mysqladmin"></a>1.2 mysqladmin</h4><p>mysqladmin æ˜¯ä¸€ä¸ªæ‰§è¡Œç®¡ç†æ“ä½œçš„å®¢æˆ·ç«¯ç¨‹åºã€‚å¯ä»¥ç”¨å®ƒæ¥æ£€æŸ¥æœåŠ¡å™¨çš„é…ç½®å’Œå½“å‰çŠ¶æ€ã€åˆ›å»ºå¹¶åˆ é™¤æ•°æ®åº“ç­‰ã€‚</p>
<p>å¯ä»¥é€šè¿‡ ï¼š mysqladmin â€“help  æŒ‡ä»¤æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£</p>
<p><img src="/2021/01/23/mysql-advanced-4/1555326108697.png" alt="1555326108697"> </p>
<pre><code>ç¤ºä¾‹ ï¼š
    mysqladmin -uroot -p2143 create 'test01';  
    mysqladmin -uroot -p2143 drop 'test01';
    mysqladmin -uroot -p2143 version;

</code></pre><h4 id="1-3-mysqlbinlog"><a href="#1-3-mysqlbinlog" class="headerlink" title="1.3 mysqlbinlog"></a>1.3 mysqlbinlog</h4><p>ç”±äºæœåŠ¡å™¨ç”Ÿæˆçš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ä»¥äºŒè¿›åˆ¶æ ¼å¼ä¿å­˜ï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦æ£€æŸ¥è¿™äº›æ–‡æœ¬çš„æ–‡æœ¬æ ¼å¼ï¼Œå°±ä¼šä½¿ç”¨åˆ°mysqlbinlog æ—¥å¿—ç®¡ç†å·¥å…·ã€‚</p>
<p>è¯­æ³• ï¼š</p>
<pre><code>mysqlbinlog [options]  log-files1 log-files2 ...

é€‰é¡¹ï¼š

    -d, --database=name : æŒ‡å®šæ•°æ®åº“åç§°ï¼Œåªåˆ—å‡ºæŒ‡å®šçš„æ•°æ®åº“ç›¸å…³æ“ä½œã€‚

    -o, --offset=# : å¿½ç•¥æ‰æ—¥å¿—ä¸­çš„å‰nè¡Œå‘½ä»¤ã€‚

    -r,--result-file=name : å°†è¾“å‡ºçš„æ–‡æœ¬æ ¼å¼æ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ã€‚

    -s, --short-form : æ˜¾ç¤ºç®€å•æ ¼å¼ï¼Œ çœç•¥æ‰ä¸€äº›ä¿¡æ¯ã€‚

    --start-datatime=date1  --stop-datetime=date2 : æŒ‡å®šæ—¥æœŸé—´éš”å†…çš„æ‰€æœ‰æ—¥å¿—ã€‚

    --start-position=pos1 --stop-position=pos2 : æŒ‡å®šä½ç½®é—´éš”å†…çš„æ‰€æœ‰æ—¥å¿—ã€‚
</code></pre><h4 id="1-4-mysqldump"><a href="#1-4-mysqldump" class="headerlink" title="1.4 mysqldump"></a>1.4 mysqldump</h4><p>mysqldump å®¢æˆ·ç«¯å·¥å…·ç”¨æ¥å¤‡ä»½æ•°æ®åº“æˆ–åœ¨ä¸åŒæ•°æ®åº“ä¹‹é—´è¿›è¡Œæ•°æ®è¿ç§»ã€‚å¤‡ä»½å†…å®¹åŒ…å«åˆ›å»ºè¡¨ï¼ŒåŠæ’å…¥è¡¨çš„SQLè¯­å¥ã€‚</p>
<p>è¯­æ³• ï¼š</p>
<pre><code>mysqldump [options] db_name [tables]

mysqldump [options] --database/-B db1 [db2 db3...]

mysqldump [options] --all-databases/-A
</code></pre><h5 id="1-4-1-è¿æ¥é€‰é¡¹"><a href="#1-4-1-è¿æ¥é€‰é¡¹" class="headerlink" title="1.4.1 è¿æ¥é€‰é¡¹"></a>1.4.1 è¿æ¥é€‰é¡¹</h5><pre><code>å‚æ•° ï¼š 
    -u, --user=name            æŒ‡å®šç”¨æˆ·å
    -p, --password[=name]    æŒ‡å®šå¯†ç 
    -h, --host=name            æŒ‡å®šæœåŠ¡å™¨IPæˆ–åŸŸå
    -P, --port=#            æŒ‡å®šè¿æ¥ç«¯å£
</code></pre><h5 id="1-4-2-è¾“å‡ºå†…å®¹é€‰é¡¹"><a href="#1-4-2-è¾“å‡ºå†…å®¹é€‰é¡¹" class="headerlink" title="1.4.2 è¾“å‡ºå†…å®¹é€‰é¡¹"></a>1.4.2 è¾“å‡ºå†…å®¹é€‰é¡¹</h5><pre><code>å‚æ•°ï¼š
    --add-drop-database        åœ¨æ¯ä¸ªæ•°æ®åº“åˆ›å»ºè¯­å¥å‰åŠ ä¸Š Drop database è¯­å¥
    --add-drop-table        åœ¨æ¯ä¸ªè¡¨åˆ›å»ºè¯­å¥å‰åŠ ä¸Š Drop table è¯­å¥ , é»˜è®¤å¼€å¯ ; ä¸å¼€å¯ (--skip-add-drop-table)

    -n, --no-create-db        ä¸åŒ…å«æ•°æ®åº“çš„åˆ›å»ºè¯­å¥
    -t, --no-create-info    ä¸åŒ…å«æ•°æ®è¡¨çš„åˆ›å»ºè¯­å¥
    -d --no-data            ä¸åŒ…å«æ•°æ®

     -T, --tab=name            è‡ªåŠ¨ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼šä¸€ä¸ª.sqlæ–‡ä»¶ï¼Œåˆ›å»ºè¡¨ç»“æ„çš„è¯­å¥ï¼›
                             ä¸€ä¸ª.txtæ–‡ä»¶ï¼Œæ•°æ®æ–‡ä»¶ï¼Œç›¸å½“äºselect into outfile  
</code></pre><pre><code>ç¤ºä¾‹ ï¼š 
    mysqldump -uroot -p2143 db01 tb_book --add-drop-database --add-drop-table &gt; a

    mysqldump -uroot -p2143 -T /tmp test city
</code></pre><p><img src="/2021/01/23/mysql-advanced-4/1555501806693.png" alt="1555501806693"> </p>
<h4 id="1-5-mysqlimport-source"><a href="#1-5-mysqlimport-source" class="headerlink" title="1.5 mysqlimport/source"></a>1.5 mysqlimport/source</h4><p>mysqlimport æ˜¯å®¢æˆ·ç«¯æ•°æ®å¯¼å…¥å·¥å…·ï¼Œç”¨æ¥å¯¼å…¥mysqldump åŠ  -T å‚æ•°åå¯¼å‡ºçš„æ–‡æœ¬æ–‡ä»¶ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>mysqlimport [options]  db_name  textfile1  [textfile2...]
</code></pre><p>ç¤ºä¾‹ï¼š</p>
<pre><code>mysqlimport -uroot -p2143 test /tmp/city.txt
</code></pre><p>å¦‚æœéœ€è¦å¯¼å…¥sqlæ–‡ä»¶,å¯ä»¥ä½¿ç”¨mysqlä¸­çš„source æŒ‡ä»¤ : </p>
<pre><code>source /root/tb_book.sql
</code></pre><h4 id="1-6-mysqlshow"><a href="#1-6-mysqlshow" class="headerlink" title="1.6 mysqlshow"></a>1.6 mysqlshow</h4><p>mysqlshow å®¢æˆ·ç«¯å¯¹è±¡æŸ¥æ‰¾å·¥å…·ï¼Œç”¨æ¥å¾ˆå¿«åœ°æŸ¥æ‰¾å­˜åœ¨å“ªäº›æ•°æ®åº“ã€æ•°æ®åº“ä¸­çš„è¡¨ã€è¡¨ä¸­çš„åˆ—æˆ–è€…ç´¢å¼•ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>mysqlshow [options] [db_name [table_name [col_name]]]
</code></pre><p>å‚æ•°ï¼š</p>
<pre><code>--count        æ˜¾ç¤ºæ•°æ®åº“åŠè¡¨çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ•°æ®åº“ï¼Œè¡¨ å‡å¯ä»¥ä¸æŒ‡å®šï¼‰

-i            æ˜¾ç¤ºæŒ‡å®šæ•°æ®åº“æˆ–è€…æŒ‡å®šè¡¨çš„çŠ¶æ€ä¿¡æ¯
</code></pre><p>ç¤ºä¾‹ï¼š</p>
<pre><code>#æŸ¥è¯¢æ¯ä¸ªæ•°æ®åº“çš„è¡¨çš„æ•°é‡åŠè¡¨ä¸­è®°å½•çš„æ•°é‡
mysqlshow -uroot -p2143 --count

#æŸ¥è¯¢teståº“ä¸­æ¯ä¸ªè¡¨ä¸­çš„å­—æ®µä¹¦ï¼ŒåŠè¡Œæ•°
mysqlshow -uroot -p2143 test --count

#æŸ¥è¯¢teståº“ä¸­bookè¡¨çš„è¯¦ç»†æƒ…å†µ
mysqlshow -uroot -p2143 test book --count

</code></pre><h3 id="2-Mysql-æ—¥å¿—"><a href="#2-Mysql-æ—¥å¿—" class="headerlink" title="2. Mysql æ—¥å¿—"></a>2. Mysql æ—¥å¿—</h3><p>åœ¨ä»»ä½•ä¸€ç§æ•°æ®åº“ä¸­ï¼Œéƒ½ä¼šæœ‰å„ç§å„æ ·çš„æ—¥å¿—ï¼Œè®°å½•ç€æ•°æ®åº“å·¥ä½œçš„æ–¹æ–¹é¢é¢ï¼Œä»¥å¸®åŠ©æ•°æ®åº“ç®¡ç†å‘˜è¿½è¸ªæ•°æ®åº“æ›¾ç»å‘ç”Ÿè¿‡çš„å„ç§äº‹ä»¶ã€‚MySQL ä¹Ÿä¸ä¾‹å¤–ï¼Œåœ¨ MySQL ä¸­ï¼Œæœ‰ 4 ç§ä¸åŒçš„æ—¥å¿—ï¼Œåˆ†åˆ«æ˜¯é”™è¯¯æ—¥å¿—ã€äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBINLOG æ—¥å¿—ï¼‰ã€æŸ¥è¯¢æ—¥å¿—å’Œæ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œè¿™äº›æ—¥å¿—è®°å½•ç€æ•°æ®åº“åœ¨ä¸åŒæ–¹é¢çš„è¸ªè¿¹ã€‚</p>
<h4 id="2-1-é”™è¯¯æ—¥å¿—"><a href="#2-1-é”™è¯¯æ—¥å¿—" class="headerlink" title="2.1 é”™è¯¯æ—¥å¿—"></a>2.1 é”™è¯¯æ—¥å¿—</h4><p>é”™è¯¯æ—¥å¿—æ˜¯ MySQL ä¸­æœ€é‡è¦çš„æ—¥å¿—ä¹‹ä¸€ï¼Œå®ƒè®°å½•äº†å½“ mysqld å¯åŠ¨å’Œåœæ­¢æ—¶ï¼Œä»¥åŠæœåŠ¡å™¨åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿä»»ä½•ä¸¥é‡é”™è¯¯æ—¶çš„ç›¸å…³ä¿¡æ¯ã€‚å½“æ•°æ®åº“å‡ºç°ä»»ä½•æ•…éšœå¯¼è‡´æ— æ³•æ­£å¸¸ä½¿ç”¨æ—¶ï¼Œå¯ä»¥é¦–å…ˆæŸ¥çœ‹æ­¤æ—¥å¿—ã€‚</p>
<p>è¯¥æ—¥å¿—æ˜¯é»˜è®¤å¼€å¯çš„ ï¼Œ é»˜è®¤å­˜æ”¾ç›®å½•ä¸º mysql çš„æ•°æ®ç›®å½•ï¼ˆvar/lib/mysqlï¼‰, é»˜è®¤çš„æ—¥å¿—æ–‡ä»¶åä¸º  hostname.errï¼ˆhostnameæ˜¯ä¸»æœºåï¼‰ã€‚</p>
<p>æŸ¥çœ‹æ—¥å¿—ä½ç½®æŒ‡ä»¤ ï¼š </p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'log_error%'</span><span class="token punctuation">;</span>
</code></pre>
<p><img src="/2021/01/23/mysql-advanced-4/1553993244446.png" alt="1553993244446"> </p>
<p>æŸ¥çœ‹æ—¥å¿—å†…å®¹ ï¼š </p>
<pre class=" language-shell"><code class="language-shell">tail -f /var/lib/mysql/xaxh-server.err
</code></pre>
<p><img src="/2021/01/23/mysql-advanced-4/1553993537874.png" alt="1553993537874"> </p>
<h4 id="2-2-äºŒè¿›åˆ¶æ—¥å¿—"><a href="#2-2-äºŒè¿›åˆ¶æ—¥å¿—" class="headerlink" title="2.2 äºŒè¿›åˆ¶æ—¥å¿—"></a>2.2 äºŒè¿›åˆ¶æ—¥å¿—</h4><h5 id="2-2-1æ¦‚è¿°"><a href="#2-2-1æ¦‚è¿°" class="headerlink" title="2.2.1æ¦‚è¿°"></a>2.2.1æ¦‚è¿°</h5><p>äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBINLOGï¼‰è®°å½•äº†æ‰€æœ‰çš„ DDLï¼ˆæ•°æ®å®šä¹‰è¯­è¨€ï¼‰è¯­å¥å’Œ DMLï¼ˆæ•°æ®æ“çºµè¯­è¨€ï¼‰è¯­å¥ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬æ•°æ®æŸ¥è¯¢è¯­å¥ã€‚æ­¤æ—¥å¿—å¯¹äºç¾éš¾æ—¶çš„æ•°æ®æ¢å¤èµ·ç€æå…¶é‡è¦çš„ä½œç”¨ï¼ŒMySQLçš„ä¸»ä»å¤åˆ¶ï¼Œ å°±æ˜¯é€šè¿‡è¯¥binlogå®ç°çš„ã€‚</p>
<p>äºŒè¿›åˆ¶æ—¥å¿—ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œéœ€è¦åˆ°MySQLçš„é…ç½®æ–‡ä»¶ä¸­å¼€å¯ï¼Œå¹¶é…ç½®MySQLæ—¥å¿—çš„æ ¼å¼ã€‚ </p>
<p>é…ç½®æ–‡ä»¶ä½ç½® : /usr/my.cnf</p>
<p>æ—¥å¿—å­˜æ”¾ä½ç½® : é…ç½®æ—¶ï¼Œç»™å®šäº†æ–‡ä»¶åä½†æ˜¯æ²¡æœ‰æŒ‡å®šè·¯å¾„ï¼Œæ—¥å¿—é»˜è®¤å†™å…¥Mysqlçš„æ•°æ®ç›®å½•ã€‚</p>
<pre><code>#é…ç½®å¼€å¯binlogæ—¥å¿—ï¼Œ æ—¥å¿—çš„æ–‡ä»¶å‰ç¼€ä¸º mysqlbin -----&gt; ç”Ÿæˆçš„æ–‡ä»¶åå¦‚ : mysqlbin.000001,mysqlbin.000002
log_bin=mysqlbin

#é…ç½®äºŒè¿›åˆ¶æ—¥å¿—çš„æ ¼å¼
binlog_format=STATEMENT

</code></pre><h5 id="2-2-2-æ—¥å¿—æ ¼å¼"><a href="#2-2-2-æ—¥å¿—æ ¼å¼" class="headerlink" title="2.2.2 æ—¥å¿—æ ¼å¼"></a>2.2.2 æ—¥å¿—æ ¼å¼</h5><p><strong>STATEMENT</strong></p>
<p>è¯¥æ—¥å¿—æ ¼å¼åœ¨æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•çš„éƒ½æ˜¯SQLè¯­å¥ï¼ˆstatementï¼‰ï¼Œæ¯ä¸€æ¡å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹çš„SQLéƒ½ä¼šè®°å½•åœ¨æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œé€šè¿‡Mysqlæä¾›çš„mysqlbinlogå·¥å…·ï¼Œå¯ä»¥æ¸…æ™°çš„æŸ¥çœ‹åˆ°æ¯æ¡è¯­å¥çš„æ–‡æœ¬ã€‚ä¸»ä»å¤åˆ¶çš„æ—¶å€™ï¼Œä»åº“ï¼ˆslaveï¼‰ä¼šå°†æ—¥å¿—è§£æä¸ºåŸæ–‡æœ¬ï¼Œå¹¶åœ¨ä»åº“é‡æ–°æ‰§è¡Œä¸€æ¬¡ã€‚</p>
<p><strong>ROW</strong></p>
<p>è¯¥æ—¥å¿—æ ¼å¼åœ¨æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•çš„æ˜¯æ¯ä¸€è¡Œçš„æ•°æ®å˜æ›´ï¼Œè€Œä¸æ˜¯è®°å½•SQLè¯­å¥ã€‚æ¯”å¦‚ï¼Œæ‰§è¡ŒSQLè¯­å¥ ï¼š update tb_book set status=â€™1â€™ , å¦‚æœæ˜¯STATEMENT æ—¥å¿—æ ¼å¼ï¼Œåœ¨æ—¥å¿—ä¸­ä¼šè®°å½•ä¸€è¡ŒSQLæ–‡ä»¶ï¼› å¦‚æœæ˜¯ROWï¼Œç”±äºæ˜¯å¯¹å…¨è¡¨è¿›è¡Œæ›´æ–°ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€è¡Œè®°å½•éƒ½ä¼šå‘ç”Ÿå˜æ›´ï¼ŒROW æ ¼å¼çš„æ—¥å¿—ä¸­ä¼šè®°å½•æ¯ä¸€è¡Œçš„æ•°æ®å˜æ›´ã€‚</p>
<p><strong>MIXED</strong></p>
<p>è¿™æ˜¯ç›®å‰MySQLé»˜è®¤çš„æ—¥å¿—æ ¼å¼ï¼Œå³æ··åˆäº†STATEMENT å’Œ ROWä¸¤ç§æ ¼å¼ã€‚é»˜è®¤æƒ…å†µä¸‹é‡‡ç”¨STATEMENTï¼Œä½†æ˜¯åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹é‡‡ç”¨ROWæ¥è¿›è¡Œè®°å½•ã€‚MIXED æ ¼å¼èƒ½å°½é‡åˆ©ç”¨ä¸¤ç§æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œè€Œé¿å¼€ä»–ä»¬çš„ç¼ºç‚¹ã€‚</p>
<h5 id="2-2-3-æ—¥å¿—è¯»å–"><a href="#2-2-3-æ—¥å¿—è¯»å–" class="headerlink" title="2.2.3 æ—¥å¿—è¯»å–"></a>2.2.3 æ—¥å¿—è¯»å–</h5><p>ç”±äºæ—¥å¿—ä»¥äºŒè¿›åˆ¶æ–¹å¼å­˜å‚¨ï¼Œä¸èƒ½ç›´æ¥è¯»å–ï¼Œéœ€è¦ç”¨mysqlbinlogå·¥å…·æ¥æŸ¥çœ‹ï¼Œè¯­æ³•å¦‚ä¸‹ ï¼š</p>
<pre><code>mysqlbinlog log-fileï¼›

</code></pre><p><strong>æŸ¥çœ‹STATEMENTæ ¼å¼æ—¥å¿—</strong> </p>
<p>æ‰§è¡Œæ’å…¥è¯­å¥ ï¼š</p>
<pre class=" language-SQL"><code class="language-SQL">insert into tb_book values(null,'Lucene','2088-05-01','0');
</code></pre>
<p> æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ ï¼š</p>
<p><img src="/2021/01/23/mysql-advanced-4/1554079717375.png" alt="1554079717375"> </p>
<p>mysqlbin.index : è¯¥æ–‡ä»¶æ˜¯æ—¥å¿—ç´¢å¼•æ–‡ä»¶ ï¼Œ è®°å½•æ—¥å¿—çš„æ–‡ä»¶åï¼›</p>
<p>mysqlbing.000001 ï¼šæ—¥å¿—æ–‡ä»¶</p>
<p>æŸ¥çœ‹æ—¥å¿—å†…å®¹ ï¼š</p>
<pre><code>mysqlbinlog mysqlbing.000001ï¼›

</code></pre><p><img src="/2021/01/23/mysql-advanced-4/1554080016778.png" alt="1554080016778"> </p>
<p><strong>æŸ¥çœ‹ROWæ ¼å¼æ—¥å¿—</strong></p>
<p>é…ç½® :</p>
<pre><code>#é…ç½®å¼€å¯binlogæ—¥å¿—ï¼Œ æ—¥å¿—çš„æ–‡ä»¶å‰ç¼€ä¸º mysqlbin -----&gt; ç”Ÿæˆçš„æ–‡ä»¶åå¦‚ : mysqlbin.000001,mysqlbin.000002
log_bin=mysqlbin

#é…ç½®äºŒè¿›åˆ¶æ—¥å¿—çš„æ ¼å¼
binlog_format=ROW

</code></pre><p>æ’å…¥æ•°æ® :</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> tb_book <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'SpringCloudå®æˆ˜'</span><span class="token punctuation">,</span><span class="token string">'2088-05-05'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>å¦‚æœæ—¥å¿—æ ¼å¼æ˜¯ ROW , ç›´æ¥æŸ¥çœ‹æ•°æ® , æ˜¯æŸ¥çœ‹ä¸æ‡‚çš„ ; å¯ä»¥åœ¨mysqlbinlog åé¢åŠ ä¸Šå‚æ•° -vv  </p>
<pre class=" language-SQL"><code class="language-SQL">mysqlbinlog -vv mysqlbin.000002 
</code></pre>
<p><img src="/2021/01/23/mysql-advanced-4/1554095452022.png" alt="1554095452022"> </p>
<h5 id="2-2-4-æ—¥å¿—åˆ é™¤"><a href="#2-2-4-æ—¥å¿—åˆ é™¤" class="headerlink" title="2.2.4 æ—¥å¿—åˆ é™¤"></a>2.2.4 æ—¥å¿—åˆ é™¤</h5><p>å¯¹äºæ¯”è¾ƒç¹å¿™çš„ç³»ç»Ÿï¼Œç”±äºæ¯å¤©ç”Ÿæˆæ—¥å¿—é‡å¤§ ï¼Œè¿™äº›æ—¥å¿—å¦‚æœé•¿æ—¶é—´ä¸æ¸…æ¥šï¼Œå°†ä¼šå ç”¨å¤§é‡çš„ç£ç›˜ç©ºé—´ã€‚ä¸‹é¢æˆ‘ä»¬å°†ä¼šè®²è§£å‡ ç§åˆ é™¤æ—¥å¿—çš„å¸¸è§æ–¹æ³• ï¼š</p>
<p><strong>æ–¹å¼ä¸€</strong> </p>
<p>é€šè¿‡ Reset Master æŒ‡ä»¤åˆ é™¤å…¨éƒ¨ binlog æ—¥å¿—ï¼Œåˆ é™¤ä¹‹åï¼Œæ—¥å¿—ç¼–å·ï¼Œå°†ä» xxxx.000001é‡æ–°å¼€å§‹ ã€‚</p>
<p>æŸ¥è¯¢ä¹‹å‰ ï¼Œå…ˆæŸ¥è¯¢ä¸‹æ—¥å¿—æ–‡ä»¶ ï¼š </p>
<p><img src="/2021/01/23/mysql-advanced-4/1554118609489.png" alt="1554118609489">   </p>
<p>æ‰§è¡Œåˆ é™¤æ—¥å¿—æŒ‡ä»¤ï¼š </p>
<pre><code>Reset Master
</code></pre><p>æ‰§è¡Œä¹‹åï¼Œ æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ ï¼š</p>
<p><img src="/2021/01/23/mysql-advanced-4/1554118675264.png" alt="1554118675264"> </p>
<p><strong>æ–¹å¼äºŒ</strong></p>
<p>æ‰§è¡ŒæŒ‡ä»¤ <code>purge  master logs to 'mysqlbin.******'</code> ï¼Œè¯¥å‘½ä»¤å°†åˆ é™¤  <code>******</code> ç¼–å·ä¹‹å‰çš„æ‰€æœ‰æ—¥å¿—ã€‚ </p>
<p><strong>æ–¹å¼ä¸‰</strong></p>
<p>æ‰§è¡ŒæŒ‡ä»¤ <code>purge master logs before 'yyyy-mm-dd hh24:mi:ss'</code> ï¼Œè¯¥å‘½ä»¤å°†åˆ é™¤æ—¥å¿—ä¸º â€œyyyy-mm-dd hh24:mi:ssâ€ ä¹‹å‰äº§ç”Ÿçš„æ‰€æœ‰æ—¥å¿— ã€‚</p>
<p><strong>æ–¹å¼å››</strong></p>
<p>è®¾ç½®å‚æ•° â€“expire_logs_days=# ï¼Œæ­¤å‚æ•°çš„å«ä¹‰æ˜¯è®¾ç½®æ—¥å¿—çš„è¿‡æœŸå¤©æ•°ï¼Œ è¿‡äº†æŒ‡å®šçš„å¤©æ•°åæ—¥å¿—å°†ä¼šè¢«è‡ªåŠ¨åˆ é™¤ï¼Œè¿™æ ·å°†æœ‰åˆ©äºå‡å°‘DBA ç®¡ç†æ—¥å¿—çš„å·¥ä½œé‡ã€‚</p>
<p>é…ç½®å¦‚ä¸‹ ï¼š </p>
<p><img src="/2021/01/23/mysql-advanced-4/1554125506938.png" alt="1554125506938"> </p>
<h4 id="2-3-æŸ¥è¯¢æ—¥å¿—"><a href="#2-3-æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="2.3 æŸ¥è¯¢æ—¥å¿—"></a>2.3 æŸ¥è¯¢æ—¥å¿—</h4><p>æŸ¥è¯¢æ—¥å¿—ä¸­è®°å½•äº†å®¢æˆ·ç«¯çš„æ‰€æœ‰æ“ä½œè¯­å¥ï¼Œè€ŒäºŒè¿›åˆ¶æ—¥å¿—ä¸åŒ…å«æŸ¥è¯¢æ•°æ®çš„SQLè¯­å¥ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ æŸ¥è¯¢æ—¥å¿—æ˜¯æœªå¼€å¯çš„ã€‚å¦‚æœéœ€è¦å¼€å¯æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥è®¾ç½®ä»¥ä¸‹é…ç½® ï¼š</p>
<pre><code>#è¯¥é€‰é¡¹ç”¨æ¥å¼€å¯æŸ¥è¯¢æ—¥å¿— ï¼Œ å¯é€‰å€¼ ï¼š 0 æˆ–è€… 1 ï¼› 0 ä»£è¡¨å…³é—­ï¼Œ 1 ä»£è¡¨å¼€å¯ 
general_log=1

#è®¾ç½®æ—¥å¿—çš„æ–‡ä»¶å ï¼Œ å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œ é»˜è®¤çš„æ–‡ä»¶åä¸º host_name.log 
general_log_file=file_name

</code></pre><p>åœ¨ mysql çš„é…ç½®æ–‡ä»¶ /usr/my.cnf ä¸­é…ç½®å¦‚ä¸‹å†…å®¹ ï¼š </p>
<p><img src="/2021/01/23/mysql-advanced-4/1554128184632.png" alt="1554128184632"> </p>
<p>é…ç½®å®Œæ¯•ä¹‹åï¼Œåœ¨æ•°æ®åº“æ‰§è¡Œä»¥ä¸‹æ“ä½œ ï¼š</p>
<pre><code>select * from tb_book;
select * from tb_book where id = 1;
update tb_book set name = 'luceneå…¥é—¨æŒ‡å—' where id = 5;
select * from tb_book where id &lt; 8;

</code></pre><p>æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œ å†æ¬¡æ¥æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶ ï¼š </p>
<p><img src="/2021/01/23/mysql-advanced-4/1554128089851.png" alt="1554128089851"> </p>
<h4 id="2-4-æ…¢æŸ¥è¯¢æ—¥å¿—"><a href="#2-4-æ…¢æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="2.4 æ…¢æŸ¥è¯¢æ—¥å¿—"></a>2.4 æ…¢æŸ¥è¯¢æ—¥å¿—</h4><p>æ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•äº†æ‰€æœ‰æ‰§è¡Œæ—¶é—´è¶…è¿‡å‚æ•° long_query_time è®¾ç½®å€¼å¹¶ä¸”æ‰«æè®°å½•æ•°ä¸å°äº min_examined_row_limit çš„æ‰€æœ‰çš„SQLè¯­å¥çš„æ—¥å¿—ã€‚long_query_time é»˜è®¤ä¸º 10 ç§’ï¼Œæœ€å°ä¸º 0ï¼Œ ç²¾åº¦å¯ä»¥åˆ°å¾®ç§’ã€‚</p>
<h5 id="2-4-1-æ–‡ä»¶ä½ç½®å’Œæ ¼å¼"><a href="#2-4-1-æ–‡ä»¶ä½ç½®å’Œæ ¼å¼" class="headerlink" title="2.4.1 æ–‡ä»¶ä½ç½®å’Œæ ¼å¼"></a>2.4.1 æ–‡ä»¶ä½ç½®å’Œæ ¼å¼</h5><p>æ…¢æŸ¥è¯¢æ—¥å¿—é»˜è®¤æ˜¯å…³é—­çš„ ã€‚å¯ä»¥é€šè¿‡ä¸¤ä¸ªå‚æ•°æ¥æ§åˆ¶æ…¢æŸ¥è¯¢æ—¥å¿— ï¼š</p>
<pre><code># è¯¥å‚æ•°ç”¨æ¥æ§åˆ¶æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å¦å¼€å¯ï¼Œ å¯å–å€¼ï¼š 1 å’Œ 0 ï¼Œ 1 ä»£è¡¨å¼€å¯ï¼Œ 0 ä»£è¡¨å…³é—­
slow_query_log=1 

# è¯¥å‚æ•°ç”¨æ¥æŒ‡å®šæ…¢æŸ¥è¯¢æ—¥å¿—çš„æ–‡ä»¶å
slow_query_log_file=slow_query.log

# è¯¥é€‰é¡¹ç”¨æ¥é…ç½®æŸ¥è¯¢çš„æ—¶é—´é™åˆ¶ï¼Œ è¶…è¿‡è¿™ä¸ªæ—¶é—´å°†è®¤ä¸ºå€¼æ…¢æŸ¥è¯¢ï¼Œ å°†éœ€è¦è¿›è¡Œæ—¥å¿—è®°å½•ï¼Œ é»˜è®¤10s
long_query_time=10

</code></pre><h5 id="2-4-2-æ—¥å¿—çš„è¯»å–"><a href="#2-4-2-æ—¥å¿—çš„è¯»å–" class="headerlink" title="2.4.2 æ—¥å¿—çš„è¯»å–"></a>2.4.2 æ—¥å¿—çš„è¯»å–</h5><p>å’Œé”™è¯¯æ—¥å¿—ã€æŸ¥è¯¢æ—¥å¿—ä¸€æ ·ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•çš„æ ¼å¼ä¹Ÿæ˜¯çº¯æ–‡æœ¬ï¼Œå¯ä»¥è¢«ç›´æ¥è¯»å–ã€‚</p>
<p>1ï¼‰ æŸ¥è¯¢long_query_time çš„å€¼ã€‚</p>
<p><img src="/2021/01/23/mysql-advanced-4/1554130333472.png" alt="1554130333472"> </p>
<p>2ï¼‰ æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> id<span class="token punctuation">,</span> title<span class="token punctuation">,</span>price<span class="token punctuation">,</span>num <span class="token punctuation">,</span><span class="token keyword">status</span> <span class="token keyword">from</span> tb_item <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<p><img src="/2021/01/23/mysql-advanced-4/1554130448709.png" alt="1554130448709"></p>
<p>ç”±äºè¯¥è¯­å¥æ‰§è¡Œæ—¶é—´å¾ˆçŸ­ï¼Œä¸º0s ï¼Œ æ‰€ä»¥ä¸ä¼šè®°å½•åœ¨æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚</p>
<pre><code>select * from tb_item where title like '%é˜¿å°”å¡ç‰¹ (OT-927) ç‚­é»‘ è”é€š3Gæ‰‹æœº åŒå¡åŒå¾…165454%' ;

</code></pre><p><img src="/2021/01/23/mysql-advanced-4/1554130532577.png" alt="1554130532577"> </p>
<p>è¯¥SQLè¯­å¥ ï¼Œ æ‰§è¡Œæ—¶é•¿ä¸º 26.77s ï¼Œè¶…è¿‡10s ï¼Œ æ‰€ä»¥ä¼šè®°å½•åœ¨æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶ä¸­ã€‚</p>
<p>3ï¼‰ æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶</p>
<p>ç›´æ¥é€šè¿‡cat æŒ‡ä»¤æŸ¥è¯¢è¯¥æ—¥å¿—æ–‡ä»¶ ï¼š </p>
<p><img src="/2021/01/23/mysql-advanced-4/1554130669360.png" alt="1554130669360"> </p>
<p>å¦‚æœæ…¢æŸ¥è¯¢æ—¥å¿—å†…å®¹å¾ˆå¤šï¼Œ ç›´æ¥æŸ¥çœ‹æ–‡ä»¶ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œ è¿™ä¸ªæ—¶å€™å¯ä»¥å€ŸåŠ©äºmysqlè‡ªå¸¦çš„ mysqldumpslow å·¥å…·ï¼Œ æ¥å¯¹æ…¢æŸ¥è¯¢æ—¥å¿—è¿›è¡Œåˆ†ç±»æ±‡æ€»ã€‚ </p>
<p><img src="/2021/01/23/mysql-advanced-4/1554130856485.png" alt="1554130856485"> </p>
<h3 id="3-Mysqlå¤åˆ¶"><a href="#3-Mysqlå¤åˆ¶" class="headerlink" title="3. Mysqlå¤åˆ¶"></a>3. Mysqlå¤åˆ¶</h3><h4 id="3-1-å¤åˆ¶æ¦‚è¿°"><a href="#3-1-å¤åˆ¶æ¦‚è¿°" class="headerlink" title="3.1 å¤åˆ¶æ¦‚è¿°"></a>3.1 å¤åˆ¶æ¦‚è¿°</h4><p>å¤åˆ¶æ˜¯æŒ‡å°†ä¸»æ•°æ®åº“çš„DDL å’Œ DML æ“ä½œé€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—ä¼ åˆ°ä»åº“æœåŠ¡å™¨ä¸­ï¼Œç„¶ååœ¨ä»åº“ä¸Šå¯¹è¿™äº›æ—¥å¿—é‡æ–°æ‰§è¡Œï¼ˆä¹Ÿå«é‡åšï¼‰ï¼Œä»è€Œä½¿å¾—ä»åº“å’Œä¸»åº“çš„æ•°æ®ä¿æŒåŒæ­¥ã€‚</p>
<p>MySQLæ”¯æŒä¸€å°ä¸»åº“åŒæ—¶å‘å¤šå°ä»åº“è¿›è¡Œå¤åˆ¶ï¼Œ ä»åº“åŒæ—¶ä¹Ÿå¯ä»¥ä½œä¸ºå…¶ä»–ä»æœåŠ¡å™¨çš„ä¸»åº“ï¼Œå®ç°é“¾çŠ¶å¤åˆ¶ã€‚</p>
<h4 id="3-2-å¤åˆ¶åŸç†"><a href="#3-2-å¤åˆ¶åŸç†" class="headerlink" title="3.2 å¤åˆ¶åŸç†"></a>3.2 å¤åˆ¶åŸç†</h4><p>MySQL çš„ä¸»ä»å¤åˆ¶åŸç†å¦‚ä¸‹ã€‚</p>
<p><img src="/2021/01/23/mysql-advanced-4/1.jpg" alt="1554423698190"> </p>
<p>ä»ä¸Šå±‚æ¥çœ‹ï¼Œå¤åˆ¶åˆ†æˆä¸‰æ­¥ï¼š</p>
<ul>
<li>Master ä¸»åº“åœ¨äº‹åŠ¡æäº¤æ—¶ï¼Œä¼šæŠŠæ•°æ®å˜æ›´ä½œä¸ºæ—¶é—´ Events è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ Binlog ä¸­ã€‚</li>
<li><p>ä¸»åº“æ¨é€äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ Binlog ä¸­çš„æ—¥å¿—äº‹ä»¶åˆ°ä»åº“çš„ä¸­ç»§æ—¥å¿— Relay Log ã€‚</p>
</li>
<li><p>slaveé‡åšä¸­ç»§æ—¥å¿—ä¸­çš„äº‹ä»¶ï¼Œå°†æ”¹å˜åæ˜ å®ƒè‡ªå·±çš„æ•°æ®ã€‚</p>
</li>
</ul>
<h4 id="3-3-å¤åˆ¶ä¼˜åŠ¿"><a href="#3-3-å¤åˆ¶ä¼˜åŠ¿" class="headerlink" title="3.3 å¤åˆ¶ä¼˜åŠ¿"></a>3.3 å¤åˆ¶ä¼˜åŠ¿</h4><p>MySQL å¤åˆ¶çš„æœ‰ç‚¹ä¸»è¦åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><p>ä¸»åº“å‡ºç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿåˆ‡æ¢åˆ°ä»åº“æä¾›æœåŠ¡ã€‚</p>
</li>
<li><p>å¯ä»¥åœ¨ä»åº“ä¸Šæ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œä»ä¸»åº“ä¸­æ›´æ–°ï¼Œå®ç°è¯»å†™åˆ†ç¦»ï¼Œé™ä½ä¸»åº“çš„è®¿é—®å‹åŠ›ã€‚</p>
</li>
<li><p>å¯ä»¥åœ¨ä»åº“ä¸­æ‰§è¡Œå¤‡ä»½ï¼Œä»¥é¿å…å¤‡ä»½æœŸé—´å½±å“ä¸»åº“çš„æœåŠ¡ã€‚</p>
</li>
</ul>
<h4 id="3-4-æ­å»ºæ­¥éª¤"><a href="#3-4-æ­å»ºæ­¥éª¤" class="headerlink" title="3.4 æ­å»ºæ­¥éª¤"></a>3.4 æ­å»ºæ­¥éª¤</h4><h5 id="3-4-1-master"><a href="#3-4-1-master" class="headerlink" title="3.4.1 master"></a>3.4.1 master</h5><p>1ï¼‰ åœ¨master çš„é…ç½®æ–‡ä»¶ï¼ˆ/usr/my.cnfï¼‰ä¸­ï¼Œé…ç½®å¦‚ä¸‹å†…å®¹ï¼š</p>
<pre class=" language-properties"><code class="language-properties"><span class="token comment" spellcheck="true">#mysql æœåŠ¡ID,ä¿è¯æ•´ä¸ªé›†ç¾¤ç¯å¢ƒä¸­å”¯ä¸€</span>
<span class="token attr-name">server-id</span><span class="token punctuation">=</span><span class="token attr-value">1</span>

<span class="token comment" spellcheck="true">#mysql binlog æ—¥å¿—çš„å­˜å‚¨è·¯å¾„å’Œæ–‡ä»¶å</span>
<span class="token attr-name">log-bin</span><span class="token punctuation">=</span><span class="token attr-value">/var/lib/mysql/mysqlbin</span>

<span class="token comment" spellcheck="true">#é”™è¯¯æ—¥å¿—,é»˜è®¤å·²ç»å¼€å¯</span>
<span class="token comment" spellcheck="true">#log-err</span>

<span class="token comment" spellcheck="true">#mysqlçš„å®‰è£…ç›®å½•</span>
<span class="token comment" spellcheck="true">#basedir</span>

<span class="token comment" spellcheck="true">#mysqlçš„ä¸´æ—¶ç›®å½•</span>
<span class="token comment" spellcheck="true">#tmpdir</span>

<span class="token comment" spellcheck="true">#mysqlçš„æ•°æ®å­˜æ”¾ç›®å½•</span>
<span class="token comment" spellcheck="true">#datadir</span>

<span class="token comment" spellcheck="true">#æ˜¯å¦åªè¯»,1 ä»£è¡¨åªè¯», 0 ä»£è¡¨è¯»å†™</span>
<span class="token attr-name">read-only</span><span class="token punctuation">=</span><span class="token attr-value">0</span>

<span class="token comment" spellcheck="true">#å¿½ç•¥çš„æ•°æ®, æŒ‡ä¸éœ€è¦åŒæ­¥çš„æ•°æ®åº“</span>
<span class="token attr-name">binlog-ignore-db</span><span class="token punctuation">=</span><span class="token attr-value">mysql</span>

<span class="token comment" spellcheck="true">#æŒ‡å®šåŒæ­¥çš„æ•°æ®åº“</span>
<span class="token comment" spellcheck="true">#binlog-do-db=db01</span>
</code></pre>
<p>2ï¼‰ æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œéœ€è¦é‡å¯Mysqlï¼š</p>
<pre class=" language-sql"><code class="language-sql">service mysql restart ï¼›
</code></pre>
<p>3ï¼‰ åˆ›å»ºåŒæ­¥æ•°æ®çš„è´¦æˆ·ï¼Œå¹¶ä¸”è¿›è¡Œæˆæƒæ“ä½œï¼š</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">grant</span> <span class="token keyword">replication</span> slave <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'itcast'</span>@'<span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">192.131</span><span class="token string">' identified by '</span>itcast'<span class="token punctuation">;</span>    

flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
</code></pre>
<p>4ï¼‰ æŸ¥çœ‹masterçŠ¶æ€ï¼š</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">show</span> master <span class="token keyword">status</span><span class="token punctuation">;</span>
</code></pre>
<p><img src="/2021/01/23/mysql-advanced-4/1554477759735.png" alt="1554477759735"> </p>
<p>å­—æ®µå«ä¹‰ï¼š</p>
<pre><code>File : ä»å“ªä¸ªæ—¥å¿—æ–‡ä»¶å¼€å§‹æ¨é€æ—¥å¿—æ–‡ä»¶ 
Position ï¼š ä»å“ªä¸ªä½ç½®å¼€å§‹æ¨é€æ—¥å¿—
Binlog_Ignore_DB : æŒ‡å®šä¸éœ€è¦åŒæ­¥çš„æ•°æ®åº“
</code></pre><h5 id="3-4-2-slave"><a href="#3-4-2-slave" class="headerlink" title="3.4.2 slave"></a>3.4.2 slave</h5><p>1ï¼‰ åœ¨ slave ç«¯é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®å¦‚ä¸‹å†…å®¹ï¼š</p>
<pre class=" language-properties"><code class="language-properties"><span class="token comment" spellcheck="true">#mysqlæœåŠ¡ç«¯ID,å”¯ä¸€</span>
<span class="token attr-name">server-id</span><span class="token punctuation">=</span><span class="token attr-value">2</span>

<span class="token comment" spellcheck="true">#æŒ‡å®šbinlogæ—¥å¿—</span>
<span class="token attr-name">log-bin</span><span class="token punctuation">=</span><span class="token attr-value">/var/lib/mysql/mysqlbin</span>
</code></pre>
<p>2ï¼‰  æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œéœ€è¦é‡å¯Mysqlï¼š</p>
<pre><code>service mysql restartï¼›
</code></pre><p>3ï¼‰ æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ ï¼š</p>
<pre class=" language-sql"><code class="language-sql">change master <span class="token keyword">to</span> master_host<span class="token operator">=</span> <span class="token string">'192.168.192.130'</span><span class="token punctuation">,</span> master_user<span class="token operator">=</span><span class="token string">'itcast'</span><span class="token punctuation">,</span> master_password<span class="token operator">=</span><span class="token string">'itcast'</span><span class="token punctuation">,</span> master_log_file<span class="token operator">=</span><span class="token string">'mysqlbin.000001'</span><span class="token punctuation">,</span> master_log_pos<span class="token operator">=</span><span class="token number">413</span><span class="token punctuation">;</span>
</code></pre>
<p>æŒ‡å®šå½“å‰ä»åº“å¯¹åº”çš„ä¸»åº“çš„IPåœ°å€ï¼Œç”¨æˆ·åï¼Œå¯†ç ï¼Œä»å“ªä¸ªæ—¥å¿—æ–‡ä»¶å¼€å§‹çš„é‚£ä¸ªä½ç½®å¼€å§‹åŒæ­¥æ¨é€æ—¥å¿—ã€‚</p>
<p>4ï¼‰ å¼€å¯åŒæ­¥æ“ä½œ</p>
<pre><code>start slave;

show slave status;
</code></pre><p><img src="/2021/01/23/mysql-advanced-4/1554479387365.png" alt="1554479387365"> </p>
<p>5ï¼‰ åœæ­¢åŒæ­¥æ“ä½œ</p>
<pre><code>stop slave;
</code></pre><h5 id="3-4-3-éªŒè¯åŒæ­¥æ“ä½œ"><a href="#3-4-3-éªŒè¯åŒæ­¥æ“ä½œ" class="headerlink" title="3.4.3 éªŒè¯åŒæ­¥æ“ä½œ"></a>3.4.3 éªŒè¯åŒæ­¥æ“ä½œ</h5><p>1ï¼‰ åœ¨ä¸»åº“ä¸­åˆ›å»ºæ•°æ®åº“ï¼Œåˆ›å»ºè¡¨ï¼Œå¹¶æ’å…¥æ•°æ® ï¼š</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token number">db01</span><span class="token punctuation">;</span>

<span class="token keyword">user</span> <span class="token number">db01</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">user</span><span class="token punctuation">(</span>
    id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    sex <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token keyword">engine</span><span class="token operator">=</span><span class="token keyword">innodb</span> <span class="token keyword">default</span> <span class="token keyword">charset</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>sex<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'Tom'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>sex<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'Trigger'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>sex<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'Dawn'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>2ï¼‰ åœ¨ä»åº“ä¸­æŸ¥è¯¢æ•°æ®ï¼Œè¿›è¡ŒéªŒè¯ ï¼š</p>
<p>åœ¨ä»åº“ä¸­ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°åˆšæ‰åˆ›å»ºçš„æ•°æ®åº“ï¼š</p>
<p><img src="/2021/01/23/mysql-advanced-4/1554544658640.png" alt="1554544658640"> </p>
<p>åœ¨è¯¥æ•°æ®åº“ä¸­ï¼ŒæŸ¥è¯¢userè¡¨ä¸­çš„æ•°æ®ï¼š</p>
<p><img src="/2021/01/23/mysql-advanced-4/1554544679538.png" alt="1554544679538"> </p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">ä½ çš„èµèµæ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.png" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>


            

    <div class="reprint" id="reprint-statement">
        <p class="reprint-tip">
            <i class="fas fa-exclamation-triangle"></i>&nbsp;&nbsp;
            <span>Reprint policy</span>
        </p>
        
            <div class="center-align">
                <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">
                    <img alt="Creative Commons License"
                         style="border-width:0"
                         src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"/>
                </a>
            </div>
            <br/>
            <a  href="/2021/01/23/mysql-advanced-4/">
                ã€ŠMySQLæ•°æ®åº“ä¼˜åŒ–ä¹‹ç»„åˆæ‹³(å››)ã€‹
            </a> by
            <a href="http://blog.tanguo.store">
                571
            </a> is licensed under a
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">
                Creative Commons Attribution 4.0 International License
            </a> 
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>


        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '843180bdbc2c6029a73e',
        clientSecret: '88c515826a23e788f3f69d9ed440e9c82a263918',
        repo: 'feelingWu.github.io',
        owner: 'feelingWu',
        admin: "feelingWu",
        id: '2021-01-23T09-57-01',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2021/02/21/3ordercube/">
                    <div class="card-image">
                        
                        <img src="/cover/" class="responsive-img" alt="ä¸‰é˜¶é­”æ–¹æ•™ç¨‹">
                        
                        <span class="card-title">ä¸‰é˜¶é­”æ–¹æ•™ç¨‹</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
ä¸‰é˜¶é­”æ–¹æ˜¯ç©ä»»æ„é˜¶é­”æ–¹çš„åŸºç¡€

å…¬å¼æ¦‚è§ˆï¼šå…¬å¼ä¸€(å°èŠ±ã€ç™½åå­—ã€ç™½é¢åº•)ï¼šä¸Šå·¦ä¸‹å³
å…¬å¼äºŒ(ä¸­é—´å±‚)ï¼šä¸Šå³ä¸‹å·¦
å…¬å¼ä¸‰(é»„åå­—)ï¼šæ­£é¢é¡ºæ—¶é’ˆè½¬90åº¦ï¼Œå…¬å¼ä¸€ï¼ˆä¸Šå·¦ä¸‹å³ï¼‰ï¼Œé€†æ—¶é’ˆè½¬90åº¦å›å»
å…¬å¼å››(å°é±¼ã€é»„é¢)ï¼šä¸‹å³ä¸Šå³ï¼Œä¸‹å³å³ä¸Š
å…¬å¼äº”
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-02-21
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/å¨±ä¹/" class="post-category">
                                    å¨±ä¹
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ä¸‰é˜¶/">
                        <span class="chip bg-color">ä¸‰é˜¶</span>
                    </a>
                    
                    <a href="/tags/é­”æ–¹/">
                        <span class="chip bg-color">é­”æ–¹</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/01/23/mysql-advanced-3/">
                    <div class="card-image">
                        
                        <img src="/cover/" class="responsive-img" alt="MySQLæ•°æ®åº“ä¼˜åŒ–ä¹‹ç»„åˆæ‹³(ä¸‰)">
                        
                        <span class="card-title">MySQLæ•°æ®åº“ä¼˜åŒ–ä¹‹ç»„åˆæ‹³(ä¸‰)</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
éåŸåˆ›å›¾æ–‡,å›¾æ–‡æ¥æºäºé»‘é©¬å®˜ç½‘,æ­¤å¤„ä»…ä½œä¸ºå¤‡ä»½å­¦ä¹ 


MySQLæ•°æ®åº“ä¼˜åŒ–æ€»æ¦‚


ç»„åˆæ‹³ï¼ˆä¸€ï¼‰
ç»„åˆæ‹³ï¼ˆäºŒï¼‰
ğŸš©ç»„åˆæ‹³ï¼ˆä¸‰ï¼‰
ç»„åˆæ‹³ï¼ˆå››ï¼‰




ç´¢å¼•
ä½“ç³»ç»“æ„
åº”ç”¨ä¼˜åŒ–
MySQL å¸¸ç”¨å·¥å…·


è§†å›¾
å­˜å‚¨å¼•æ“
æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–
M
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-01-23
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/æ•°æ®åº“/" class="post-category">
                                    æ•°æ®åº“
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/MySQLæ•°æ®åº“ä¼˜åŒ–ä¹‹ç»„åˆæ‹³-ä¸‰/">
                        <span class="chip bg-color">MySQLæ•°æ®åº“ä¼˜åŒ–ä¹‹ç»„åˆæ‹³(ä¸‰)</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">å¹´ä»½</span>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span
                class="white-color">55.5k</span>&nbsp;å­—
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;æ¬¡
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;äºº
            </span>
            
            <br>
            
            <span id="sitetime">è½½å…¥è¿è¡Œæ—¶é—´...</span>
            <script>
                function siteTime() {
                    window.setTimeout("siteTime()", 1000);
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2019";
                    var startMonth = "6";
                    var startDate = "28";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ " + diffDays + " å¤© " + diffHours +
                            " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ " + diffYears + " å¹´ " + diffDays +
                            " å¤© " + diffHours + " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/feelingWu/feelingWu.github.io" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:ivar571@foxmail.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->


    <!-- Baidu Analytics -->


    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    
    <script>
        (function (i, s, o, g, r, a, m) {
            i["DaoVoiceObject"] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o), m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            a.charset = "utf-8";
            m.parentNode.insertBefore(a, m)
        })(window, document, "script", ('https:' == document.location.protocol ? 'https:' : 'http:') +
            "//widget.daovoice.io/widget/6984b559.js", "daovoice")
        daovoice('init', {
            app_id: "0cccb8f3"
        });
        daovoice('update');
    </script>
    

    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    
    
    

</body>

</html>
